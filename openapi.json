{"openapi":"3.1.0","info":{"title":"AI Video Engine","description":"AI-powered video generation engine with LangGraph orchestration","version":"1.0.0"},"paths":{"/api/health":{"get":{"tags":["Health"],"summary":"Health Check","description":"健康检查","operationId":"health_check_api_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}},"/api/health/ready":{"get":{"tags":["Health"],"summary":"Readiness Check","description":"就绪检查 (Kubernetes)","operationId":"readiness_check_api_health_ready_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/health/live":{"get":{"tags":["Health"],"summary":"Liveness Check","description":"存活检查 (Kubernetes)","operationId":"liveness_check_api_health_live_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/projects":{"post":{"tags":["Projects"],"summary":"Create Project","description":"创建项目","operationId":"create_project_api_projects_post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ProjectResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Projects"],"summary":"List Projects","description":"获取项目列表","operationId":"list_projects_api_projects_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Page"}},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Page Size"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedResponse_ProjectResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}":{"get":{"tags":["Projects"],"summary":"Get Project","description":"获取项目详情","operationId":"get_project_api_projects__project_id__get","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ProjectResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Projects"],"summary":"Update Project","description":"更新项目","operationId":"update_project_api_projects__project_id__patch","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ProjectResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Projects"],"summary":"Delete Project","description":"删除项目","operationId":"delete_project_api_projects__project_id__delete","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}/nodes":{"get":{"tags":["Nodes"],"summary":"Get Project Nodes","description":"获取项目的所有节点 (用于 Canvas 渲染)\n\nArgs:\n    project_id: 项目 ID\n    node_type: 可选的节点类型过滤\n\nReturns:\n    节点列表，包含内容和布局信息","operationId":"get_project_nodes_api_projects__project_id__nodes_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}},{"name":"node_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Node Type"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_NodeWithLayout__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Nodes"],"summary":"Create Node","description":"创建新节点\n\nArgs:\n    project_id: 项目 ID\n    data: 节点创建数据\n    layout: 可选的布局信息\n\nReturns:\n    创建的节点","operationId":"create_node_api_projects__project_id__nodes_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Body_create_node_api_projects__project_id__nodes_post"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_NodeResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/nodes/{node_id}":{"get":{"tags":["Nodes"],"summary":"Get Node","description":"获取单个节点详情\n\nArgs:\n    node_id: 节点 ID\n\nReturns:\n    节点详情","operationId":"get_node_api_projects_nodes__node_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"node_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Node Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_NodeResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Nodes"],"summary":"Update Node","description":"更新节点内容\n\nArgs:\n    node_id: 节点 ID\n    data: 更新数据\n\nReturns:\n    更新后的节点","operationId":"update_node_api_projects_nodes__node_id__patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"node_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Node Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NodeUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_NodeResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Nodes"],"summary":"Delete Node","description":"删除节点\n\nArgs:\n    node_id: 节点 ID","operationId":"delete_node_api_projects_nodes__node_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"node_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Node Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/nodes/{node_id}/layout":{"patch":{"tags":["Nodes"],"summary":"Update Node Layout","description":"更新节点布局 (位置信息)\n\nArgs:\n    node_id: 节点 ID\n    layout: 布局更新数据 (位置坐标和画布标签)\n\nReturns:\n    更新后的布局信息","operationId":"update_node_layout_api_projects_nodes__node_id__layout_patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"node_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Node Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NodeLayoutUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_LayoutUpdateResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/nodes/batch/layout":{"post":{"tags":["Nodes"],"summary":"Batch Update Node Layouts","description":"批量更新节点布局\n\nArgs:\n    layouts: 布局更新数据列表，每个元素包含 node_id, canvas_tab, position_x, position_y\n\nReturns:\n    批量更新结果","operationId":"batch_update_node_layouts_api_projects_nodes_batch_layout_post","requestBody":{"content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/NodeLayoutUpdate"},"type":"array","title":"Layouts"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_BatchLayoutUpdateResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/projects/{project_id}/nodes/tree":{"get":{"tags":["Nodes"],"summary":"Get Project Nodes Tree","description":"获取项目的节点树结构 (按 parent_id 组织的层级结构)\n\nArgs:\n    project_id: 项目 ID\n\nReturns:\n    树形结构的节点数据","operationId":"get_project_nodes_tree_api_projects__project_id__nodes_tree_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_NodeTreeResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/graph/chat":{"post":{"tags":["Graph"],"summary":"Chat","description":"发送消息并获取流式响应\n\n使用 Server-Sent Events (SSE) 返回 Agent 的思考过程。\n\n**SSE Event 类型:**\n- `node_start`: 节点开始执行 `{\"type\": \"node_start\", \"node\": \"string\"}`\n- `node_end`: 节点执行完成 `{\"type\": \"node_end\", \"node\": \"string\"}`\n- `token`: Token 流输出 `{\"type\": \"token\", \"content\": \"string\"}`\n- `done`: 完成信号 `{\"type\": \"done\", \"state\": {...}}`\n- `error`: 错误事件 `{\"type\": \"error\", \"error_type\": \"string\", \"message\": \"string\", \"node\": \"string\"}`\n\n**示例:**\n```javascript\nconst eventSource = new EventSource('/api/graph/chat', {\n  method: 'POST',\n  body: JSON.stringify({project_id: \"...\", message: \"Hello\"})\n});\neventSource.onmessage = (event) => {\n  const data = JSON.parse(event.data);\n  console.log(data.type, data);\n};\n```","operationId":"chat_api_graph_chat_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}},"text/event-stream":{"schema":{"type":"string"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/graph/approve":{"post":{"tags":["Graph"],"summary":"Approve Step","description":"用户确认当前步骤\n\n用于 Human-in-the-Loop 流程中恢复 Graph 执行。","operationId":"approve_step_api_graph_approve_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ApproveRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_GraphStateResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/graph/{project_id}/state":{"get":{"tags":["Graph"],"summary":"Get Graph State","description":"获取当前 Graph 状态","operationId":"get_graph_state_api_graph__project_id__state_get","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}},{"name":"thread_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Thread Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_dict_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/graph/topology":{"get":{"tags":["Graph"],"summary":"Get Graph Topology","description":"获取图拓扑结构 (Mermaid 格式)","operationId":"get_graph_topology_api_graph_topology_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TopologyResponse"}}}}}}},"/api/graph/branch":{"post":{"tags":["Graph Branch"],"summary":"Create Branch","description":"创建新的剧情分支 (平行宇宙)\n\n基于 LangGraph Checkpoint 机制，从指定节点创建分支，并持久化到数据库。","operationId":"create_branch_api_graph_branch_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BranchCreateRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_BranchResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/graph/branches/{project_id}":{"get":{"tags":["Graph Branch"],"summary":"List Branches","description":"获取项目的所有分支\n\n从数据库查询分支信息，支持持久化存储。","operationId":"list_branches_api_graph_branches__project_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_BranchInfo__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/graph/rollback":{"post":{"tags":["Graph Branch"],"summary":"Rollback","description":"回滚到指定检查点\n\n时间旅行功能：回到历史状态继续执行。","operationId":"rollback_api_graph_rollback_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RollbackRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_RollbackResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/graph/state":{"patch":{"tags":["Graph Branch"],"summary":"Patch State","description":"实时修补 Graph 状态 (Live Directing)\n\n就像导演在片场喊\"卡！\"，然后调整演员表演。\n支持软重启和硬重启两种模式。","operationId":"patch_state_api_graph_state_patch","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/StatePatchRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_StatePatchResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/graph/history/{thread_id}":{"get":{"tags":["Graph Branch"],"summary":"Get Thread History","description":"获取线程执行历史\n\n返回所有检查点列表，用于时间旅行和调试。","operationId":"get_thread_history_api_graph_history__thread_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"thread_id","in":"path","required":true,"schema":{"type":"string","title":"Thread Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Limit"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_CheckpointInfo__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/action":{"post":{"tags":["SDUI Action"],"summary":"Handle Action","description":"处理 SDUI 按钮 Action\n\n直接处理前端按钮点击，不转换为聊天消息\n这是 SDUI 协议的核心：Action 直接驱动状态变更和业务操作","operationId":"handle_action_api_action_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ActionRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ActionResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/jobs":{"post":{"tags":["Jobs"],"summary":"Create Job","description":"创建异步任务","operationId":"create_job_api_jobs_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/JobCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_JobResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Jobs"],"summary":"List Jobs","description":"获取任务列表","operationId":"list_jobs_api_jobs_get","parameters":[{"name":"project_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Project Id"}},{"name":"job_status","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/JobStatus"},{"type":"null"}],"title":"Job Status"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Page"}},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Page Size"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedResponse_JobResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/jobs/{job_id}":{"get":{"tags":["Jobs"],"summary":"Get Job","description":"获取任务详情","operationId":"get_job_api_jobs__job_id__get","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Job Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_JobResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/jobs/{job_id}/cancel":{"post":{"tags":["Jobs"],"summary":"Cancel Job","description":"取消任务","operationId":"cancel_job_api_jobs__job_id__cancel_post","parameters":[{"name":"job_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Job Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/models/providers":{"get":{"tags":["Models"],"summary":"List Providers","description":"获取服务商列表","operationId":"list_providers_api_models_providers_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_ProviderResponseData__"}}}}},"security":[{"HTTPBearer":[]}]},"post":{"tags":["Models"],"summary":"Create Provider","description":"添加 LLM 服务商","operationId":"create_provider_api_models_providers_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelProviderCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ProviderResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/models/providers/{provider_id}":{"patch":{"tags":["Models"],"summary":"Update Provider","description":"更新 LLM 服务商","operationId":"update_provider_api_models_providers__provider_id__patch","parameters":[{"name":"provider_id","in":"path","required":true,"schema":{"type":"string","title":"Provider Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelProviderUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ProviderResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Models"],"summary":"Delete Provider","description":"删除 LLM 服务商","operationId":"delete_provider_api_models_providers__provider_id__delete","parameters":[{"name":"provider_id","in":"path","required":true,"schema":{"type":"string","title":"Provider Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/models/providers/test":{"post":{"tags":["Models"],"summary":"Test Provider","description":"测试服务商连接","operationId":"test_provider_api_models_providers_test_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelTestRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelTestResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/models/providers/{provider_id}/refresh":{"post":{"tags":["Models"],"summary":"Refresh Provider Models","description":"从服务商 API 自动刷新模型列表","operationId":"refresh_provider_models_api_models_providers__provider_id__refresh_post","parameters":[{"name":"provider_id","in":"path","required":true,"schema":{"type":"string","title":"Provider Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_str__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/models/mappings":{"get":{"tags":["Models"],"summary":"List Mappings","description":"获取任务-模型映射列表","operationId":"list_mappings_api_models_mappings_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_MappingResponseData__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Models"],"summary":"Create Mapping","description":"创建任务-模型映射","operationId":"create_mapping_api_models_mappings_post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelMappingCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_MappingResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/models/mappings/{mapping_id}":{"patch":{"tags":["Models"],"summary":"Update Mapping","description":"更新任务-模型映射","operationId":"update_mapping_api_models_mappings__mapping_id__patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"mapping_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Mapping Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelMappingUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_MappingResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Models"],"summary":"Delete Mapping","description":"删除任务-模型映射","operationId":"delete_mapping_api_models_mappings__mapping_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"mapping_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Mapping Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/models/task-types":{"get":{"tags":["Models"],"summary":"List Task Types","description":"获取所有任务类型","operationId":"list_task_types_api_models_task_types_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_TaskTypeInfo__"}}}}}}},"/api/projects/{project_id}/assets":{"get":{"tags":["Assets"],"summary":"List Assets","description":"获取项目的资产列表\n\nArgs:\n    project_id: 项目 ID\n    asset_type: 可选的资产类型过滤 (character/location/prop)\n    page: 页码\n    page_size: 每页数量\n\nReturns:\n    资产列表","operationId":"list_assets_api_projects__project_id__assets_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}},{"name":"asset_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Asset Type"}},{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Page"}},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Page Size"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedResponse_AssetResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Assets"],"summary":"Create Asset","description":"创建资产\n\nArgs:\n    project_id: 项目 ID\n    data: 资产数据 {\n        \"name\": str,\n        \"asset_type\": str (character/location/prop),\n        \"visual_tokens\": dict,\n        \"reference_urls\": list[str],\n        \"prompts\": dict\n    }\n\nReturns:\n    创建的资产","operationId":"create_asset_api_projects__project_id__assets_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Data"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_AssetResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/assets/{asset_id}":{"get":{"tags":["Assets"],"summary":"Get Asset","description":"获取资产详情\n\nArgs:\n    asset_id: 资产 ID\n\nReturns:\n    资产详情","operationId":"get_asset_api_projects_assets__asset_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"asset_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Asset Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_AssetResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Assets"],"summary":"Update Asset","description":"更新资产\n\nArgs:\n    asset_id: 资产 ID\n    data: 更新的字段\n\nReturns:\n    更新后的资产","operationId":"update_asset_api_projects_assets__asset_id__patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"asset_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Asset Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Data"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_AssetResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Assets"],"summary":"Delete Asset","description":"删除资产\n\nArgs:\n    asset_id: 资产 ID","operationId":"delete_asset_api_projects_assets__asset_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"asset_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Asset Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}/assets/extract":{"post":{"tags":["Assets"],"summary":"Extract Assets From Content","description":"从内容中提取资产\n\n调用 Asset Inspector Agent 分析文本，自动提取角色、场景、道具。\n\nArgs:\n    project_id: 项目 ID\n    data: {\n        \"content\": str,  # 要分析的文本内容\n        \"content_type\": str  # \"novel\" | \"script\" | \"outline\"\n    }\n\nReturns:\n    提取的资产列表","operationId":"extract_assets_from_content_api_projects__project_id__assets_extract_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Data"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_AssetExtractResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tools/":{"get":{"tags":["tools"],"summary":"List Tools","description":"获取可用工具列表","operationId":"list_tools_api_tools__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ToolListResponse"}}}}}}},"/api/tools/status":{"get":{"tags":["tools"],"summary":"Get Tools Status","description":"获取工具状态","operationId":"get_tools_status_api_tools_status_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ToolStatusResponse"}}}}}}},"/api/tools/search":{"post":{"tags":["tools"],"summary":"Search","description":"DuckDuckGo 搜索 - 异步版本","operationId":"search_api_tools_search_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SearchRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ToolResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tools/video/search":{"post":{"tags":["tools"],"summary":"Search Video","description":"视频搜索 - 异步版本","operationId":"search_video_api_tools_video_search_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VideoSearchRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ToolResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tools/video/info":{"post":{"tags":["tools"],"summary":"Get Video Info","description":"获取视频信息","operationId":"get_video_info_api_tools_video_info_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VideoInfoRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ToolResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tools/douyin/info":{"post":{"tags":["tools"],"summary":"Get Douyin Info","description":"抖音视频解析","operationId":"get_douyin_info_api_tools_douyin_info_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DouyinRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ToolResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tools/douyin/download-link":{"post":{"tags":["tools"],"summary":"Get Douyin Download Link","description":"抖音无水印下载链接","operationId":"get_douyin_download_link_api_tools_douyin_download_link_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/DouyinRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ToolResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tools/browser/scrape":{"post":{"tags":["tools"],"summary":"Scrape Page","description":"网页抓取","operationId":"scrape_page_api_tools_browser_scrape_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BrowserRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ToolResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tools/browser/screenshot":{"post":{"tags":["tools"],"summary":"Screenshot Page","description":"网页截图","operationId":"screenshot_page_api_tools_browser_screenshot_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BrowserRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ToolResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tools/browser/links":{"post":{"tags":["tools"],"summary":"Extract Links","description":"链接提取","operationId":"extract_links_api_tools_browser_links_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BrowserRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ToolResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}/episodes":{"get":{"tags":["Episodes"],"summary":"List Episodes","description":"获取项目的所有剧集列表\n\n用于左侧面板显示剧集列表。","operationId":"list_episodes_api_projects__project_id__episodes_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_List_EpisodeListResponse__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Episodes"],"summary":"Create Episode","description":"创建新剧集\n\n自动生成集数，初始化空白画布。","operationId":"create_episode_api_projects__project_id__episodes_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EpisodeCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_EpisodeResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}/episodes/{episode_id}":{"get":{"tags":["Episodes"],"summary":"Get Episode","description":"获取剧集详情\n\n包含剧本、小说、画布状态等完整信息。","operationId":"get_episode_api_projects__project_id__episodes__episode_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}},{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_EpisodeResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Episodes"],"summary":"Update Episode","description":"更新剧集信息\n\n支持更新标题、摘要、剧本、小说内容。","operationId":"update_episode_api_projects__project_id__episodes__episode_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}},{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EpisodeUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_EpisodeResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Episodes"],"summary":"Delete Episode","description":"删除剧集\n\n级联删除该剧集的所有分镜、场景、连线。","operationId":"delete_episode_api_projects__project_id__episodes__episode_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}},{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/shots":{"get":{"tags":["Shots"],"summary":"List Shots","description":"获取剧集的所有分镜节点\n\n支持按场景和类型筛选。","operationId":"list_shots_api_episodes__episode_id__shots_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"scene_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Scene Id"}},{"name":"node_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Node Type"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_List_ShotResponse__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Shots"],"summary":"Create Shot","description":"创建分镜节点\n\n自动生成 shot_number，初始化默认位置。","operationId":"create_shot_api_episodes__episode_id__shots_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ShotCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ShotResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/shots/batch":{"post":{"tags":["Shots"],"summary":"Batch Create Shots","description":"批量创建分镜节点\n\n用于智能分镜生成后批量插入。","operationId":"batch_create_shots_api_episodes__episode_id__shots_batch_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ShotBatchCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_List_ShotResponse__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/shots/{shot_id}":{"get":{"tags":["Shots"],"summary":"Get Shot","description":"获取分镜详情","operationId":"get_shot_api_episodes__episode_id__shots__shot_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"shot_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Shot Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ShotResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Shots"],"summary":"Update Shot","description":"更新分镜节点\n\n支持更新位置、状态、详情等。","operationId":"update_shot_api_episodes__episode_id__shots__shot_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"shot_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Shot Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ShotUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ShotResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Shots"],"summary":"Delete Shot","description":"删除分镜节点\n\n级联删除关联的连线。","operationId":"delete_shot_api_episodes__episode_id__shots__shot_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"shot_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Shot Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/shots/batch/position":{"put":{"tags":["Shots"],"summary":"Batch Update Positions","description":"批量更新节点位置\n\n用于拖拽后的位置同步。","operationId":"batch_update_positions_api_episodes__episode_id__shots_batch_position_put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ShotBatchUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_dict_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/canvas":{"get":{"tags":["Canvas"],"summary":"Get Canvas","description":"获取剧集画布状态\n\n返回完整的画布数据，包括视口、节点、连线。\n用于前端初始化画布。","operationId":"get_canvas_api_episodes__episode_id__canvas_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_CanvasData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Canvas"],"summary":"Save Canvas","description":"保存画布状态\n\n保存视口位置、所有节点、所有连线。\n触发 WebSocket 通知其他客户端。","operationId":"save_canvas_api_episodes__episode_id__canvas_put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CanvasSaveRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_CanvasData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/canvas/viewport":{"patch":{"tags":["Canvas"],"summary":"Update Viewport","description":"仅更新视口状态\n\n用于频繁的位置/缩放更新，不触发全量保存。","operationId":"update_viewport_api_episodes__episode_id__canvas_viewport_patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CanvasViewport"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_CanvasViewport_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/scenes":{"get":{"tags":["Scenes"],"summary":"List Scenes","description":"获取剧集的所有场景","operationId":"list_scenes_api_episodes__episode_id__scenes_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_List_SceneResponse__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Scenes"],"summary":"Create Scene","description":"创建场景\n\n自动生成场景编号（S01, S02...）。\n可选同时创建 Scene Master 节点。","operationId":"create_scene_api_episodes__episode_id__scenes_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SceneCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_SceneResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/scenes/{scene_id}":{"get":{"tags":["Scenes"],"summary":"Get Scene","description":"获取场景详情","operationId":"get_scene_api_episodes__episode_id__scenes__scene_id__get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"scene_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Scene Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_SceneResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Scenes"],"summary":"Update Scene","description":"更新场景信息","operationId":"update_scene_api_episodes__episode_id__scenes__scene_id__put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"scene_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Scene Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SceneUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_SceneResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Scenes"],"summary":"Delete Scene","description":"删除场景","operationId":"delete_scene_api_episodes__episode_id__scenes__scene_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"scene_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Scene Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/connections":{"get":{"tags":["Connections"],"summary":"List Connections","description":"获取剧集的所有连线","operationId":"list_connections_api_episodes__episode_id__connections_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_List_ConnectionResponse__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Connections"],"summary":"Create Connection","description":"创建连线","operationId":"create_connection_api_episodes__episode_id__connections_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConnectionCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ConnectionResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/connections/{connection_id}":{"delete":{"tags":["Connections"],"summary":"Delete Connection","description":"删除连线","operationId":"delete_connection_api_episodes__episode_id__connections__connection_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"connection_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Connection Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/":{"get":{"summary":"Root","description":"根路径 (无前端时)","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"ActionRequest":{"properties":{"thread_id":{"type":"string","title":"Thread Id","description":"LangGraph 会话 ID"},"action":{"type":"string","title":"Action","description":"动作名称"},"payload":{"additionalProperties":true,"type":"object","title":"Payload","description":"动作参数"},"project_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Project Id","description":"项目 ID"}},"type":"object","required":["thread_id","action"],"title":"ActionRequest","description":"Action 请求 - 前端按钮点击触发"},"ActionResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"message":{"type":"string","title":"Message"},"ui_interaction":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Ui Interaction"},"state_updates":{"additionalProperties":true,"type":"object","title":"State Updates"},"data":{"additionalProperties":true,"type":"object","title":"Data"}},"type":"object","required":["success","message"],"title":"ActionResponse","description":"Action 响应"},"ApproveRequest":{"properties":{"project_id":{"type":"string","format":"uuid","title":"Project Id"},"thread_id":{"type":"string","title":"Thread Id"},"approval":{"type":"boolean","title":"Approval","default":true},"selected_plan_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Selected Plan Id"},"feedback":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Feedback"}},"type":"object","required":["project_id","thread_id"],"title":"ApproveRequest","description":"用户确认请求"},"AssetExtractResponseData":{"properties":{"project_id":{"type":"string","title":"Project Id","description":"项目 ID"},"extracted_assets":{"items":{"$ref":"#/components/schemas/AssetResponseData"},"type":"array","title":"Extracted Assets","description":"提取的资产列表"},"message":{"type":"string","title":"Message","description":"消息"}},"type":"object","required":["project_id","message"],"title":"AssetExtractResponseData","description":"资产提取响应数据"},"AssetResponseData":{"properties":{"asset_id":{"type":"string","title":"Asset Id","description":"资产 ID"},"project_id":{"type":"string","title":"Project Id","description":"所属项目 ID"},"name":{"type":"string","title":"Name","description":"资产名称"},"asset_type":{"type":"string","title":"Asset Type","description":"资产类型 (character/location/prop)"},"visual_tokens":{"additionalProperties":true,"type":"object","title":"Visual Tokens","description":"视觉 Token"},"reference_urls":{"items":{"type":"string"},"type":"array","title":"Reference Urls","description":"参考图 URL"},"prompts":{"additionalProperties":{"type":"string"},"type":"object","title":"Prompts","description":"生成 Prompt"},"created_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Created At","description":"创建时间"},"updated_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Updated At","description":"更新时间"}},"type":"object","required":["asset_id","project_id","name","asset_type"],"title":"AssetResponseData","description":"资产响应数据","example":{"asset_id":"550e8400-e29b-41d4-a716-446655440006","asset_type":"character","created_at":"2026-02-02T04:00:00Z","name":"主角 - 陈默","project_id":"550e8400-e29b-41d4-a716-446655440000","prompts":{"nano_banana_prompt":"A young man...","sd_prompt":"portrait of a man..."},"reference_urls":["https://example.com/ref1.jpg"],"visual_tokens":{"age":"28","gender":"male","style":"modern"}}},"BatchLayoutUpdateResponseData":{"properties":{"updated_count":{"type":"integer","title":"Updated Count","description":"更新的节点数"},"layouts":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Layouts","description":"更新后的布局列表"},"message":{"type":"string","title":"Message","description":"消息"}},"type":"object","required":["updated_count","message"],"title":"BatchLayoutUpdateResponseData","description":"批量布局更新响应数据"},"Body_create_node_api_projects__project_id__nodes_post":{"properties":{"data":{"$ref":"#/components/schemas/NodeCreate"},"layout":{"anyOf":[{"$ref":"#/components/schemas/NodeLayoutUpdate"},{"type":"null"}]}},"type":"object","required":["data"],"title":"Body_create_node_api_projects__project_id__nodes_post"},"BranchCreateRequest":{"properties":{"source_thread_id":{"type":"string","title":"Source Thread Id","description":"源线程 ID"},"branch_point":{"type":"string","title":"Branch Point","description":"分叉点节点名称"},"branch_name":{"type":"string","title":"Branch Name","description":"分支名称"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"分支描述"},"modifications":{"additionalProperties":true,"type":"object","title":"Modifications","description":"状态修改"}},"type":"object","required":["source_thread_id","branch_point","branch_name"],"title":"BranchCreateRequest","description":"创建分支请求"},"BranchInfo":{"properties":{"thread_id":{"type":"string","title":"Thread Id","description":"线程 ID"},"branch_name":{"type":"string","title":"Branch Name","description":"分支名称"},"parent_thread_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Parent Thread Id","description":"父线程 ID"},"branch_point":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Branch Point","description":"分叉点节点"},"status":{"type":"string","title":"Status","description":"状态","default":"active"},"created_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Created At","description":"创建时间"},"metadata":{"additionalProperties":true,"type":"object","title":"Metadata","description":"元数据"}},"type":"object","required":["thread_id","branch_name"],"title":"BranchInfo","description":"分支信息"},"BranchResponse":{"properties":{"thread_id":{"type":"string","title":"Thread Id"},"branch_name":{"type":"string","title":"Branch Name"},"parent_thread_id":{"type":"string","title":"Parent Thread Id"},"branch_point":{"type":"string","title":"Branch Point"},"status":{"type":"string","title":"Status"}},"type":"object","required":["thread_id","branch_name","parent_thread_id","branch_point","status"],"title":"BranchResponse","description":"分支响应"},"BrowserRequest":{"properties":{"url":{"type":"string","title":"Url"}},"type":"object","required":["url"],"title":"BrowserRequest"},"CanvasData":{"properties":{"episode_id":{"type":"string","title":"Episode Id","description":"剧集 ID"},"viewport":{"$ref":"#/components/schemas/CanvasViewport"},"nodes":{"items":{"$ref":"#/components/schemas/ShotResponse"},"type":"array","title":"Nodes","description":"所有节点"},"connections":{"items":{"$ref":"#/components/schemas/Connection"},"type":"array","title":"Connections","description":"所有连线"}},"type":"object","required":["episode_id"],"title":"CanvasData","description":"画布完整数据 - v6.0"},"CanvasSaveRequest":{"properties":{"viewport":{"$ref":"#/components/schemas/CanvasViewport"},"nodes":{"items":{"$ref":"#/components/schemas/ShotResponse"},"type":"array","title":"Nodes"},"connections":{"items":{"$ref":"#/components/schemas/Connection"},"type":"array","title":"Connections"}},"type":"object","required":["viewport","nodes","connections"],"title":"CanvasSaveRequest","description":"保存画布请求"},"CanvasViewport":{"properties":{"x":{"type":"number","title":"X","description":"视口 X 偏移","default":0},"y":{"type":"number","title":"Y","description":"视口 Y 偏移","default":0},"zoom":{"type":"number","maximum":5.0,"minimum":0.1,"title":"Zoom","description":"缩放级别 10%-500%","default":1}},"type":"object","title":"CanvasViewport","description":"画布视口状态"},"ChatRequest":{"properties":{"project_id":{"type":"string","format":"uuid","title":"Project Id"},"message":{"type":"string","title":"Message"},"thread_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Thread Id"}},"type":"object","required":["project_id","message"],"title":"ChatRequest","description":"聊天请求"},"CheckpointInfo":{"properties":{"checkpoint_id":{"type":"string","title":"Checkpoint Id","description":"检查点 ID"},"node":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Node","description":"节点名称"},"timestamp":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Timestamp","description":"时间戳"},"metadata":{"additionalProperties":true,"type":"object","title":"Metadata","description":"元数据"}},"type":"object","required":["checkpoint_id"],"title":"CheckpointInfo","description":"检查点信息"},"Connection":{"properties":{"id":{"type":"string","title":"Id","description":"连线 ID"},"source":{"type":"string","title":"Source","description":"源节点 ID"},"target":{"type":"string","title":"Target","description":"目标节点 ID"},"type":{"type":"string","title":"Type","description":"sequence | reference","default":"sequence"}},"type":"object","required":["id","source","target"],"title":"Connection","description":"节点连线 - v6.0"},"ConnectionCreate":{"properties":{"source_shot_id":{"type":"string","format":"uuid","title":"Source Shot Id","description":"源节点 ID"},"target_shot_id":{"type":"string","format":"uuid","title":"Target Shot Id","description":"目标节点 ID"},"connection_type":{"type":"string","title":"Connection Type","description":"sequence | reference","default":"sequence"}},"type":"object","required":["source_shot_id","target_shot_id"],"title":"ConnectionCreate","description":"创建连线请求"},"ConnectionResponse":{"properties":{"connection_id":{"type":"string","format":"uuid","title":"Connection Id"},"episode_id":{"type":"string","format":"uuid","title":"Episode Id"},"source_shot_id":{"type":"string","format":"uuid","title":"Source Shot Id"},"target_shot_id":{"type":"string","format":"uuid","title":"Target Shot Id"},"connection_type":{"type":"string","title":"Connection Type"},"created_at":{"type":"string","title":"Created At"}},"type":"object","required":["connection_id","episode_id","source_shot_id","target_shot_id","connection_type","created_at"],"title":"ConnectionResponse","description":"连线响应"},"DouyinRequest":{"properties":{"share_link":{"type":"string","title":"Share Link"}},"type":"object","required":["share_link"],"title":"DouyinRequest"},"EpisodeCreate":{"properties":{"title":{"type":"string","maxLength":100,"minLength":1,"title":"Title","description":"剧集标题"},"summary":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Summary","description":"剧情摘要"}},"type":"object","required":["title"],"title":"EpisodeCreate","description":"创建剧集请求"},"EpisodeListResponse":{"properties":{"episodeId":{"type":"string","format":"uuid","title":"Episodeid"},"episodeNumber":{"type":"integer","title":"Episodenumber"},"title":{"type":"string","title":"Title"},"summary":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Summary"},"status":{"type":"string","title":"Status"},"shotCount":{"type":"integer","title":"Shotcount"},"createdAt":{"type":"string","format":"date-time","title":"Createdat"}},"type":"object","required":["episodeId","episodeNumber","title","summary","status","shotCount","createdAt"],"title":"EpisodeListResponse","description":"剧集列表响应（精简）"},"EpisodeResponse":{"properties":{"title":{"type":"string","maxLength":100,"minLength":1,"title":"Title","description":"剧集标题"},"summary":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Summary","description":"剧情摘要"},"episodeId":{"type":"string","format":"uuid","title":"Episodeid"},"projectId":{"type":"string","format":"uuid","title":"Projectid"},"episodeNumber":{"type":"integer","title":"Episodenumber"},"scriptText":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Scripttext"},"scriptScenes":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Scriptscenes"},"novelContent":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Novelcontent"},"wordCount":{"type":"integer","title":"Wordcount"},"status":{"type":"string","title":"Status"},"canvasData":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Canvasdata"},"shotCount":{"type":"integer","title":"Shotcount"},"createdAt":{"type":"string","format":"date-time","title":"Createdat"},"updatedAt":{"type":"string","format":"date-time","title":"Updatedat"}},"type":"object","required":["title","episodeId","projectId","episodeNumber","scriptText","scriptScenes","novelContent","wordCount","status","shotCount","createdAt","updatedAt"],"title":"EpisodeResponse","description":"剧集详情响应（完整）"},"EpisodeUpdate":{"properties":{"title":{"anyOf":[{"type":"string","maxLength":100,"minLength":1},{"type":"null"}],"title":"Title"},"summary":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Summary","description":"剧情摘要"},"scriptText":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Scripttext","description":"剧本内容"},"novelContent":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Novelcontent","description":"小说内容"}},"type":"object","title":"EpisodeUpdate","description":"更新剧集请求"},"GraphStateResponse":{"properties":{"thread_id":{"type":"string","title":"Thread Id"},"current_stage":{"type":"string","title":"Current Stage"},"approval_status":{"type":"string","title":"Approval Status"},"messages_count":{"type":"integer","title":"Messages Count"}},"type":"object","required":["thread_id","current_stage","approval_status","messages_count"],"title":"GraphStateResponse","description":"Graph 状态响应"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"HealthResponse":{"properties":{"status":{"type":"string","title":"Status","description":"服务状态"},"version":{"type":"string","title":"Version","description":"应用版本"},"uptime_seconds":{"type":"number","title":"Uptime Seconds","description":"运行时间 (秒)"},"database":{"type":"string","title":"Database","description":"数据库连接状态"},"redis":{"type":"string","title":"Redis","description":"Redis 连接状态"}},"type":"object","required":["status","version","uptime_seconds","database","redis"],"title":"HealthResponse","description":"健康检查响应","example":{"database":"connected","redis":"connected","status":"healthy","uptime_seconds":3600.5,"version":"1.0.0"}},"JobCreate":{"properties":{"project_id":{"type":"string","format":"uuid","title":"Project Id","description":"所属项目 ID"},"type":{"$ref":"#/components/schemas/JobType"},"priority":{"type":"integer","maximum":10.0,"minimum":0.0,"title":"Priority","description":"优先级 (0-10, 10最高)","default":0},"input_payload":{"additionalProperties":true,"type":"object","title":"Input Payload","description":"任务输入参数"}},"type":"object","required":["project_id","type"],"title":"JobCreate","description":"创建任务请求"},"JobResponse":{"properties":{"job_id":{"type":"string","format":"uuid","title":"Job Id","description":"任务 ID"},"project_id":{"type":"string","format":"uuid","title":"Project Id","description":"所属项目 ID"},"type":{"$ref":"#/components/schemas/JobType"},"status":{"$ref":"#/components/schemas/JobStatus"},"priority":{"type":"integer","title":"Priority","description":"优先级"},"progress_percent":{"type":"integer","title":"Progress Percent","description":"进度百分比","default":0},"current_step":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Current Step","description":"当前步骤"},"input_payload":{"additionalProperties":true,"type":"object","title":"Input Payload"},"output_result":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Output Result","description":"任务结果"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message","description":"错误信息"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"创建时间"},"started_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Started At","description":"开始时间"},"ended_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Ended At","description":"结束时间"}},"type":"object","required":["job_id","project_id","type","status","priority","created_at"],"title":"JobResponse","description":"任务响应","example":{"created_at":"2026-02-02T04:00:00Z","current_step":"Generating episode 3...","input_payload":{"episode_number":3},"job_id":"550e8400-e29b-41d4-a716-446655440003","priority":5,"progress_percent":45,"project_id":"550e8400-e29b-41d4-a716-446655440000","started_at":"2026-02-02T04:00:05Z","status":"RUNNING","type":"novel_writing"}},"JobStatus":{"type":"string","enum":["PENDING","RUNNING","COMPLETED","FAILED","CANCELLED","DEAD_LETTER"],"title":"JobStatus","description":"任务状态"},"JobType":{"type":"string","enum":["agent_reasoning","novel_writing","script_extraction","storyboard_generation","image_generation","video_generation","batch_export","checkpoint_cleanup","watchdog_scan"],"title":"JobType","description":"任务类型"},"LayoutUpdateResponseData":{"properties":{"node_id":{"type":"string","title":"Node Id","description":"节点 ID"},"layout":{"$ref":"#/components/schemas/NodeLayout","description":"布局信息"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At","description":"更新时间"},"message":{"type":"string","title":"Message","description":"消息","default":"Layout updated successfully"}},"type":"object","required":["node_id","layout"],"title":"LayoutUpdateResponseData","description":"布局更新响应数据"},"MappingResponseData":{"properties":{"id":{"type":"string","title":"Id","description":"映射 ID"},"project_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Project Id","description":"项目 ID"},"task_type":{"type":"string","title":"Task Type","description":"任务类型"},"provider_id":{"type":"string","title":"Provider Id","description":"服务商 ID"},"model_name":{"type":"string","title":"Model Name","description":"模型名称"},"parameters":{"additionalProperties":true,"type":"object","title":"Parameters","description":"模型参数"},"provider_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Provider Name","description":"服务商名称"},"created_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Created At","description":"创建时间"}},"type":"object","required":["id","task_type","provider_id","model_name"],"title":"MappingResponseData","description":"映射响应数据"},"ModelMappingCreate":{"properties":{"task_type":{"$ref":"#/components/schemas/TaskType","description":"任务类型"},"provider_id":{"type":"string","format":"uuid","title":"Provider Id","description":"服务商 ID"},"model_name":{"type":"string","title":"Model Name","description":"模型名称"},"parameters":{"additionalProperties":true,"type":"object","title":"Parameters","description":"模型参数"},"project_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Project Id","description":"项目 ID (空则为全局默认)"}},"type":"object","required":["task_type","provider_id","model_name"],"title":"ModelMappingCreate","description":"创建映射请求"},"ModelMappingUpdate":{"properties":{"provider_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Provider Id"},"model_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Model Name"},"parameters":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Parameters"}},"type":"object","title":"ModelMappingUpdate","description":"更新映射请求"},"ModelProviderCreate":{"properties":{"name":{"type":"string","maxLength":50,"minLength":1,"title":"Name","description":"服务商名称"},"provider_type":{"$ref":"#/components/schemas/ProviderType","description":"服务商类型 (LLM/视频)","default":"llm"},"protocol":{"$ref":"#/components/schemas/ProtocolType","description":"API 协议","default":"openai"},"base_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Base Url","description":"API Base URL"},"is_active":{"type":"boolean","title":"Is Active","description":"是否启用","default":true},"api_key":{"type":"string","minLength":1,"title":"Api Key","description":"API Key"}},"type":"object","required":["name","api_key"],"title":"ModelProviderCreate","description":"创建服务商请求"},"ModelProviderUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":50,"minLength":1},{"type":"null"}],"title":"Name"},"protocol":{"anyOf":[{"$ref":"#/components/schemas/ProtocolType"},{"type":"null"}]},"base_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Base Url"},"api_key":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Api Key"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"}},"type":"object","title":"ModelProviderUpdate","description":"更新服务商请求"},"ModelTestRequest":{"properties":{"provider_id":{"type":"string","format":"uuid","title":"Provider Id","description":"服务商 ID"},"model_name":{"type":"string","title":"Model Name","description":"要测试的模型名称"},"prompt":{"type":"string","title":"Prompt","description":"测试 Prompt","default":"Hello, can you respond?"}},"type":"object","required":["provider_id","model_name"],"title":"ModelTestRequest","description":"模型测试请求"},"ModelTestResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"response":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Response"},"latency_ms":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Latency Ms"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"ModelTestResponse","description":"模型测试响应"},"NodeCreate":{"properties":{"type":{"$ref":"#/components/schemas/NodeType","description":"节点类型"},"content":{"additionalProperties":true,"type":"object","title":"Content","description":"节点内容 (JSONB)"},"project_id":{"type":"string","format":"uuid","title":"Project Id","description":"所属项目 ID"},"parent_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Parent Id","description":"父节点 ID (用于连线)"}},"type":"object","required":["type","project_id"],"title":"NodeCreate","description":"创建节点请求"},"NodeLayout":{"properties":{"canvas_tab":{"type":"string","title":"Canvas Tab"},"position_x":{"type":"number","title":"Position X"},"position_y":{"type":"number","title":"Position Y"}},"type":"object","required":["canvas_tab","position_x","position_y"],"title":"NodeLayout","description":"节点布局数据"},"NodeLayoutUpdate":{"properties":{"node_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Node Id","description":"节点 ID (批量更新时使用)"},"canvas_tab":{"type":"string","title":"Canvas Tab","description":"画布 Tab (novel/drama)"},"position_x":{"type":"number","title":"Position X","description":"X 坐标"},"position_y":{"type":"number","title":"Position Y","description":"Y 坐标"}},"type":"object","required":["canvas_tab","position_x","position_y"],"title":"NodeLayoutUpdate","description":"更新节点布局"},"NodeResponse":{"properties":{"type":{"$ref":"#/components/schemas/NodeType","description":"节点类型"},"content":{"additionalProperties":true,"type":"object","title":"Content","description":"节点内容 (JSONB)"},"id":{"type":"string","format":"uuid","title":"Id","description":"节点 ID"},"project_id":{"type":"string","format":"uuid","title":"Project Id","description":"所属项目 ID"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"创建时间"},"layout":{"anyOf":[{"$ref":"#/components/schemas/NodeLayout"},{"type":"null"}],"description":"布局信息"},"parent_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Parent Id","description":"父节点 ID"}},"type":"object","required":["type","id","project_id","created_at"],"title":"NodeResponse","description":"节点响应","example":{"content":{"episode_number":1,"quality_score":85.5,"text":"陈默睁开眼睛，发现自己回到了十年前...","title":"重生归来","word_count":523},"created_at":"2026-02-02T04:00:00Z","id":"550e8400-e29b-41d4-a716-446655440002","layout":{"canvas_tab":"novel","position_x":100.0,"position_y":200.0},"project_id":"550e8400-e29b-41d4-a716-446655440000","type":"episode"}},"NodeTreeItem":{"properties":{"node_id":{"type":"string","title":"Node Id","description":"节点 ID"},"type":{"type":"string","title":"Type","description":"节点类型"},"content":{"additionalProperties":true,"type":"object","title":"Content","description":"节点内容"},"children":{"items":{"$ref":"#/components/schemas/NodeTreeItem"},"type":"array","title":"Children","description":"子节点"}},"type":"object","required":["node_id","type"],"title":"NodeTreeItem","description":"节点树项（递归结构）"},"NodeTreeResponseData":{"properties":{"project_id":{"type":"string","title":"Project Id","description":"项目 ID"},"roots":{"items":{"$ref":"#/components/schemas/NodeTreeItem"},"type":"array","title":"Roots","description":"根节点列表"},"total_count":{"type":"integer","title":"Total Count","description":"总节点数"}},"type":"object","required":["project_id","roots","total_count"],"title":"NodeTreeResponseData","description":"节点树响应数据"},"NodeType":{"type":"string","enum":["config","market_report","story_plan","character","outline","episode_outline","episode","novel_chapter","scene","script_scene","shot","storyboard_shot","asset","video","note"],"title":"NodeType","description":"节点类型\n\n对应系统架构文档中的 story_nodes.type 字段"},"NodeUpdate":{"properties":{"content":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Content"}},"type":"object","title":"NodeUpdate","description":"更新节点请求"},"NodeWithLayout":{"properties":{"node_id":{"type":"string","format":"uuid","title":"Node Id","description":"节点 ID"},"project_id":{"type":"string","format":"uuid","title":"Project Id","description":"所属项目 ID"},"type":{"$ref":"#/components/schemas/NodeType","description":"节点类型"},"content":{"additionalProperties":true,"type":"object","title":"Content","description":"节点内容"},"parent_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Parent Id","description":"父节点 ID"},"created_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Created At","description":"创建时间"},"layout":{"anyOf":[{"$ref":"#/components/schemas/NodeLayout"},{"type":"null"}],"description":"布局信息"}},"type":"object","required":["node_id","project_id","type"],"title":"NodeWithLayout","description":"节点数据（包含布局信息）\n\n用于 GET /projects/{project_id}/nodes 端点","example":{"content":{"episode_number":1,"text":"陈默睁开眼睛...","title":"重生归来"},"created_at":"2026-02-02T04:00:00Z","layout":{"canvas_tab":"novel","position_x":100.0,"position_y":200.0},"node_id":"550e8400-e29b-41d4-a716-446655440002","project_id":"550e8400-e29b-41d4-a716-446655440000","type":"novel_chapter"}},"PaginatedResponse_AssetResponseData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/AssetResponseData"},"type":"array","title":"Data","description":"数据列表"},"total":{"type":"integer","title":"Total","description":"总记录数"},"page":{"type":"integer","title":"Page","description":"当前页码 (从 1 开始)"},"page_size":{"type":"integer","title":"Page Size","description":"每页大小"},"total_pages":{"type":"integer","title":"Total Pages","description":"总页数"},"has_next":{"type":"boolean","title":"Has Next","description":"是否有下一页"},"has_prev":{"type":"boolean","title":"Has Prev","description":"是否有上一页"}},"type":"object","required":["data","total","page","page_size","total_pages","has_next","has_prev"],"title":"PaginatedResponse[AssetResponseData]"},"PaginatedResponse_JobResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/JobResponse"},"type":"array","title":"Data","description":"数据列表"},"total":{"type":"integer","title":"Total","description":"总记录数"},"page":{"type":"integer","title":"Page","description":"当前页码 (从 1 开始)"},"page_size":{"type":"integer","title":"Page Size","description":"每页大小"},"total_pages":{"type":"integer","title":"Total Pages","description":"总页数"},"has_next":{"type":"boolean","title":"Has Next","description":"是否有下一页"},"has_prev":{"type":"boolean","title":"Has Prev","description":"是否有上一页"}},"type":"object","required":["data","total","page","page_size","total_pages","has_next","has_prev"],"title":"PaginatedResponse[JobResponse]"},"PaginatedResponse_ProjectResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/ProjectResponse"},"type":"array","title":"Data","description":"数据列表"},"total":{"type":"integer","title":"Total","description":"总记录数"},"page":{"type":"integer","title":"Page","description":"当前页码 (从 1 开始)"},"page_size":{"type":"integer","title":"Page Size","description":"每页大小"},"total_pages":{"type":"integer","title":"Total Pages","description":"总页数"},"has_next":{"type":"boolean","title":"Has Next","description":"是否有下一页"},"has_prev":{"type":"boolean","title":"Has Prev","description":"是否有上一页"}},"type":"object","required":["data","total","page","page_size","total_pages","has_next","has_prev"],"title":"PaginatedResponse[ProjectResponse]"},"ProjectCreate":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name","description":"项目名称"},"coverImage":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Coverimage","description":"封面图 URL"},"meta":{"$ref":"#/components/schemas/ProjectMeta","description":"项目元数据"}},"type":"object","required":["name"],"title":"ProjectCreate","description":"创建项目请求"},"ProjectMeta":{"properties":{"genre":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Genre","description":"题材赛道"},"subTags":{"items":{"type":"string"},"type":"array","title":"Subtags","description":"细分标签"},"tone":{"items":{"type":"string"},"type":"array","title":"Tone","description":"内容调性"},"targetWordCount":{"type":"integer","title":"Targetwordcount","description":"单集字数","default":500},"totalEpisodes":{"type":"integer","title":"Totalepisodes","description":"目标集数","default":80},"endingType":{"type":"string","title":"Endingtype","description":"结局类型","default":"HE"},"aspectRatio":{"type":"string","title":"Aspectratio","description":"画幅比例","default":"9:16"},"drawingType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Drawingtype","description":"绘图类型"},"visualStyle":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Visualstyle","description":"画面风格"},"styleDna":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Styledna","description":"文风 DNA"},"avoidTags":{"items":{"type":"string"},"type":"array","title":"Avoidtags","description":"排除标签"}},"type":"object","title":"ProjectMeta","description":"项目元数据 (存储在 JSONB 字段)\n\n对应 Product-Spec.md 中的 UserConfig"},"ProjectResponse":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name","description":"项目名称"},"coverImage":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Coverimage","description":"封面图 URL"},"meta":{"$ref":"#/components/schemas/ProjectMeta","description":"项目元数据"},"id":{"type":"string","format":"uuid","title":"Id","description":"项目 ID"},"userId":{"type":"string","format":"uuid","title":"Userid","description":"所属用户 ID"},"createdAt":{"type":"string","format":"date-time","title":"Createdat","description":"创建时间"},"updatedAt":{"type":"string","format":"date-time","title":"Updatedat","description":"更新时间"},"nodeCount":{"type":"integer","title":"Nodecount","description":"节点数量","default":0},"episodeCount":{"type":"integer","title":"Episodecount","description":"已生成集数","default":0}},"type":"object","required":["name","id","userId","createdAt","updatedAt"],"title":"ProjectResponse","description":"项目响应","example":{"cover_image":"https://storage.example.com/covers/project1.jpg","created_at":"2026-02-02T04:00:00Z","episode_count":5,"id":"550e8400-e29b-41d4-a716-446655440000","meta":{"ending_type":"HE","genre":"逆袭复仇","sub_tags":["战神回归","重生改命"],"target_word_count":500,"tone":["爽","虐"],"total_episodes":80},"name":"重生之逆袭人生","node_count":25,"updated_at":"2026-02-02T04:00:00Z","user_id":"550e8400-e29b-41d4-a716-446655440001"}},"ProjectUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":100,"minLength":1},{"type":"null"}],"title":"Name"},"cover_image":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cover Image"},"meta":{"anyOf":[{"$ref":"#/components/schemas/ProjectMeta"},{"type":"null"}]}},"type":"object","title":"ProjectUpdate","description":"更新项目请求 (所有字段可选)"},"ProtocolType":{"type":"string","enum":["openai","anthropic","gemini","azure","sora","runway","pika"],"title":"ProtocolType","description":"API 协议类型"},"ProviderResponseData":{"properties":{"id":{"type":"string","title":"Id","description":"服务商 ID"},"name":{"type":"string","title":"Name","description":"服务商名称"},"provider_type":{"type":"string","title":"Provider Type","description":"服务商类型"},"protocol":{"type":"string","title":"Protocol","description":"API 协议"},"base_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Base Url","description":"API Base URL"},"is_active":{"type":"boolean","title":"Is Active","description":"是否启用"},"available_models":{"items":{"type":"string"},"type":"array","title":"Available Models","description":"可用模型列表"},"api_key_preview":{"type":"string","title":"Api Key Preview","description":"API Key 预览"},"created_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Created At","description":"创建时间"},"last_verified_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Last Verified At","description":"最后验证时间"}},"type":"object","required":["id","name","provider_type","protocol","is_active","api_key_preview"],"title":"ProviderResponseData","description":"服务商响应数据（用于 list_providers 等端点）"},"ProviderType":{"type":"string","enum":["llm","video"],"title":"ProviderType","description":"服务商类型"},"RollbackRequest":{"properties":{"thread_id":{"type":"string","title":"Thread Id","description":"线程 ID"},"checkpoint_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Checkpoint Id","description":"目标检查点 ID"},"steps_back":{"type":"integer","title":"Steps Back","description":"回退步数","default":1},"reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Reason","description":"回滚原因"}},"type":"object","required":["thread_id"],"title":"RollbackRequest","description":"回滚请求"},"RollbackResponseData":{"properties":{"thread_id":{"type":"string","title":"Thread Id","description":"线程 ID"},"checkpoint_id":{"type":"string","title":"Checkpoint Id","description":"检查点 ID"},"node":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Node","description":"节点名称"},"message":{"type":"string","title":"Message","description":"消息"}},"type":"object","required":["thread_id","checkpoint_id","message"],"title":"RollbackResponseData","description":"回滚响应数据"},"SceneCreate":{"properties":{"location":{"type":"string","maxLength":200,"minLength":1,"title":"Location","description":"场景地点"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"场景描述"},"createMasterNode":{"type":"boolean","title":"Createmasternode","description":"是否同时创建 Scene Master 节点","default":false},"masterPositionX":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Masterpositionx","description":"Master 节点 X 坐标"},"masterPositionY":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Masterpositiony","description":"Master 节点 Y 坐标"}},"type":"object","required":["location"],"title":"SceneCreate","description":"创建场景请求"},"SceneResponse":{"properties":{"location":{"type":"string","maxLength":200,"minLength":1,"title":"Location","description":"场景地点"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"场景描述"},"sceneId":{"type":"string","format":"uuid","title":"Sceneid"},"episodeId":{"type":"string","format":"uuid","title":"Episodeid"},"sceneNumber":{"type":"string","title":"Scenenumber"},"masterNodeId":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Masternodeid"},"shotCount":{"type":"integer","title":"Shotcount"},"createdAt":{"type":"string","format":"date-time","title":"Createdat"},"updatedAt":{"type":"string","format":"date-time","title":"Updatedat"}},"type":"object","required":["location","sceneId","episodeId","sceneNumber","masterNodeId","shotCount","createdAt","updatedAt"],"title":"SceneResponse","description":"场景响应"},"SceneUpdate":{"properties":{"location":{"anyOf":[{"type":"string","maxLength":200,"minLength":1},{"type":"null"}],"title":"Location"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"场景描述"}},"type":"object","title":"SceneUpdate","description":"更新场景请求"},"SearchRequest":{"properties":{"query":{"type":"string","title":"Query"}},"type":"object","required":["query"],"title":"SearchRequest"},"ShotBatchCreate":{"properties":{"shots":{"items":{"$ref":"#/components/schemas/ShotCreate"},"type":"array","title":"Shots"}},"type":"object","required":["shots"],"title":"ShotBatchCreate","description":"批量创建分镜请求"},"ShotBatchUpdate":{"properties":{"positions":{"items":{"$ref":"#/components/schemas/ShotPositionUpdate"},"type":"array","title":"Positions"}},"type":"object","required":["positions"],"title":"ShotBatchUpdate","description":"批量更新位置请求"},"ShotCreate":{"properties":{"title":{"type":"string","maxLength":50,"minLength":1,"title":"Title","description":"景别"},"subtitle":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Subtitle","description":"运镜方式"},"sceneId":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Sceneid"},"nodeType":{"type":"string","pattern":"^(shot|scene_master)$","title":"Nodetype"},"positionX":{"type":"number","title":"Positionx","description":"X 坐标","default":0},"positionY":{"type":"number","title":"Positiony","description":"Y 坐标","default":0},"details":{"anyOf":[{"$ref":"#/components/schemas/ShotDetails"},{"type":"null"}]}},"type":"object","required":["title","nodeType"],"title":"ShotCreate","description":"创建分镜请求"},"ShotDetails":{"properties":{"dialogue":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Dialogue","description":"对白"},"sound":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sound","description":"音效"},"cameraMove":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cameramove","description":"运镜方式"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"画面描述"},"prompt":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Prompt","description":"AI 生图提示词"},"negativePrompt":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Negativeprompt","description":"负面提示词"},"resolution":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Resolution","description":"2K | 4K"},"aspectRatio":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Aspectratio","description":"16:9 | 9:16 | 1:1 | 4:3"},"style":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Style","description":"画面风格"},"referenceImages":{"anyOf":[{"additionalProperties":{"anyOf":[{"type":"string"},{"type":"null"}]},"type":"object"},{"type":"null"}],"title":"Referenceimages","description":"{ sketch, material, threeD }"},"generationParams":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Generationparams","description":"{ seed, steps, cfg }"}},"type":"object","title":"ShotDetails","description":"ShotNode 详细内容 - v6.0 嵌套在 details 中"},"ShotPositionUpdate":{"properties":{"shotId":{"type":"string","format":"uuid","title":"Shotid"},"x":{"type":"number","title":"X"},"y":{"type":"number","title":"Y"}},"type":"object","required":["shotId","x","y"],"title":"ShotPositionUpdate","description":"位置更新项"},"ShotResponse":{"properties":{"title":{"type":"string","maxLength":50,"minLength":1,"title":"Title","description":"景别"},"subtitle":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Subtitle","description":"运镜方式"},"shotId":{"type":"string","format":"uuid","title":"Shotid"},"episodeId":{"type":"string","format":"uuid","title":"Episodeid"},"sceneId":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Sceneid"},"nodeType":{"type":"string","title":"Nodetype"},"shotNumber":{"type":"integer","title":"Shotnumber"},"thumbnailUrl":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Thumbnailurl"},"imageUrl":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Imageurl"},"status":{"type":"string","title":"Status"},"positionX":{"type":"number","title":"Positionx"},"positionY":{"type":"number","title":"Positiony"},"details":{"anyOf":[{"$ref":"#/components/schemas/ShotDetails"},{"type":"null"}]},"createdAt":{"type":"string","format":"date-time","title":"Createdat"},"updatedAt":{"type":"string","format":"date-time","title":"Updatedat"}},"type":"object","required":["title","shotId","episodeId","sceneId","nodeType","shotNumber","thumbnailUrl","imageUrl","status","positionX","positionY","details","createdAt","updatedAt"],"title":"ShotResponse","description":"分镜响应 - 完整 ShotNode"},"ShotUpdate":{"properties":{"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title"},"subtitle":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subtitle"},"status":{"anyOf":[{"type":"string","pattern":"^(pending|processing|completed|approved|revision)$"},{"type":"null"}],"title":"Status"},"positionX":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Positionx"},"positionY":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Positiony"},"thumbnailUrl":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Thumbnailurl"},"imageUrl":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Imageurl"},"details":{"anyOf":[{"$ref":"#/components/schemas/ShotDetails"},{"type":"null"}]}},"type":"object","title":"ShotUpdate","description":"更新分镜请求"},"StatePatchRequest":{"properties":{"thread_id":{"type":"string","title":"Thread Id","description":"线程 ID"},"patches":{"additionalProperties":true,"type":"object","title":"Patches","description":"状态修补"},"mode":{"type":"string","title":"Mode","description":"重启模式: soft/hard","default":"soft"}},"type":"object","required":["thread_id","patches"],"title":"StatePatchRequest","description":"状态修补请求 (Live Directing)"},"StatePatchResponseData":{"properties":{"thread_id":{"type":"string","title":"Thread Id","description":"线程 ID"},"applied_patches":{"items":{"type":"string"},"type":"array","title":"Applied Patches","description":"应用的补丁字段"},"current_node":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Current Node","description":"当前节点"},"mode":{"type":"string","title":"Mode","description":"模式 (soft/hard)"},"message":{"type":"string","title":"Message","description":"消息"}},"type":"object","required":["thread_id","applied_patches","mode","message"],"title":"StatePatchResponseData","description":"状态修补响应数据"},"SuccessResponse_ActionResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/ActionResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[ActionResponse]"},"SuccessResponse_AssetExtractResponseData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/AssetExtractResponseData"}},"type":"object","required":["data"],"title":"SuccessResponse[AssetExtractResponseData]"},"SuccessResponse_AssetResponseData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/AssetResponseData"}},"type":"object","required":["data"],"title":"SuccessResponse[AssetResponseData]"},"SuccessResponse_BatchLayoutUpdateResponseData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/BatchLayoutUpdateResponseData"}},"type":"object","required":["data"],"title":"SuccessResponse[BatchLayoutUpdateResponseData]"},"SuccessResponse_BranchResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/BranchResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[BranchResponse]"},"SuccessResponse_CanvasData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/CanvasData"}},"type":"object","required":["data"],"title":"SuccessResponse[CanvasData]"},"SuccessResponse_CanvasViewport_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/CanvasViewport"}},"type":"object","required":["data"],"title":"SuccessResponse[CanvasViewport]"},"SuccessResponse_ConnectionResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/ConnectionResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[ConnectionResponse]"},"SuccessResponse_EpisodeResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/EpisodeResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[EpisodeResponse]"},"SuccessResponse_GraphStateResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/GraphStateResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[GraphStateResponse]"},"SuccessResponse_JobResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/JobResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[JobResponse]"},"SuccessResponse_LayoutUpdateResponseData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/LayoutUpdateResponseData"}},"type":"object","required":["data"],"title":"SuccessResponse[LayoutUpdateResponseData]"},"SuccessResponse_List_ConnectionResponse__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/ConnectionResponse"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[List[ConnectionResponse]]"},"SuccessResponse_List_EpisodeListResponse__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/EpisodeListResponse"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[List[EpisodeListResponse]]"},"SuccessResponse_List_SceneResponse__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/SceneResponse"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[List[SceneResponse]]"},"SuccessResponse_List_ShotResponse__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/ShotResponse"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[List[ShotResponse]]"},"SuccessResponse_MappingResponseData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/MappingResponseData"}},"type":"object","required":["data"],"title":"SuccessResponse[MappingResponseData]"},"SuccessResponse_NodeResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/NodeResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[NodeResponse]"},"SuccessResponse_NodeTreeResponseData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/NodeTreeResponseData"}},"type":"object","required":["data"],"title":"SuccessResponse[NodeTreeResponseData]"},"SuccessResponse_ProjectResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/ProjectResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[ProjectResponse]"},"SuccessResponse_ProviderResponseData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/ProviderResponseData"}},"type":"object","required":["data"],"title":"SuccessResponse[ProviderResponseData]"},"SuccessResponse_RollbackResponseData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/RollbackResponseData"}},"type":"object","required":["data"],"title":"SuccessResponse[RollbackResponseData]"},"SuccessResponse_SceneResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/SceneResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[SceneResponse]"},"SuccessResponse_ShotResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/ShotResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[ShotResponse]"},"SuccessResponse_StatePatchResponseData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/StatePatchResponseData"}},"type":"object","required":["data"],"title":"SuccessResponse[StatePatchResponseData]"},"SuccessResponse_dict_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"additionalProperties":true,"type":"object","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[dict]"},"SuccessResponse_list_BranchInfo__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/BranchInfo"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[BranchInfo]]"},"SuccessResponse_list_CheckpointInfo__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/CheckpointInfo"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[CheckpointInfo]]"},"SuccessResponse_list_MappingResponseData__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/MappingResponseData"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[MappingResponseData]]"},"SuccessResponse_list_NodeWithLayout__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/NodeWithLayout"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[NodeWithLayout]]"},"SuccessResponse_list_ProviderResponseData__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/ProviderResponseData"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[ProviderResponseData]]"},"SuccessResponse_list_TaskTypeInfo__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/TaskTypeInfo"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[TaskTypeInfo]]"},"SuccessResponse_list_str__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"type":"string"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[str]]"},"TaskType":{"type":"string","enum":["router","market_analyst","story_planner","skeleton_builder","novel_writer","editor","refiner","analysis_lab","script_adapter","script_parser","script_formatter","storyboard_director","storyboard_artist","prompt_generator","asset_inspector","embedding","summary"],"title":"TaskType","description":"Agent 任务类型\n\n用于 Task-Model Routing，将不同任务路由到最适合的模型。"},"TaskTypeInfo":{"properties":{"value":{"type":"string","title":"Value","description":"值"},"label":{"type":"string","title":"Label","description":"显示标签"}},"type":"object","required":["value","label"],"title":"TaskTypeInfo","description":"任务类型信息"},"ToolCategory":{"properties":{"id":{"type":"string","title":"Id","description":"类别 ID"},"name":{"type":"string","title":"Name","description":"类别名称"},"icon":{"type":"string","title":"Icon","description":"图标"}},"type":"object","required":["id","name","icon"],"title":"ToolCategory","description":"工具类别"},"ToolInfo":{"properties":{"id":{"type":"string","title":"Id","description":"工具 ID"},"name":{"type":"string","title":"Name","description":"工具名称"},"description":{"type":"string","title":"Description","description":"描述"},"category":{"type":"string","title":"Category","description":"类别"},"icon":{"type":"string","title":"Icon","description":"图标"},"endpoint":{"type":"string","title":"Endpoint","description":"API 端点"},"params":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Params","description":"参数列表"}},"type":"object","required":["id","name","description","category","icon","endpoint"],"title":"ToolInfo","description":"工具信息"},"ToolListResponse":{"properties":{"tools":{"items":{"$ref":"#/components/schemas/ToolInfo"},"type":"array","title":"Tools","description":"工具列表"},"categories":{"items":{"$ref":"#/components/schemas/ToolCategory"},"type":"array","title":"Categories","description":"类别列表"}},"type":"object","required":["tools","categories"],"title":"ToolListResponse","description":"工具列表响应"},"ToolResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"data":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Data"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"ToolResponse"},"ToolStatusDetail":{"properties":{"available":{"type":"boolean","title":"Available","description":"是否可用"},"latency_ms":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Latency Ms","description":"延迟 (毫秒)"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"错误信息"}},"type":"object","required":["available"],"title":"ToolStatusDetail","description":"工具状态详情"},"ToolStatusResponse":{"properties":{"status":{"additionalProperties":{"$ref":"#/components/schemas/ToolStatusDetail"},"type":"object","title":"Status","description":"各工具状态"}},"type":"object","required":["status"],"title":"ToolStatusResponse","description":"工具状态响应"},"TopologyResponse":{"properties":{"mermaid":{"type":"string","title":"Mermaid","description":"Mermaid 格式的流程图定义"}},"type":"object","required":["mermaid"],"title":"TopologyResponse","description":"图拓扑结构响应"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"VideoInfoRequest":{"properties":{"url":{"type":"string","title":"Url"}},"type":"object","required":["url"],"title":"VideoInfoRequest"},"VideoSearchRequest":{"properties":{"keyword":{"type":"string","title":"Keyword"},"platform":{"type":"string","title":"Platform","default":"youtube"},"count":{"type":"integer","title":"Count","default":5}},"type":"object","required":["keyword"],"title":"VideoSearchRequest"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}