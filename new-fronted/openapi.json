{"openapi":"3.1.0","info":{"title":"AI Drama Studio API (Rebuilt)","description":"Clean architecture backend for AI Drama Studio","version":"4.1.0"},"paths":{"/api/graph/chat":{"post":{"tags":["graph"],"summary":"Chat Endpoint","description":"Main chat endpoint for the LangGraph workflow system.\n\nHandles:\n- Cold start (welcome message with function entry buttons)\n- Single-step workflows\n- Multi-step workflows","operationId":"chat_endpoint_api_graph_chat_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["graph"],"summary":"Chat Sse Endpoint","description":"SSE chat endpoint for streaming responses.\nSupports EventSource from frontend.","operationId":"chat_sse_endpoint_api_graph_chat_get","parameters":[{"name":"message","in":"query","required":false,"schema":{"type":"string","default":"","title":"Message"}},{"name":"project_id","in":"query","required":false,"schema":{"type":"string","default":"","title":"Project Id"}},{"name":"thread_id","in":"query","required":false,"schema":{"type":"string","default":"","title":"Thread Id"}},{"name":"user_id","in":"query","required":false,"schema":{"type":"string","default":"dev-user","title":"User Id"}},{"name":"node_id","in":"query","required":false,"schema":{"type":"string","default":"","title":"Node Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/graph/chat/init":{"post":{"tags":["graph"],"summary":"Chat Init Endpoint","description":"聊天初始化接口 - 后端决定返回历史记录或冷启动欢迎消息\n\n这是前端应该调用的唯一初始化接口：\n1. 后端检查是否有历史记录\n2. 如果有：返回历史消息列表\n3. 如果没有：返回冷启动欢迎消息 + UI 按钮\n\n前端只需要：调用此接口 → 显示返回的消息","operationId":"chat_init_endpoint_api_graph_chat_init_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatInitRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatInitResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/graph/health":{"get":{"tags":["graph"],"summary":"Graph Health Check","description":"Health check for graph system","operationId":"graph_health_check_api_graph_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/graph/messages/{thread_id}":{"get":{"tags":["graph"],"summary":"Get Chat Messages","description":"获取聊天历史消息\n\n从 checkpointer 中获取指定 thread 的所有消息历史","operationId":"get_chat_messages_api_graph_messages__thread_id__get","parameters":[{"name":"thread_id","in":"path","required":true,"schema":{"type":"string","title":"Thread Id"}},{"name":"user_id","in":"query","required":true,"schema":{"type":"string","description":"用户ID","title":"User Id"},"description":"用户ID"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects":{"post":{"tags":["Projects"],"summary":"Create Project","description":"创建项目","operationId":"create_project_api_projects_post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ProjectResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["Projects"],"summary":"List Projects","description":"获取项目列表","operationId":"list_projects_api_projects_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"page","in":"query","required":false,"schema":{"type":"integer","default":1,"title":"Page"}},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","default":20,"title":"Page Size"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedResponse_ProjectResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}":{"get":{"tags":["Projects"],"summary":"Get Project","description":"获取项目详情","operationId":"get_project_api_projects__project_id__get","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ProjectResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Projects"],"summary":"Update Project","description":"更新项目","operationId":"update_project_api_projects__project_id__patch","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ProjectResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Projects"],"summary":"Delete Project","description":"删除项目","operationId":"delete_project_api_projects__project_id__delete","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/temp":{"post":{"tags":["Projects"],"summary":"Create Temp Project","description":"创建临时项目","operationId":"create_temp_project_api_projects_temp_post","responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ProjectResponse_"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/projects/{project_id}/save":{"post":{"tags":["Projects"],"summary":"Save Temp Project","description":"将临时项目转为正式项目","operationId":"save_temp_project_api_projects__project_id__save_post","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ProjectResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/models/providers":{"get":{"tags":["Models"],"summary":"List Providers","description":"获取服务商列表","operationId":"list_providers_api_models_providers_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_dict__"}}}}},"security":[{"HTTPBearer":[]}]},"post":{"tags":["Models"],"summary":"Create Provider","description":"添加 LLM 服务商","operationId":"create_provider_api_models_providers_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelProviderCreate"}}},"required":true},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_dict_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/api/models/providers/{provider_id}":{"patch":{"tags":["Models"],"summary":"Update Provider","description":"更新 LLM 服务商","operationId":"update_provider_api_models_providers__provider_id__patch","parameters":[{"name":"provider_id","in":"path","required":true,"schema":{"type":"string","title":"Provider Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelProviderUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_dict_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Models"],"summary":"Delete Provider","description":"删除 LLM 服务商","operationId":"delete_provider_api_models_providers__provider_id__delete","parameters":[{"name":"provider_id","in":"path","required":true,"schema":{"type":"string","title":"Provider Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_NoneType_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/models/providers/test":{"post":{"tags":["Models"],"summary":"Test Provider","description":"测试服务商连接","operationId":"test_provider_api_models_providers_test_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelTestRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelTestResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/models/providers/{provider_id}/refresh":{"post":{"tags":["Models"],"summary":"Refresh Provider Models","description":"从服务商 API 自动刷新模型列表","operationId":"refresh_provider_models_api_models_providers__provider_id__refresh_post","parameters":[{"name":"provider_id","in":"path","required":true,"schema":{"type":"string","title":"Provider Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_str__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/models/mappings":{"get":{"tags":["Models"],"summary":"List Mappings","description":"获取任务-模型映射列表","operationId":"list_mappings_api_models_mappings_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_dict__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Models"],"summary":"Create Mapping","description":"创建任务-模型映射","operationId":"create_mapping_api_models_mappings_post","security":[{"HTTPBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelMappingCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_dict_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/models/mappings/{mapping_id}":{"patch":{"tags":["Models"],"summary":"Update Mapping","description":"更新任务-模型映射","operationId":"update_mapping_api_models_mappings__mapping_id__patch","security":[{"HTTPBearer":[]}],"parameters":[{"name":"mapping_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Mapping Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelMappingUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_dict_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Models"],"summary":"Delete Mapping","description":"删除任务-模型映射","operationId":"delete_mapping_api_models_mappings__mapping_id__delete","security":[{"HTTPBearer":[]}],"parameters":[{"name":"mapping_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Mapping Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/models/task-types":{"get":{"tags":["Models"],"summary":"List Task Types","description":"获取所有任务类型","operationId":"list_task_types_api_models_task_types_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_dict__"}}}}}}},"/api/models/category-task-type-mapping":{"get":{"tags":["Models"],"summary":"Get Category Task Type Mapping","description":"获取 TaskCategory 到 TaskType 的映射关系","operationId":"get_category_task_type_mapping_api_models_category_task_type_mapping_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_dict_str__str__"}}}}}}},"/api/projects/{project_id}/episodes":{"get":{"tags":["Episodes"],"summary":"List Episodes","description":"获取项目的所有剧集","operationId":"list_episodes_api_projects__project_id__episodes_get","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_EpisodeListResponse__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Episodes"],"summary":"Create Episode","description":"创建剧集","operationId":"create_episode_api_projects__project_id__episodes_post","security":[{"HTTPBearer":[]}],"parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EpisodeCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_EpisodeResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}/episodes/{episode_id}":{"get":{"tags":["Episodes"],"summary":"Get Episode","description":"获取单个剧集详情","operationId":"get_episode_api_projects__project_id__episodes__episode_id__get","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}},{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_EpisodeResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Episodes"],"summary":"Update Episode","description":"更新剧集","operationId":"update_episode_api_projects__project_id__episodes__episode_id__patch","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}},{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/EpisodeUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_EpisodeResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Episodes"],"summary":"Delete Episode","description":"删除剧集","operationId":"delete_episode_api_projects__project_id__episodes__episode_id__delete","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}},{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/scenes":{"get":{"tags":["Scenes"],"summary":"List Scenes","description":"获取剧集的所有场景","operationId":"list_scenes_api_episodes__episode_id__scenes_get","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_SceneResponse__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Scenes"],"summary":"Create Scene","description":"创建场景","operationId":"create_scene_api_episodes__episode_id__scenes_post","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SceneCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_SceneResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/scenes/{scene_id}":{"get":{"tags":["Scenes"],"summary":"Get Scene","description":"获取单个场景详情","operationId":"get_scene_api_episodes__episode_id__scenes__scene_id__get","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"scene_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Scene Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_SceneResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Scenes"],"summary":"Update Scene","description":"更新场景","operationId":"update_scene_api_episodes__episode_id__scenes__scene_id__patch","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"scene_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Scene Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SceneUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_SceneResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Scenes"],"summary":"Delete Scene","description":"删除场景","operationId":"delete_scene_api_episodes__episode_id__scenes__scene_id__delete","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"scene_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Scene Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/shots":{"get":{"tags":["Shots"],"summary":"List Shots","description":"获取剧集的所有分镜节点","operationId":"list_shots_api_episodes__episode_id__shots_get","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"scene_id","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Scene Id"}},{"name":"node_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string","pattern":"^(shot|scene_master)$"},{"type":"null"}],"title":"Node Type"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_ShotResponse__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Shots"],"summary":"Create Shot","description":"创建分镜节点","operationId":"create_shot_api_episodes__episode_id__shots_post","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ShotCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ShotResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/shots/{shot_id}":{"get":{"tags":["Shots"],"summary":"Get Shot","description":"获取单个分镜详情","operationId":"get_shot_api_episodes__episode_id__shots__shot_id__get","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"shot_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Shot Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ShotResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Shots"],"summary":"Update Shot","description":"更新分镜节点","operationId":"update_shot_api_episodes__episode_id__shots__shot_id__patch","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"shot_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Shot Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ShotUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_ShotResponse_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Shots"],"summary":"Delete Shot","description":"删除分镜节点","operationId":"delete_shot_api_episodes__episode_id__shots__shot_id__delete","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"shot_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Shot Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/shots/batch":{"post":{"tags":["Shots"],"summary":"Batch Create Shots","description":"批量创建分镜节点","operationId":"batch_create_shots_api_episodes__episode_id__shots_batch_post","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ShotBatchCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_ShotResponse__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/shots/batch/position":{"put":{"tags":["Shots"],"summary":"Batch Update Shot Positions","description":"批量更新分镜位置","operationId":"batch_update_shot_positions_api_episodes__episode_id__shots_batch_position_put","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ShotBatchUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_dict_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/canvas":{"get":{"tags":["Canvas"],"summary":"Get Canvas","description":"获取剧集画布状态","operationId":"get_canvas_api_episodes__episode_id__canvas_get","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_CanvasData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["Canvas"],"summary":"Save Canvas","description":"保存剧集画布状态","operationId":"save_canvas_api_episodes__episode_id__canvas_put","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CanvasSaveRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_CanvasData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/canvas/viewport":{"patch":{"tags":["Canvas"],"summary":"Update Viewport","description":"仅更新画布视口状态","operationId":"update_viewport_api_episodes__episode_id__canvas_viewport_patch","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CanvasViewport"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_CanvasData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/connections":{"get":{"tags":["Connections"],"summary":"List Connections","description":"获取剧集的所有连线","operationId":"list_connections_api_episodes__episode_id__connections_get","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_list_Connection__"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Connections"],"summary":"Create Connection","description":"创建连线","operationId":"create_connection_api_episodes__episode_id__connections_post","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConnectionCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_Connection_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/episodes/{episode_id}/connections/{connection_id}":{"delete":{"tags":["Connections"],"summary":"Delete Connection","description":"删除连线","operationId":"delete_connection_api_episodes__episode_id__connections__connection_id__delete","parameters":[{"name":"episode_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Episode Id"}},{"name":"connection_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Connection Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/{project_id}/assets":{"get":{"tags":["Assets"],"summary":"List Assets","description":"获取项目的资产列表","operationId":"list_assets_api_projects__project_id__assets_get","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}},{"name":"asset_type","in":"query","required":false,"schema":{"anyOf":[{"enum":["character","location","prop"],"type":"string"},{"type":"null"}],"description":"资产类型过滤","title":"Asset Type"},"description":"资产类型过滤"},{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"页码","default":1,"title":"Page"},"description":"页码"},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"每页数量","default":20,"title":"Page Size"},"description":"每页数量"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedResponse_AssetResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["Assets"],"summary":"Create Asset","description":"创建资产","operationId":"create_asset_api_projects__project_id__assets_post","parameters":[{"name":"project_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Project Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AssetCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_AssetResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/projects/assets/{asset_id}":{"get":{"tags":["Assets"],"summary":"Get Asset","description":"获取单个资产详情","operationId":"get_asset_api_projects_assets__asset_id__get","parameters":[{"name":"asset_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Asset Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_AssetResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["Assets"],"summary":"Update Asset","description":"更新资产","operationId":"update_asset_api_projects_assets__asset_id__patch","parameters":[{"name":"asset_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Asset Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AssetUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SuccessResponse_AssetResponseData_"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["Assets"],"summary":"Delete Asset","description":"删除资产","operationId":"delete_asset_api_projects_assets__asset_id__delete","parameters":[{"name":"asset_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Asset Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"summary":"Health Check","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}}},"components":{"schemas":{"ActionButton":{"properties":{"label":{"type":"string","title":"Label"},"action":{"type":"string","title":"Action"},"payload":{"additionalProperties":true,"type":"object","title":"Payload"},"style":{"type":"string","title":"Style","default":"primary"},"icon":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Icon"},"disabled":{"type":"boolean","title":"Disabled","default":false},"disabled_reason":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Disabled Reason"}},"type":"object","required":["label","action"],"title":"ActionButton","description":"操作按钮"},"AssetCreate":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name","description":"资产名称"},"asset_type":{"type":"string","enum":["character","location","prop"],"title":"Asset Type","description":"资产类型"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"资产描述"},"image_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Image Url","description":"参考图 URL"},"visual_tokens":{"additionalProperties":true,"type":"object","title":"Visual Tokens","description":"视觉 Token"},"prompts":{"additionalProperties":true,"type":"object","title":"Prompts","description":"生成 Prompt"}},"type":"object","required":["name","asset_type"],"title":"AssetCreate","description":"创建资产请求"},"AssetResponseData":{"properties":{"asset_id":{"type":"string","title":"Asset Id","description":"资产 ID"},"project_id":{"type":"string","title":"Project Id","description":"所属项目 ID"},"name":{"type":"string","title":"Name","description":"资产名称"},"asset_type":{"type":"string","title":"Asset Type","description":"资产类型 (character/location/prop)"},"visual_tokens":{"additionalProperties":true,"type":"object","title":"Visual Tokens","description":"视觉 Token"},"reference_urls":{"items":{"type":"string"},"type":"array","title":"Reference Urls","description":"参考图 URL"},"prompts":{"additionalProperties":{"type":"string"},"type":"object","title":"Prompts","description":"生成 Prompt"},"created_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Created At","description":"创建时间"},"updated_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Updated At","description":"更新时间"}},"type":"object","required":["asset_id","project_id","name","asset_type"],"title":"AssetResponseData","description":"资产响应数据","example":{"asset_id":"550e8400-e29b-41d4-a716-446655440006","asset_type":"character","created_at":"2026-02-02T04:00:00Z","name":"主角 - 陈默","project_id":"550e8400-e29b-41d4-a716-446655440000","prompts":{"nano_banana_prompt":"A young man...","sd_prompt":"portrait of a man..."},"reference_urls":["https://example.com/ref1.jpg"],"visual_tokens":{"age":"28","gender":"male","style":"modern"}}},"AssetUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":100,"minLength":1},{"type":"null"}],"title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"image_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Image Url"},"visual_tokens":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Visual Tokens"},"prompts":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Prompts"}},"type":"object","title":"AssetUpdate","description":"更新资产请求"},"CanvasData":{"properties":{"episode_id":{"type":"string","title":"Episode Id","description":"剧集 ID"},"viewport":{"$ref":"#/components/schemas/CanvasViewport"},"nodes":{"items":{"$ref":"#/components/schemas/ShotResponse"},"type":"array","title":"Nodes","description":"所有节点"},"connections":{"items":{"$ref":"#/components/schemas/Connection"},"type":"array","title":"Connections","description":"所有连线"}},"type":"object","required":["episode_id"],"title":"CanvasData","description":"画布完整数据 - v6.0"},"CanvasSaveRequest":{"properties":{"viewport":{"$ref":"#/components/schemas/CanvasViewport"},"nodes":{"items":{"$ref":"#/components/schemas/ShotResponse"},"type":"array","title":"Nodes"},"connections":{"items":{"$ref":"#/components/schemas/Connection"},"type":"array","title":"Connections"}},"type":"object","required":["viewport","nodes","connections"],"title":"CanvasSaveRequest","description":"保存画布请求"},"CanvasViewport":{"properties":{"x":{"type":"number","title":"X","description":"视口 X 偏移","default":0},"y":{"type":"number","title":"Y","description":"视口 Y 偏移","default":0},"zoom":{"type":"number","maximum":5.0,"minimum":0.1,"title":"Zoom","description":"缩放级别 10%-500%","default":1}},"type":"object","title":"CanvasViewport","description":"画布视口状态"},"ChatInitRequest":{"properties":{"user_id":{"type":"string","title":"User Id"},"project_id":{"type":"string","title":"Project Id"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id"}},"type":"object","required":["user_id","project_id"],"title":"ChatInitRequest","description":"聊天初始化请求 - 后端决定返回历史还是冷启动"},"ChatInitResponse":{"properties":{"thread_id":{"type":"string","title":"Thread Id"},"messages":{"items":{"$ref":"#/components/schemas/ChatMessage"},"type":"array","title":"Messages"},"is_cold_start":{"type":"boolean","title":"Is Cold Start"},"ui_interaction":{"anyOf":[{"$ref":"#/components/schemas/UIInteractionBlock"},{"type":"null"}]}},"type":"object","required":["thread_id","messages","is_cold_start"],"title":"ChatInitResponse","description":"聊天初始化响应 - 统一格式"},"ChatMessage":{"properties":{"id":{"type":"string","title":"Id"},"role":{"type":"string","title":"Role"},"content":{"type":"string","title":"Content"},"display_label":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Display Label"},"timestamp":{"type":"string","title":"Timestamp"},"ui_interaction":{"anyOf":[{"$ref":"#/components/schemas/UIInteractionBlock"},{"type":"null"}]}},"type":"object","required":["id","role","content","timestamp"],"title":"ChatMessage","description":"统一的消息格式"},"ChatRequest":{"properties":{"user_id":{"type":"string","title":"User Id"},"project_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Project Id"},"session_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Session Id"},"message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Message"},"action":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Action"},"context":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Context"}},"type":"object","required":["user_id"],"title":"ChatRequest","description":"Chat request payload"},"ChatResponse":{"properties":{"routed_agent":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Routed Agent"},"workflow_plan":{"anyOf":[{"items":{"additionalProperties":true,"type":"object"},"type":"array"},{"type":"null"}],"title":"Workflow Plan"},"ui_feedback":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Ui Feedback"},"intent_analysis":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Intent Analysis"},"messages":{"anyOf":[{"items":{"additionalProperties":true,"type":"object"},"type":"array"},{"type":"null"}],"title":"Messages"},"ui_interaction":{"anyOf":[{"$ref":"#/components/schemas/UIInteractionBlock"},{"type":"null"}]},"is_cold_start":{"type":"boolean","title":"Is Cold Start","default":false},"content_status":{"anyOf":[{"$ref":"#/components/schemas/ContentStatus"},{"type":"null"}]}},"type":"object","title":"ChatResponse","description":"Chat response"},"Connection":{"properties":{"id":{"type":"string","title":"Id","description":"连线 ID"},"source":{"type":"string","title":"Source","description":"源节点 ID"},"target":{"type":"string","title":"Target","description":"目标节点 ID"},"type":{"type":"string","title":"Type","description":"sequence | reference","default":"sequence"}},"type":"object","required":["id","source","target"],"title":"Connection","description":"节点连线 - v6.0"},"ConnectionCreate":{"properties":{"source_shot_id":{"type":"string","format":"uuid","title":"Source Shot Id","description":"源分镜 ID"},"target_shot_id":{"type":"string","format":"uuid","title":"Target Shot Id","description":"目标分镜 ID"},"connection_type":{"type":"string","enum":["sequence","reference"],"title":"Connection Type","description":"连线类型","default":"sequence"}},"type":"object","required":["source_shot_id","target_shot_id"],"title":"ConnectionCreate","description":"创建连线请求"},"ContentStatus":{"properties":{"has_novel_content":{"type":"boolean","title":"Has Novel Content","default":false},"has_script":{"type":"boolean","title":"Has Script","default":false},"has_storyboard":{"type":"boolean","title":"Has Storyboard","default":false},"has_any_content":{"type":"boolean","title":"Has Any Content","default":false}},"type":"object","title":"ContentStatus","description":"内容状态"},"EpisodeCreate":{"properties":{"title":{"type":"string","maxLength":100,"minLength":1,"title":"Title","description":"剧集标题"},"summary":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Summary","description":"剧情摘要"}},"type":"object","required":["title"],"title":"EpisodeCreate","description":"创建剧集请求"},"EpisodeListResponse":{"properties":{"episodeId":{"type":"string","format":"uuid","title":"Episodeid"},"episodeNumber":{"type":"integer","title":"Episodenumber"},"title":{"type":"string","title":"Title"},"summary":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Summary"},"status":{"type":"string","title":"Status"},"shotCount":{"type":"integer","title":"Shotcount","default":0},"createdAt":{"type":"string","format":"date-time","title":"Createdat"}},"type":"object","required":["episodeId","episodeNumber","title","summary","status","createdAt"],"title":"EpisodeListResponse","description":"剧集列表响应（精简）"},"EpisodeResponse":{"properties":{"title":{"type":"string","maxLength":100,"minLength":1,"title":"Title","description":"剧集标题"},"summary":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Summary","description":"剧情摘要"},"episodeId":{"type":"string","format":"uuid","title":"Episodeid"},"projectId":{"type":"string","format":"uuid","title":"Projectid"},"episodeNumber":{"type":"integer","title":"Episodenumber"},"scriptText":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Scripttext"},"scriptScenes":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Scriptscenes"},"novelContent":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Novelcontent"},"wordCount":{"type":"integer","title":"Wordcount"},"status":{"type":"string","title":"Status"},"canvasData":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Canvasdata"},"shotCount":{"type":"integer","title":"Shotcount"},"createdAt":{"type":"string","format":"date-time","title":"Createdat"},"updatedAt":{"type":"string","format":"date-time","title":"Updatedat"}},"type":"object","required":["title","episodeId","projectId","episodeNumber","scriptText","scriptScenes","novelContent","wordCount","status","shotCount","createdAt","updatedAt"],"title":"EpisodeResponse","description":"剧集详情响应（完整）"},"EpisodeUpdate":{"properties":{"title":{"anyOf":[{"type":"string","maxLength":100,"minLength":1},{"type":"null"}],"title":"Title"},"summary":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Summary","description":"剧情摘要"},"scriptText":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Scripttext","description":"剧本内容"},"novelContent":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Novelcontent","description":"小说内容"}},"type":"object","title":"EpisodeUpdate","description":"更新剧集请求"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"ModelMappingCreate":{"properties":{"task_type":{"$ref":"#/components/schemas/TaskType","description":"任务类型"},"provider_id":{"type":"string","format":"uuid","title":"Provider Id","description":"服务商 ID"},"model_name":{"type":"string","title":"Model Name","description":"模型名称"},"parameters":{"additionalProperties":true,"type":"object","title":"Parameters","description":"模型参数"},"project_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Project Id","description":"项目 ID (空则为全局默认)"}},"type":"object","required":["task_type","provider_id","model_name"],"title":"ModelMappingCreate","description":"创建映射请求"},"ModelMappingUpdate":{"properties":{"provider_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Provider Id"},"model_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Model Name"},"parameters":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Parameters"}},"type":"object","title":"ModelMappingUpdate","description":"更新映射请求"},"ModelProviderCreate":{"properties":{"name":{"type":"string","maxLength":50,"minLength":1,"title":"Name","description":"服务商名称"},"provider_type":{"$ref":"#/components/schemas/ProviderType","description":"服务商类型 (LLM/视频)","default":"llm"},"protocol":{"$ref":"#/components/schemas/ProtocolType","description":"API 协议","default":"openai"},"base_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Base Url","description":"API Base URL"},"is_active":{"type":"boolean","title":"Is Active","description":"是否启用","default":true},"api_key":{"type":"string","minLength":1,"title":"Api Key","description":"API Key"}},"type":"object","required":["name","api_key"],"title":"ModelProviderCreate","description":"创建服务商请求"},"ModelProviderUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":50,"minLength":1},{"type":"null"}],"title":"Name"},"protocol":{"anyOf":[{"$ref":"#/components/schemas/ProtocolType"},{"type":"null"}]},"base_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Base Url"},"api_key":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Api Key"},"is_active":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Is Active"}},"type":"object","title":"ModelProviderUpdate","description":"更新服务商请求"},"ModelTestRequest":{"properties":{"provider_id":{"type":"string","format":"uuid","title":"Provider Id","description":"服务商 ID"},"model_name":{"type":"string","title":"Model Name","description":"要测试的模型名称"},"prompt":{"type":"string","title":"Prompt","description":"测试 Prompt","default":"Hello, can you respond?"}},"type":"object","required":["provider_id","model_name"],"title":"ModelTestRequest","description":"模型测试请求"},"ModelTestResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"response":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Response"},"latency_ms":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Latency Ms"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["success"],"title":"ModelTestResponse","description":"模型测试响应"},"PaginatedResponse_AssetResponseData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/AssetResponseData"},"type":"array","title":"Data","description":"数据列表"},"total":{"type":"integer","title":"Total","description":"总记录数"},"page":{"type":"integer","title":"Page","description":"当前页码 (从 1 开始)"},"page_size":{"type":"integer","title":"Page Size","description":"每页大小"},"total_pages":{"type":"integer","title":"Total Pages","description":"总页数"},"has_next":{"type":"boolean","title":"Has Next","description":"是否有下一页"},"has_prev":{"type":"boolean","title":"Has Prev","description":"是否有上一页"}},"type":"object","required":["data","total","page","page_size","total_pages","has_next","has_prev"],"title":"PaginatedResponse[AssetResponseData]"},"PaginatedResponse_ProjectResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/ProjectResponse"},"type":"array","title":"Data","description":"数据列表"},"total":{"type":"integer","title":"Total","description":"总记录数"},"page":{"type":"integer","title":"Page","description":"当前页码 (从 1 开始)"},"page_size":{"type":"integer","title":"Page Size","description":"每页大小"},"total_pages":{"type":"integer","title":"Total Pages","description":"总页数"},"has_next":{"type":"boolean","title":"Has Next","description":"是否有下一页"},"has_prev":{"type":"boolean","title":"Has Prev","description":"是否有上一页"}},"type":"object","required":["data","total","page","page_size","total_pages","has_next","has_prev"],"title":"PaginatedResponse[ProjectResponse]"},"ProjectCreate":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name","description":"项目名称"},"coverImage":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Coverimage","description":"封面图 URL"},"meta":{"anyOf":[{"$ref":"#/components/schemas/ProjectMeta"},{"type":"null"}],"description":"项目元数据"}},"type":"object","required":["name"],"title":"ProjectCreate","description":"创建项目请求"},"ProjectMeta":{"properties":{"genre":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Genre","description":"题材赛道"},"subTags":{"items":{"type":"string"},"type":"array","title":"Subtags","description":"细分标签"},"tone":{"items":{"type":"string"},"type":"array","title":"Tone","description":"内容调性"},"targetWordCount":{"type":"integer","title":"Targetwordcount","description":"单集字数","default":500},"totalEpisodes":{"type":"integer","title":"Totalepisodes","description":"目标集数","default":80},"endingType":{"type":"string","title":"Endingtype","description":"结局类型","default":"HE"},"aspectRatio":{"type":"string","title":"Aspectratio","description":"画幅比例","default":"9:16"},"drawingType":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Drawingtype","description":"绘图类型"},"visualStyle":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Visualstyle","description":"画面风格"},"styleDna":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Styledna","description":"文风 DNA"},"avoidTags":{"items":{"type":"string"},"type":"array","title":"Avoidtags","description":"排除标签"}},"type":"object","title":"ProjectMeta","description":"项目元数据 (存储在 JSONB 字段)\n\n对应 Product-Spec.md 中的 UserConfig"},"ProjectResponse":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name","description":"项目名称"},"coverImage":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Coverimage","description":"封面图 URL"},"meta":{"anyOf":[{"$ref":"#/components/schemas/ProjectMeta"},{"type":"null"}],"description":"项目元数据"},"id":{"type":"string","format":"uuid","title":"Id","description":"项目 ID"},"userId":{"type":"string","format":"uuid","title":"Userid","description":"所属用户 ID"},"createdAt":{"type":"string","format":"date-time","title":"Createdat","description":"创建时间"},"updatedAt":{"type":"string","format":"date-time","title":"Updatedat","description":"更新时间"},"isTemporary":{"type":"boolean","title":"Istemporary","description":"是否为临时项目","default":false},"nodeCount":{"type":"integer","title":"Nodecount","description":"节点数量","default":0},"episodeCount":{"type":"integer","title":"Episodecount","description":"已生成集数","default":0}},"type":"object","required":["name","id","userId","createdAt","updatedAt"],"title":"ProjectResponse","description":"项目响应","example":{"cover_image":"https://storage.example.com/covers/project1.jpg","created_at":"2026-02-02T04:00:00Z","episode_count":5,"id":"550e8400-e29b-41d4-a716-446655440000","meta":{"ending_type":"HE","genre":"逆袭复仇","sub_tags":["战神回归","重生改命"],"target_word_count":500,"tone":["爽","虐"],"total_episodes":80},"name":"重生之逆袭人生","node_count":25,"updated_at":"2026-02-02T04:00:00Z","user_id":"550e8400-e29b-41d4-a716-446655440001"}},"ProjectUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":100,"minLength":1},{"type":"null"}],"title":"Name"},"cover_image":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cover Image"},"meta":{"anyOf":[{"$ref":"#/components/schemas/ProjectMeta"},{"type":"null"}]}},"type":"object","title":"ProjectUpdate","description":"更新项目请求 (所有字段可选)"},"ProtocolType":{"type":"string","enum":["openai","anthropic","gemini","azure"],"title":"ProtocolType"},"ProviderType":{"type":"string","enum":["llm","video","image"],"title":"ProviderType"},"SceneCreate":{"properties":{"location":{"type":"string","maxLength":200,"minLength":1,"title":"Location","description":"场景地点"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"场景描述"},"createMasterNode":{"type":"boolean","title":"Createmasternode","description":"是否同时创建 Scene Master 节点","default":false},"masterPositionX":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Masterpositionx","description":"Master 节点 X 坐标"},"masterPositionY":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Masterpositiony","description":"Master 节点 Y 坐标"}},"type":"object","required":["location"],"title":"SceneCreate","description":"创建场景请求"},"SceneResponse":{"properties":{"location":{"type":"string","maxLength":200,"minLength":1,"title":"Location","description":"场景地点"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"场景描述"},"sceneId":{"type":"string","format":"uuid","title":"Sceneid"},"episodeId":{"type":"string","format":"uuid","title":"Episodeid"},"sceneNumber":{"type":"string","title":"Scenenumber"},"masterNodeId":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Masternodeid"},"shotCount":{"type":"integer","title":"Shotcount"},"createdAt":{"type":"string","format":"date-time","title":"Createdat"},"updatedAt":{"type":"string","format":"date-time","title":"Updatedat"}},"type":"object","required":["location","sceneId","episodeId","sceneNumber","masterNodeId","shotCount","createdAt","updatedAt"],"title":"SceneResponse","description":"场景响应"},"SceneUpdate":{"properties":{"location":{"anyOf":[{"type":"string","maxLength":200,"minLength":1},{"type":"null"}],"title":"Location"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"场景描述"}},"type":"object","title":"SceneUpdate","description":"更新场景请求"},"ShotBatchCreate":{"properties":{"shots":{"items":{"$ref":"#/components/schemas/ShotCreate"},"type":"array","title":"Shots"}},"type":"object","required":["shots"],"title":"ShotBatchCreate","description":"批量创建分镜请求"},"ShotBatchUpdate":{"properties":{"positions":{"items":{"$ref":"#/components/schemas/ShotPositionUpdate"},"type":"array","title":"Positions"}},"type":"object","required":["positions"],"title":"ShotBatchUpdate","description":"批量更新位置请求"},"ShotCreate":{"properties":{"title":{"type":"string","maxLength":50,"minLength":1,"title":"Title","description":"景别"},"subtitle":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Subtitle","description":"运镜方式"},"sceneId":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Sceneid"},"nodeType":{"type":"string","pattern":"^(shot|scene_master)$","title":"Nodetype"},"positionX":{"type":"number","title":"Positionx","description":"X 坐标","default":0},"positionY":{"type":"number","title":"Positiony","description":"Y 坐标","default":0},"details":{"anyOf":[{"$ref":"#/components/schemas/ShotDetails"},{"type":"null"}]}},"type":"object","required":["title","nodeType"],"title":"ShotCreate","description":"创建分镜请求"},"ShotDetails":{"properties":{"dialogue":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Dialogue","description":"对白"},"sound":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sound","description":"音效"},"cameraMove":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Cameramove","description":"运镜方式"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"画面描述"},"prompt":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Prompt","description":"AI 生图提示词"},"negativePrompt":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Negativeprompt","description":"负面提示词"},"resolution":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Resolution","description":"2K | 4K"},"aspectRatio":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Aspectratio","description":"16:9 | 9:16 | 1:1 | 4:3"},"style":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Style","description":"画面风格"},"referenceImages":{"anyOf":[{"additionalProperties":{"anyOf":[{"type":"string"},{"type":"null"}]},"type":"object"},{"type":"null"}],"title":"Referenceimages","description":"{ sketch, material, threeD }"},"generationParams":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Generationparams","description":"{ seed, steps, cfg }"}},"type":"object","title":"ShotDetails","description":"ShotNode 详细内容 - v6.0 嵌套在 details 中"},"ShotPositionUpdate":{"properties":{"shotId":{"type":"string","format":"uuid","title":"Shotid"},"x":{"type":"number","title":"X"},"y":{"type":"number","title":"Y"}},"type":"object","required":["shotId","x","y"],"title":"ShotPositionUpdate","description":"位置更新项"},"ShotResponse":{"properties":{"title":{"type":"string","maxLength":50,"minLength":1,"title":"Title","description":"景别"},"subtitle":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Subtitle","description":"运镜方式"},"shotId":{"type":"string","format":"uuid","title":"Shotid"},"episodeId":{"type":"string","format":"uuid","title":"Episodeid"},"sceneId":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Sceneid"},"nodeType":{"type":"string","title":"Nodetype"},"shotNumber":{"type":"integer","title":"Shotnumber"},"thumbnailUrl":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Thumbnailurl"},"imageUrl":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Imageurl"},"status":{"type":"string","title":"Status"},"positionX":{"type":"number","title":"Positionx"},"positionY":{"type":"number","title":"Positiony"},"details":{"anyOf":[{"$ref":"#/components/schemas/ShotDetails"},{"type":"null"}]},"createdAt":{"type":"string","format":"date-time","title":"Createdat"},"updatedAt":{"type":"string","format":"date-time","title":"Updatedat"}},"type":"object","required":["title","shotId","episodeId","sceneId","nodeType","shotNumber","thumbnailUrl","imageUrl","status","positionX","positionY","details","createdAt","updatedAt"],"title":"ShotResponse","description":"分镜响应 - 完整 ShotNode"},"ShotUpdate":{"properties":{"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title"},"subtitle":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subtitle"},"status":{"anyOf":[{"type":"string","pattern":"^(pending|processing|completed|approved|revision)$"},{"type":"null"}],"title":"Status"},"positionX":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Positionx"},"positionY":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Positiony"},"thumbnailUrl":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Thumbnailurl"},"imageUrl":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Imageurl"},"details":{"anyOf":[{"$ref":"#/components/schemas/ShotDetails"},{"type":"null"}]}},"type":"object","title":"ShotUpdate","description":"更新分镜请求"},"SuccessResponse_AssetResponseData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/AssetResponseData"}},"type":"object","required":["data"],"title":"SuccessResponse[AssetResponseData]"},"SuccessResponse_CanvasData_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/CanvasData"}},"type":"object","required":["data"],"title":"SuccessResponse[CanvasData]"},"SuccessResponse_Connection_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/Connection"}},"type":"object","required":["data"],"title":"SuccessResponse[Connection]"},"SuccessResponse_EpisodeResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/EpisodeResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[EpisodeResponse]"},"SuccessResponse_NoneType_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"type":"null","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[NoneType]"},"SuccessResponse_ProjectResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/ProjectResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[ProjectResponse]"},"SuccessResponse_SceneResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/SceneResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[SceneResponse]"},"SuccessResponse_ShotResponse_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"$ref":"#/components/schemas/ShotResponse"}},"type":"object","required":["data"],"title":"SuccessResponse[ShotResponse]"},"SuccessResponse_dict_":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"additionalProperties":true,"type":"object","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[dict]"},"SuccessResponse_dict_str__str__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"additionalProperties":{"type":"string"},"type":"object","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[dict[str, str]]"},"SuccessResponse_list_Connection__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/Connection"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[Connection]]"},"SuccessResponse_list_EpisodeListResponse__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/EpisodeListResponse"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[EpisodeListResponse]]"},"SuccessResponse_list_SceneResponse__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/SceneResponse"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[SceneResponse]]"},"SuccessResponse_list_ShotResponse__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"$ref":"#/components/schemas/ShotResponse"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[ShotResponse]]"},"SuccessResponse_list_dict__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[dict]]"},"SuccessResponse_list_str__":{"properties":{"success":{"type":"boolean","title":"Success","default":true},"data":{"items":{"type":"string"},"type":"array","title":"Data"}},"type":"object","required":["data"],"title":"SuccessResponse[list[str]]"},"TaskType":{"type":"string","enum":["router","market_analyst","story_planner","skeleton_builder","novel_writer","editor","refiner","analysis_lab","script_adapter","script_parser","script_formatter","storyboard_director","storyboard_artist","prompt_generator","asset_inspector","image_enhancer","image_inpainter","image_outpainter","embedding","summary"],"title":"TaskType","description":"Agent 任务类型\n\n用于 Task-Model Routing，将不同任务路由到最适合的模型。"},"UIInteractionBlock":{"properties":{"block_type":{"type":"string","title":"Block Type","default":"action_group"},"title":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Title"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"buttons":{"items":{"$ref":"#/components/schemas/ActionButton"},"type":"array","title":"Buttons"},"data":{"additionalProperties":true,"type":"object","title":"Data"},"dismissible":{"type":"boolean","title":"Dismissible","default":true}},"type":"object","title":"UIInteractionBlock","description":"UI 交互块"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}