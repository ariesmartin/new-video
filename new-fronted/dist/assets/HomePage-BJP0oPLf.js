import{u as N,a as k,j as e,S as q,b as Z,M as V,B as X,W as J,U as K,r as d,c as $,P as E,d as Y,e as ee,f as D,g as A,h as v,Z as te,i as C,L as T,k as se,F as oe,E as ae,l as ce,C as re,T as ne,m as ie,n as me,I as de,p as le,o as pe}from"./index-yu4waMHZ.js";import{L as xe,u as he,a as ue,D as je,b as ge,c as fe,d as ye,e as we}from"./scenes-4ITdBoBR.js";import{u as be,p as L}from"./projectAutoCreate-DOzCcy5D.js";function Pe({variant:s="home",onBack:i}){const{theme:a,setTheme:p,user:r}=N(),{openBackstageModal:l}=k(),n=()=>{p(a==="dark"?"light":"dark")};return e.jsxs("header",{"code-path":"src/components/layout/Header.tsx:19:5",className:`flex items-center justify-between px-3 sm:px-6 py-2 sm:py-4 ${s==="home"?"":"bg-surface border-b border-border"}`,children:[e.jsxs("div",{"code-path":"src/components/layout/Header.tsx:24:7",className:"flex items-center gap-2",children:[s==="project"&&i&&e.jsx("button",{"code-path":"src/components/layout/Header.tsx:26:11",onClick:i,className:"mr-2 sm:mr-4 p-1.5 sm:p-2 rounded-lg hover:bg-white/5 transition-colors text-text-secondary",children:e.jsx("span",{"code-path":"src/components/layout/Header.tsx:30:13",children:"←"})}),e.jsx(xe,{"code-path":"src/components/layout/Header.tsx:33:9",size:s==="home"?"lg":"md",showText:!0})]}),e.jsxs("div",{"code-path":"src/components/layout/Header.tsx:36:7",className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("button",{"code-path":"src/components/layout/Header.tsx:37:9",onClick:()=>l("settings"),className:"p-1.5 sm:p-2 rounded-lg hover:bg-white/5 transition-colors text-text-secondary hidden sm:block",title:"系统设置",children:e.jsx(q,{"code-path":"src/components/layout/Header.tsx:42:11",size:18,className:"sm:w-5 sm:h-5"})}),e.jsx("button",{"code-path":"src/components/layout/Header.tsx:45:9",onClick:n,className:"p-1.5 sm:p-2 rounded-lg hover:bg-white/5 transition-colors text-text-secondary",children:a==="dark"?e.jsx(Z,{"code-path":"src/components/layout/Header.tsx:49:31",size:18,className:"sm:w-5 sm:h-5"}):e.jsx(V,{"code-path":"src/components/layout/Header.tsx:49:77",size:18,className:"sm:w-5 sm:h-5"})}),e.jsxs("button",{"code-path":"src/components/layout/Header.tsx:52:9",className:"p-1.5 sm:p-2 rounded-lg hover:bg-white/5 transition-colors relative text-text-secondary hidden sm:block",children:[e.jsx(X,{"code-path":"src/components/layout/Header.tsx:55:11",size:18,className:"sm:w-5 sm:h-5"}),e.jsx("span",{"code-path":"src/components/layout/Header.tsx:56:11",className:"absolute top-0.5 right-0.5 sm:top-1 sm:right-1 w-2 h-2 rounded-full bg-status-red"})]}),r&&e.jsxs("div",{"code-path":"src/components/layout/Header.tsx:60:11",className:"hidden sm:flex items-center gap-2 px-3 py-1.5 rounded-lg bg-primary/10",children:[e.jsx(J,{"code-path":"src/components/layout/Header.tsx:61:13",size:16,className:"text-primary"}),e.jsx("span",{"code-path":"src/components/layout/Header.tsx:62:13",className:"text-sm font-medium text-primary",children:r.balance.toLocaleString("zh-CN",{minimumFractionDigits:2})})]}),e.jsxs("div",{"code-path":"src/components/layout/Header.tsx:68:9",className:"flex items-center gap-1.5 sm:gap-2 px-2 sm:px-3 py-1 sm:py-1.5 rounded-lg cursor-pointer hover:bg-white/5 transition-colors bg-surface border border-border",children:[e.jsx("div",{"code-path":"src/components/layout/Header.tsx:69:11",className:"w-6 h-6 sm:w-7 sm:h-7 rounded-full flex items-center justify-center bg-primary",children:e.jsx(K,{"code-path":"src/components/layout/Header.tsx:70:13",size:12,className:"sm:w-3.5 sm:h-3.5 text-primary-foreground"})}),e.jsx("span",{"code-path":"src/components/layout/Header.tsx:72:11",className:"text-xs sm:text-sm text-text-primary hidden sm:inline",children:r?.name||"admin"})]})]})]})}function ve(){const{user:s}=N(),[i,a]=d.useState(""),[p,r]=d.useState(new Date);return d.useEffect(()=>{const l=p.getHours();let n="";l>=5&&l<12?n="早上好":l>=12&&l<18?n="下午好":n="晚上好",a(`${n}, ${s?.name||"admin"}.`)},[p,s]),d.useEffect(()=>{const l=setInterval(()=>{r(new Date)},6e4);return()=>clearInterval(l)},[]),e.jsxs("div",{"code-path":"src/components/home/WelcomeHeader.tsx:33:5",className:"text-center mb-6 sm:mb-8 px-2",children:[e.jsx("h1",{"code-path":"src/components/home/WelcomeHeader.tsx:34:7",className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-1 sm:mb-2 text-text-primary",children:i}),e.jsx("p",{"code-path":"src/components/home/WelcomeHeader.tsx:37:7",className:"text-sm sm:text-base md:text-lg text-text-secondary",children:"灵感稍纵即逝，抓住它。"})]})}var S="Switch",[Ne]=ee(S),[Ce,ke]=Ne(S),R=d.forwardRef((s,i)=>{const{__scopeSwitch:a,name:p,checked:r,defaultChecked:l,required:n,disabled:h,value:m="on",onCheckedChange:u,form:o,...f}=s,[y,x]=d.useState(null),w=$(i,b=>x(b)),P=d.useRef(!1),c=y?o||!!y.closest("form"):!0,[j,g]=he({prop:r,defaultProp:l??!1,onChange:u,caller:S});return e.jsxs(Ce,{scope:a,checked:j,disabled:h,children:[e.jsx(E.button,{type:"button",role:"switch","aria-checked":j,"aria-required":n,"data-state":_(j),"data-disabled":h?"":void 0,disabled:h,value:m,...f,ref:w,onClick:Y(s.onClick,b=>{g(H=>!H),c&&(P.current=b.isPropagationStopped(),P.current||b.stopPropagation())})}),c&&e.jsx(B,{control:y,bubbles:!P.current,name:p,value:m,checked:j,required:n,disabled:h,form:o,style:{transform:"translateX(-100%)"}})]})});R.displayName=S;var F="SwitchThumb",M=d.forwardRef((s,i)=>{const{__scopeSwitch:a,...p}=s,r=ke(F,a);return e.jsx(E.span,{"data-state":_(r.checked),"data-disabled":r.disabled?"":void 0,...p,ref:i})});M.displayName=F;var Se="SwitchBubbleInput",B=d.forwardRef(({__scopeSwitch:s,control:i,checked:a,bubbles:p=!0,...r},l)=>{const n=d.useRef(null),h=$(n,l),m=be(a),u=ue(i);return d.useEffect(()=>{const o=n.current;if(!o)return;const f=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(f,"checked").set;if(m!==a&&x){const w=new Event("click",{bubbles:p});x.call(o,a),o.dispatchEvent(w)}},[m,a,p]),e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:a,...r,tabIndex:-1,ref:h,style:{...r.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});B.displayName=Se;function _(s){return s?"checked":"unchecked"}var He=R,Ie=M;function Le({className:s,...i}){return e.jsx(He,{"code-path":"src/components/ui/switch.tsx:13:5","data-slot":"switch",className:D("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",s),...i,children:e.jsx(Ie,{"code-path":"src/components/ui/switch.tsx:21:7","data-slot":"switch-thumb",className:D("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function Te({onGenerate:s}){const i=A(),[a,p]=d.useState(""),[r,l]=d.useState(!1),[n,h]=d.useState(!1),m=v(x=>x.addProject),u=N(x=>x.setCurrentProject),o=k(x=>x.addToast),f="灵感：悬疑恐怖风格，发生在废弃医院，3集...",y=async()=>{if(!a.trim()){o({type:"warning",message:"请输入创意描述"});return}h(!0);try{const x=a.slice(0,20)+(a.length>20?"...":""),w=await m(x);u(w),o({type:"success",message:"项目创建成功！正在进入项目..."}),p(""),s&&s(a,r),i(`/project/${w.id}`)}catch{o({type:"error",message:"创建项目失败"})}finally{h(!1)}};return e.jsxs("div",{"code-path":"src/components/home/CreativeInput.tsx:53:5",className:"w-full max-w-2xl mx-auto mb-6 sm:mb-8 px-4 sm:px-0",children:[e.jsxs("div",{"code-path":"src/components/home/CreativeInput.tsx:54:7",className:"rounded-xl p-1 transition-all duration-200 bg-surface border border-border",children:[e.jsx("textarea",{"code-path":"src/components/home/CreativeInput.tsx:57:9",value:a,onChange:x=>p(x.target.value),placeholder:f,className:"w-full bg-transparent p-3 sm:p-4 resize-none outline-none text-sm sm:text-base text-text-primary",rows:3,maxLength:500}),e.jsxs("div",{"code-path":"src/components/home/CreativeInput.tsx:66:9",className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0 px-3 sm:px-4 pb-3 sm:pb-4",children:[e.jsxs("div",{"code-path":"src/components/home/CreativeInput.tsx:67:11",className:"flex items-center gap-2",children:[e.jsx(te,{"code-path":"src/components/home/CreativeInput.tsx:68:13",size:14,className:`sm:w-4 sm:h-4 ${r?"text-yellow-500":"text-gray-500"}`}),e.jsx("span",{"code-path":"src/components/home/CreativeInput.tsx:72:13",className:"text-xs sm:text-sm text-text-secondary",children:"极速模式"}),e.jsx(Le,{"code-path":"src/components/home/CreativeInput.tsx:77:13",checked:r,onCheckedChange:l,className:"scale-90 sm:scale-100"}),e.jsx("span",{"code-path":"src/components/home/CreativeInput.tsx:82:13",className:`text-[10px] sm:text-xs ml-1 ${r?"text-[#FFD700]":"text-text-tertiary"}`,children:r?"ON":"OFF"})]}),e.jsx(C,{"code-path":"src/components/home/CreativeInput.tsx:89:11",onClick:y,disabled:n,className:"btn-primary flex items-center gap-2 w-full sm:w-auto text-sm sm:text-base",children:n?e.jsxs(e.Fragment,{children:[e.jsx(T,{"code-path":"src/components/home/CreativeInput.tsx:96:17",size:14,className:"sm:w-4 sm:h-4 animate-spin"}),"生成中..."]}):"开始生成"})]})]}),r&&e.jsx("p",{"code-path":"src/components/home/CreativeInput.tsx:107:9",className:"text-[10px] sm:text-xs mt-2 text-center text-text-tertiary px-4",children:"开启后将自动完成大纲、剧本、角色场景的全流程"})]})}function ze({onTutorial:s,onScriptWorkshop:i}){return e.jsxs("div",{"code-path":"src/components/home/QuickActions.tsx:11:5",className:"flex flex-col sm:flex-row items-center justify-center gap-3 sm:gap-4 mb-6 sm:mb-12 w-full px-4 max-w-2xl mx-auto",children:[e.jsxs(C,{"code-path":"src/components/home/QuickActions.tsx:12:7",variant:"outline",onClick:s,className:"flex items-center justify-center gap-2 px-4 sm:px-6 py-2.5 sm:py-3 rounded-lg transition-all duration-200 border-border text-text-secondary bg-transparent w-full sm:w-auto text-sm sm:text-base h-auto",children:[e.jsx(se,{"code-path":"src/components/home/QuickActions.tsx:17:9",size:16,className:"sm:w-[18px] sm:h-[18px]"}),e.jsx("span",{"code-path":"src/components/home/QuickActions.tsx:18:9",className:"whitespace-nowrap",children:"快速入门教程"})]}),e.jsxs(C,{"code-path":"src/components/home/QuickActions.tsx:21:7",variant:"outline",onClick:i,className:"flex items-center justify-center gap-2 px-4 sm:px-6 py-2.5 sm:py-3 rounded-lg transition-all duration-200 border-border text-text-secondary bg-transparent w-full sm:w-auto text-sm sm:text-base h-auto",children:[e.jsx(oe,{"code-path":"src/components/home/QuickActions.tsx:26:9",size:16,className:"sm:w-[18px] sm:h-[18px]"}),e.jsx("span",{"code-path":"src/components/home/QuickActions.tsx:27:9",className:"whitespace-nowrap",children:"进入剧本工坊"})]})]})}function De({project:s,onClick:i,onDelete:a,onDuplicate:p,onRename:r,isDeleting:l,isDuplicating:n}){const[h,m]=d.useState(!1);if(l||n)return e.jsx("div",{"code-path":"src/components/home/ProjectCard.tsx:28:7",className:"relative group overflow-hidden opacity-50 w-full aspect-[6/5]",children:e.jsxs("div",{"code-path":"src/components/home/ProjectCard.tsx:31:9",className:"flex items-center justify-center h-full",children:[e.jsx(T,{"code-path":"src/components/home/ProjectCard.tsx:32:11",className:"animate-spin text-text-secondary",size:20}),e.jsx("span",{"code-path":"src/components/home/ProjectCard.tsx:33:11",className:"ml-2 text-xs sm:text-sm text-text-secondary",children:l?"删除中...":"复制中..."})]})});const u=o=>{const f=new Date(o);return`${f.getMonth()+1}-${f.getDate()}`};return e.jsxs("div",{"code-path":"src/components/home/ProjectCard.tsx:47:5",className:"relative group cursor-pointer card overflow-hidden w-full aspect-[6/5]",onClick:i,children:[e.jsxs("div",{"code-path":"src/components/home/ProjectCard.tsx:52:7",className:"relative h-[65%] sm:h-[68%] overflow-hidden",children:[e.jsx("img",{"code-path":"src/components/home/ProjectCard.tsx:53:9",src:s.coverImage||`https://picsum.photos/400/225?random=${s.id}`,alt:s.name,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105"}),e.jsx("div",{"code-path":"src/components/home/ProjectCard.tsx:58:9",className:"absolute top-1.5 sm:top-2 right-1.5 sm:right-2",children:e.jsx("span",{"code-path":"src/components/home/ProjectCard.tsx:59:11",className:"tag text-[10px] sm:text-xs px-1.5 sm:px-2 py-0.5 sm:py-1",children:"影视短片"})})]}),e.jsxs("div",{"code-path":"src/components/home/ProjectCard.tsx:64:7",className:"p-2 sm:p-3",children:[e.jsx("h3",{"code-path":"src/components/home/ProjectCard.tsx:65:9",className:"font-medium text-xs sm:text-sm truncate mb-0.5 sm:mb-1 text-text-primary",children:s.name}),e.jsxs("div",{"code-path":"src/components/home/ProjectCard.tsx:70:9",className:"flex items-center justify-between",children:[e.jsx("span",{"code-path":"src/components/home/ProjectCard.tsx:71:11",className:"text-[10px] sm:text-xs text-text-tertiary",children:u(s.createdAt)}),e.jsxs("span",{"code-path":"src/components/home/ProjectCard.tsx:76:11",className:"text-[10px] sm:text-xs text-text-tertiary",children:[s.episodes?.length||1," 集"]})]})]}),e.jsx("button",{"code-path":"src/components/home/ProjectCard.tsx:85:7",className:"absolute top-1.5 sm:top-2 left-1.5 sm:left-2 opacity-0 group-hover:opacity-100 transition-opacity p-1 rounded bg-black/50",onClick:o=>{o.stopPropagation(),m(!h)},children:e.jsx(ae,{"code-path":"src/components/home/ProjectCard.tsx:92:9",size:14,className:"sm:w-4 sm:h-4 text-white"})}),h&&e.jsxs(e.Fragment,{children:[e.jsx("div",{"code-path":"src/components/home/ProjectCard.tsx:98:11",className:"fixed inset-0 z-40",onClick:o=>{o.stopPropagation(),m(!1)}}),e.jsxs("div",{"code-path":"src/components/home/ProjectCard.tsx:105:11",className:"absolute top-6 sm:top-8 left-1.5 sm:left-2 z-50 rounded-lg py-1 shadow-xl bg-surface border border-border min-w-[100px] sm:min-w-[120px]",children:[e.jsxs("button",{"code-path":"src/components/home/ProjectCard.tsx:108:13",className:"w-full px-2.5 sm:px-3 py-1.5 sm:py-2 text-left text-xs sm:text-sm flex items-center gap-1.5 sm:gap-2 hover:bg-white/5 text-text-primary",onClick:o=>{o.stopPropagation(),r?.(),m(!1)},children:[e.jsx(ce,{"code-path":"src/components/home/ProjectCard.tsx:116:15",size:12,className:"sm:w-3.5 sm:h-3.5"}),"重命名"]}),e.jsxs("button",{"code-path":"src/components/home/ProjectCard.tsx:119:13",className:"w-full px-2.5 sm:px-3 py-1.5 sm:py-2 text-left text-xs sm:text-sm flex items-center gap-1.5 sm:gap-2 hover:bg-white/5 text-text-primary",onClick:o=>{o.stopPropagation(),p?.(),m(!1)},children:[e.jsx(re,{"code-path":"src/components/home/ProjectCard.tsx:127:15",size:12,className:"sm:w-3.5 sm:h-3.5"}),"复制"]}),e.jsxs("button",{"code-path":"src/components/home/ProjectCard.tsx:130:13",className:"w-full px-2.5 sm:px-3 py-1.5 sm:py-2 text-left text-xs sm:text-sm flex items-center gap-1.5 sm:gap-2 hover:bg-white/5 text-red-500",onClick:o=>{o.stopPropagation(),a?.(),m(!1)},children:[e.jsx(ne,{"code-path":"src/components/home/ProjectCard.tsx:138:15",size:12,className:"sm:w-3.5 sm:h-3.5"}),"删除"]})]})]})]})}function $e({onClick:s}){return e.jsxs("div",{"code-path":"src/components/home/NewProjectCard.tsx:9:5",className:"relative cursor-pointer rounded-lg overflow-hidden transition-all duration-200 hover:scale-[1.02] flex flex-col items-center justify-center bg-surface border-2 border-dashed border-border w-full aspect-[6/5]",onClick:s,children:[e.jsx("div",{"code-path":"src/components/home/NewProjectCard.tsx:13:7",className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center mb-2 sm:mb-3 transition-colors border border-dashed text-primary",style:{backgroundColor:"rgba(255, 215, 0, 0.1)"},children:e.jsx(ie,{"code-path":"src/components/home/NewProjectCard.tsx:19:9",size:20,className:"sm:w-6 sm:h-6 text-primary"})}),e.jsx("span",{"code-path":"src/components/home/NewProjectCard.tsx:21:7",className:"text-xs sm:text-sm font-medium text-text-secondary",children:"新建项目"})]})}function Ee({onProjectClick:s,onNewProject:i}){const a=v(t=>t.projects),p=v(t=>t.isLoading),r=v(t=>t.fetchProjects),l=v(t=>t.deleteProject),n=v(t=>t.addProject),h=v(t=>t.updateProject),m=N(t=>t.setCurrentProject),u=k(t=>t.addToast),[o,f]=d.useState(!1),[y,x]=d.useState(null),[w,P]=d.useState(null),[c,j]=d.useState(null),[g,b]=d.useState(""),H=o?a:a.slice(0,4),W=t=>{m(t),s?.(t)},Q=async t=>{x(t.id);try{await l(t.id),u({type:"success",message:"项目已删除"})}catch{u({type:"error",message:"删除项目失败"})}finally{x(null)}},O=async t=>{P(t.id);try{const z=(await le.getProject(t.id)).data;await n(`${z.name} (复制)`,z.meta),await r(),u({type:"success",message:"项目已复制"})}catch(I){console.error("Failed to duplicate project:",I),u({type:"error",message:"复制项目失败"})}finally{P(null)}},U=t=>{j(t),b(t.name)},G=async()=>{if(!(!c||!g.trim()))try{await h(c.id,{name:g.trim()}),u({type:"success",message:"项目已重命名"}),j(null)}catch(t){console.error("Failed to rename project:",t),u({type:"error",message:"重命名失败"})}};return p?e.jsx("div",{"code-path":"src/components/home/ProjectList.tsx:97:7",className:"w-full max-w-5xl mx-auto",children:e.jsxs("div",{"code-path":"src/components/home/ProjectList.tsx:98:9",className:"flex items-center justify-center py-12 text-text-secondary",children:[e.jsx(T,{"code-path":"src/components/home/ProjectList.tsx:99:11",className:"animate-spin mr-2",size:20}),e.jsx("span",{"code-path":"src/components/home/ProjectList.tsx:100:11",children:"加载项目中..."})]})}):e.jsxs("div",{"code-path":"src/components/home/ProjectList.tsx:107:5",className:"w-full max-w-5xl mx-auto px-4 sm:px-0",children:[e.jsxs("div",{"code-path":"src/components/home/ProjectList.tsx:108:7",className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{"code-path":"src/components/home/ProjectList.tsx:109:9",className:"text-base sm:text-lg font-medium text-text-primary",children:["我的项目 (",a.length,")"]}),a.length>0&&e.jsxs("button",{"code-path":"src/components/home/ProjectList.tsx:113:11",onClick:()=>f(!o),className:"flex items-center gap-1 text-xs sm:text-sm hover:opacity-80 transition-opacity text-text-secondary",children:[o?"收起":"查看全部",e.jsx(me,{"code-path":"src/components/home/ProjectList.tsx:118:13",size:16,className:`transition-transform ${o?"rotate-90":""}`})]})]}),e.jsxs("div",{"code-path":"src/components/home/ProjectList.tsx:123:7",className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx($e,{"code-path":"src/components/home/ProjectList.tsx:124:9",onClick:i}),a.length===0?e.jsx("div",{"code-path":"src/components/home/ProjectList.tsx:127:11",className:"col-span-3 flex items-center justify-center py-12 text-text-tertiary",children:e.jsx("p",{"code-path":"src/components/home/ProjectList.tsx:128:13",children:'暂无项目，点击上方"新建项目"开始创作'})}):H.map(t=>e.jsx(De,{"code-path":"src/components/home/ProjectList.tsx:132:13",project:t,onClick:()=>W(t),onDelete:()=>Q(t),onDuplicate:()=>O(t),onRename:()=>U(t),isDeleting:y===t.id,isDuplicating:w===t.id},t.id))]}),e.jsx(je,{"code-path":"src/components/home/ProjectList.tsx:147:7",open:!!c,onOpenChange:()=>j(null),children:e.jsxs(ge,{"code-path":"src/components/home/ProjectList.tsx:148:9",children:[e.jsx(fe,{"code-path":"src/components/home/ProjectList.tsx:149:11",children:e.jsx(ye,{"code-path":"src/components/home/ProjectList.tsx:150:13",children:"重命名项目"})}),e.jsx(de,{"code-path":"src/components/home/ProjectList.tsx:152:11",value:g,onChange:t=>b(t.target.value),placeholder:"输入新名称",className:"mt-4"}),e.jsxs(we,{"code-path":"src/components/home/ProjectList.tsx:158:11",className:"mt-4",children:[e.jsx(C,{"code-path":"src/components/home/ProjectList.tsx:159:13",variant:"outline",onClick:()=>j(null),children:"取消"}),e.jsx(C,{"code-path":"src/components/home/ProjectList.tsx:162:13",onClick:G,disabled:!g.trim(),children:"确认"})]})]})})]})}function Me(){const s=A(),{theme:i,currentProject:a,currentEpisode:p}=N(),{addProject:r,fetchProjects:l}=v(),n=N(c=>c.setCurrentProject),h=N(c=>c.setCurrentEpisode),m=k(c=>c.addToast),[u,o]=d.useState(!1);d.useEffect(()=>{l().catch(console.error)},[l]),d.useEffect(()=>{document.body.className=i},[i]);const f=async(c,j)=>{sessionStorage.setItem("startup_prompt",c),pe.clearSession(),o(!0),m({type:"success",message:j?"极速模式：正在构思宏大叙事...":"正在为你创建创作空间..."});try{const{project:g,episode:b}=await L.createTemporaryProject();n(g),h(b),s(`/project/${g.id}/episode/${b.episodeId}/script-workshop`)}catch(g){console.error("Failed to create project:",g),m({type:"error",message:"创建项目失败，请重试"})}finally{o(!1)}},y=()=>{m({type:"info",message:"快速入门教程开发中"})},x=c=>{s(`/project/${c.id}`)},w=async()=>{try{const c=await r("新项目");n(c),m({type:"success",message:"新项目已创建"}),s(`/project/${c.id}`)}catch{m({type:"error",message:"创建项目失败"})}},P=async()=>{if(!u){if(a?.id&&p?.id){s(`/project/${a.id}/episode/${p.id}/script-workshop`);return}o(!0);try{const c=await L.recoverTemporaryProject();if(c){n(c.project),h(c.episode),s(`/project/${c.project.id}/episode/${c.episode.episodeId}/script-workshop`);return}const{project:j,episode:g}=await L.createTemporaryProject();n(j),h(g),m({type:"success",message:"已进入剧本工坊，开始创作吧！"}),s(`/project/${j.id}/episode/${g.episodeId}/script-workshop`)}catch(c){console.error("创建临时项目失败:",c),m({type:"error",message:"进入创作空间失败，请重试"})}finally{o(!1)}}};return e.jsxs("div",{"code-path":"src/pages/HomePage.tsx:123:5",className:"h-screen w-screen fixed flex flex-col bg-background overflow-hidden",children:[e.jsx(Pe,{"code-path":"src/pages/HomePage.tsx:124:7",variant:"home"}),e.jsxs("main",{"code-path":"src/pages/HomePage.tsx:126:7",className:"flex-1 flex flex-col items-center justify-evenly px-4 sm:px-6 w-full max-w-full overflow-hidden",children:[e.jsxs("div",{"code-path":"src/pages/HomePage.tsx:127:9",className:"w-full max-w-3xl flex flex-col items-center gap-6 sm:gap-8 animate-fade-in relative z-10 shrink-0",children:[e.jsx(ve,{"code-path":"src/pages/HomePage.tsx:128:11"}),e.jsx(Te,{"code-path":"src/pages/HomePage.tsx:129:11",onGenerate:f}),e.jsx(ze,{"code-path":"src/pages/HomePage.tsx:130:11",onTutorial:y,onScriptWorkshop:P})]}),e.jsx("div",{"code-path":"src/pages/HomePage.tsx:136:9",className:"w-full max-w-5xl animate-slide-up shrink-0",style:{animationDelay:"0.1s"},children:e.jsx(Ee,{"code-path":"src/pages/HomePage.tsx:137:11",onProjectClick:x,onNewProject:w})})]})]})}export{Me as HomePage};
