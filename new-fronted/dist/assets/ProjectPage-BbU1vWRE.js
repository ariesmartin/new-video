import{g as Te,u as de,a as Y,j as e,i as R,A as Se,S as $e,q as Ge,s as Q,D as it,b as dt,M as pt,t as q,r as c,v as we,w as le,x as mt,G as xt,y as ht,z as ut,m as se,X as F,H as ft,J as ke,K as bt,V as gt,N as vt,O as yt,T as He,k as jt,Q as Ke,R as Ue,Y as Nt,_ as Le,$ as St,a0 as wt,a1 as Ct,L as Fe,a2 as Mt,a3 as Pt,a4 as Dt,e as We,a5 as X,c as U,d as Z,P as ae,a6 as kt,a7 as Xe,f as Ne,a8 as ce,a9 as Re,aa as ie,ab as Oe,ac as _e,ad as Ee,ae as It,af as Lt,ag as Rt,ah as Ot,ai as _t,p as Et}from"./index-yu4waMHZ.js";import{L as At,f as Ce,D as pe,b as me,c as xe,d as he,u as zt,a as Vt,g as Bt}from"./scenes-4ITdBoBR.js";import{s as Tt,C as $t}from"./ConfirmNovelNameDialog-nFbonFPb.js";import{u as Gt,p as Ae}from"./projectAutoCreate-DOzCcy5D.js";const ze={pending:"#94a3b8",processing:"#3b82f6",completed:"#22c55e",approved:"#10b981",revision:"#f59e0b"};function Ht({onScriptWorkshop:t,onBatchGenerate:a,onExport:o,onBackstage:s}){const n=Te(),{theme:l,setTheme:d}=de(),r=Y(N=>N.addToast),v=()=>{d(l==="dark"?"light":"dark")},i=()=>{n("/")},x=()=>{s?s():r({type:"info",message:"åŽå°ç®¡ç†åŠŸèƒ½å¼€å‘ä¸­"})},m=()=>{a?a():r({type:"info",message:"æ‰¹é‡ç”Ÿå›¾åŠŸèƒ½å¼€å‘ä¸­"})},u=()=>{o?o():r({type:"info",message:"å¯¼å‡ºåŠŸèƒ½å¼€å‘ä¸­"})};return e.jsxs("header",{"code-path":"src/components/layout/ProjectHeader.tsx:65:5",className:"flex items-center justify-between px-2 sm:px-4 py-2 sm:py-3 bg-surface border-b border-border",children:[e.jsxs("div",{"code-path":"src/components/layout/ProjectHeader.tsx:66:7",className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs(R,{"code-path":"src/components/layout/ProjectHeader.tsx:67:9",variant:"ghost",size:"sm",onClick:i,className:"flex items-center gap-1.5 text-text-secondary px-2 sm:px-3",title:"è¿”å›žä¸»é¡µ",children:[e.jsx(Se,{"code-path":"src/components/layout/ProjectHeader.tsx:74:11",size:16}),e.jsx("span",{"code-path":"src/components/layout/ProjectHeader.tsx:75:11",className:"hidden sm:inline",children:"ä¸»é¡µ"})]}),e.jsx("div",{"code-path":"src/components/layout/ProjectHeader.tsx:77:9",className:"w-px h-6 bg-border hidden sm:block"}),e.jsx("div",{"code-path":"src/components/layout/ProjectHeader.tsx:78:9",className:"scale-90 sm:scale-100 origin-left",children:e.jsx(At,{"code-path":"src/components/layout/ProjectHeader.tsx:79:11",size:"md",showText:!0})})]}),e.jsxs("div",{"code-path":"src/components/layout/ProjectHeader.tsx:84:7",className:"flex items-center gap-1 sm:gap-2",children:[e.jsxs(R,{"code-path":"src/components/layout/ProjectHeader.tsx:85:9",variant:"ghost",size:"sm",onClick:x,className:"flex items-center gap-1.5 text-text-secondary px-2 sm:px-3",children:[e.jsx($e,{"code-path":"src/components/layout/ProjectHeader.tsx:91:11",size:16}),e.jsx("span",{"code-path":"src/components/layout/ProjectHeader.tsx:92:11",className:"hidden sm:inline",children:"åŽå°"})]}),e.jsxs(R,{"code-path":"src/components/layout/ProjectHeader.tsx:95:9",variant:"ghost",size:"sm",onClick:t,className:"flex items-center gap-1.5 text-text-secondary px-2 sm:px-3",children:[e.jsx(Ge,{"code-path":"src/components/layout/ProjectHeader.tsx:101:11",size:16}),e.jsx("span",{"code-path":"src/components/layout/ProjectHeader.tsx:102:11",className:"hidden sm:inline",children:"å‰§æœ¬"})]}),e.jsxs(R,{"code-path":"src/components/layout/ProjectHeader.tsx:105:9",variant:"ghost",size:"sm",onClick:m,className:"flex items-center gap-1.5 text-text-secondary px-2 sm:px-3",children:[e.jsx(Q,{"code-path":"src/components/layout/ProjectHeader.tsx:111:11",size:16}),e.jsx("span",{"code-path":"src/components/layout/ProjectHeader.tsx:112:11",className:"hidden sm:inline",children:"æ‰¹é‡"})]}),e.jsxs(R,{"code-path":"src/components/layout/ProjectHeader.tsx:115:9",variant:"ghost",size:"sm",onClick:u,className:"flex items-center gap-1.5 text-text-secondary px-2 sm:px-3",children:[e.jsx(it,{"code-path":"src/components/layout/ProjectHeader.tsx:121:11",size:16}),e.jsx("span",{"code-path":"src/components/layout/ProjectHeader.tsx:122:11",className:"hidden sm:inline",children:"å¯¼å‡º"})]}),e.jsx(R,{"code-path":"src/components/layout/ProjectHeader.tsx:126:9",variant:"ghost",size:"icon",onClick:v,className:"ml-1 sm:ml-2 text-text-secondary h-8 w-8 sm:h-9 sm:w-9",children:l==="dark"?e.jsx(dt,{"code-path":"src/components/layout/ProjectHeader.tsx:132:31",size:18}):e.jsx(pt,{"code-path":"src/components/layout/ProjectHeader.tsx:132:51",size:18})}),e.jsx("div",{"code-path":"src/components/layout/ProjectHeader.tsx:136:9",className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full flex items-center justify-center ml-1 sm:ml-2 bg-primary",children:e.jsx("span",{"code-path":"src/components/layout/ProjectHeader.tsx:137:11",className:"text-xs sm:text-sm font-medium text-primary-foreground",children:"A"})})]})]})}const Kt={async listAssets(t,a,o=1,s=100){const{data:n,error:l}=await q.GET("/api/projects/{project_id}/assets",{params:{path:{project_id:t},query:{asset_type:a,page:o,page_size:s}}});if(l)throw l;return n},async getAsset(t){const{data:a,error:o}=await q.GET("/api/projects/assets/{asset_id}",{params:{path:{asset_id:t}}});if(o)throw o;return a},async createAsset(t,a){const{data:o,error:s}=await q.POST("/api/projects/{project_id}/assets",{params:{path:{project_id:t}},body:a});if(s)throw s;return o},async updateAsset(t,a){const{data:o,error:s}=await q.PATCH("/api/projects/assets/{asset_id}",{params:{path:{asset_id:t}},body:a});if(s)throw s;return o},async deleteAsset(t){const{error:a}=await q.DELETE("/api/projects/assets/{asset_id}",{params:{path:{asset_id:t}}});if(a)throw a},async extractAssets(t,a,o){const{data:s,error:n}=await q.POST("/api/projects/{project_id}/assets/extract",{params:{path:{project_id:t}},body:{content:a,content_type:o}});if(n)throw n;return s}},Ve=[{id:"project",icon:mt,label:"é¡¹ç›®"},{id:"script",icon:Ge,label:"å‰§æœ¬"},{id:"shots",icon:xt,label:"é•œå¤´"},{id:"characters",icon:ht,label:"è®¾å®š"},{id:"assets",icon:Q,label:"èµ„äº§"}];function Ut({episodes:t}={}){const[a,o]=c.useState(!1),[s,n]=c.useState("script"),{currentProject:l,currentEpisode:d,setCurrentEpisode:r}=de(),{openDirectorPanel:v,openNodeEditPanel:i,addToast:x}=Y(),[m,u]=c.useState(t||[]),[N,g]=c.useState([]),[h]=c.useState([]),[y,b]=c.useState(!1),p=c.useRef(null),S=j=>{n(j),o(!0),j==="script"&&v()},w=j=>{r(j),v()},P=j=>{i(j)};c.useEffect(()=>{if(!l?.id)return;(async()=>{b(!0);try{const[k,z]=await Promise.allSettled([Ce.listEpisodes(l.id),Kt.listAssets(l.id,"character")]);if(k.status==="fulfilled"){const _=k.value.data,L=_?.data||_||[];u(L.map(C=>({id:C.episodeId||C.id,projectId:C.projectId||l.id,episodeNumber:C.episodeNumber||1,title:C.title||"æœªå‘½åå‰§é›†",summary:C.summary,script:C.scriptText||C.script,novelContent:C.novelContent,wordCount:C.wordCount||0,status:C.status||"draft",canvasData:C.canvasData,createdAt:new Date(C.createdAt||Date.now()),updatedAt:new Date(C.updatedAt||Date.now())})))}if(z.status==="fulfilled"){const _=z.value.data,L=_?.data||_||[];g(L.map(C=>({id:C.assetId||C.id,projectId:C.projectId||l.id,name:C.name||"æœªå‘½åè§’è‰²",gender:C.visualTokens?.gender||C.gender||"other",description:C.description||"",referenceImages:C.referenceUrls||C.referenceImages||[]})))}}catch(k){console.error("Failed to load sidebar data:",k),x?.({type:"error",message:"åŠ è½½æ•°æ®å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•"})}finally{b(!1)}})()},[l?.id]);const D=()=>{switch(s){case"script":return e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:127:11",className:"p-4 space-y-4",children:[e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:128:13",className:"flex items-center justify-between",children:[e.jsx("h4",{"code-path":"src/components/panels/LeftSidebar.tsx:129:15",className:"text-xs font-medium text-text-tertiary uppercase tracking-wider",children:"å¤§çº²"}),e.jsx("button",{"code-path":"src/components/panels/LeftSidebar.tsx:132:15",className:"text-xs text-primary hover:underline",children:"å¯¼å…¥ TXT"})]}),e.jsx("textarea",{"code-path":"src/components/panels/LeftSidebar.tsx:137:13",className:"w-full h-32 p-3 rounded-lg bg-elevated border border-border text-sm text-text-primary resize-none",placeholder:"åœ¨æ­¤è¾“å…¥æ•…äº‹å¤§çº²..."}),e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:142:13",className:"flex items-center gap-2",children:[e.jsx("input",{"code-path":"src/components/panels/LeftSidebar.tsx:143:15",type:"number",defaultValue:5,className:"w-16 px-2 py-1 rounded bg-elevated border border-border text-sm text-center"}),e.jsxs(R,{"code-path":"src/components/panels/LeftSidebar.tsx:148:15",className:"flex-1 btn-primary gap-1 text-sm",children:[e.jsx("span",{"code-path":"src/components/panels/LeftSidebar.tsx:149:17",children:"âœ¨"}),"æ™ºèƒ½åˆ†é›†"]})]}),e.jsxs(R,{"code-path":"src/components/panels/LeftSidebar.tsx:154:13",variant:"outline",className:"w-full gap-1 border-border text-text-secondary text-sm",children:[e.jsx(se,{"code-path":"src/components/panels/LeftSidebar.tsx:158:15",size:16}),"æ–°å¢žä¸€é›†"]}),e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:162:13",children:[e.jsx("h4",{"code-path":"src/components/panels/LeftSidebar.tsx:163:15",className:"text-xs font-medium text-text-tertiary uppercase tracking-wider mb-2",children:"åˆ†é›†åˆ—è¡¨"}),e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:166:15",className:"space-y-1",children:y?e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:168:19",className:"text-center py-4 text-text-tertiary text-sm",children:"åŠ è½½ä¸­..."}):m.length===0?e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:170:19",className:"text-center py-4 text-text-tertiary text-sm",children:"æš‚æ— å‰§é›†"}):m.map(j=>e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:173:21",onClick:()=>w(j),className:`
                        group flex items-center justify-between px-3 py-2 rounded-lg cursor-pointer
                        transition-colors duration-200
                        ${d?.id===j.id?"bg-primary/10":"hover:bg-white/5"}
                      `,children:[e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:182:23",className:"flex flex-col flex-1 min-w-0",children:[e.jsxs("span",{"code-path":"src/components/panels/LeftSidebar.tsx:183:25",className:`text-sm truncate ${d?.id===j.id?"text-primary":"text-text-primary"}`,children:["ç¬¬",j.episodeNumber,"é›†: ",j.title]}),e.jsxs("span",{"code-path":"src/components/panels/LeftSidebar.tsx:190:25",className:"text-xs text-text-tertiary",children:[j.wordCount,"å­—"]})]}),e.jsx("button",{"code-path":"src/components/panels/LeftSidebar.tsx:192:23",className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-white/10 rounded transition-opacity",onClick:k=>{k.stopPropagation()},children:e.jsx(F,{"code-path":"src/components/panels/LeftSidebar.tsx:198:25",size:14,className:"text-text-tertiary"})})]},j.id))})]})]});case"shots":return e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:210:11",className:"p-4",children:[e.jsx("h4",{"code-path":"src/components/panels/LeftSidebar.tsx:211:13",className:"text-xs font-medium text-text-tertiary uppercase tracking-wider mb-3",children:"é•œå¤´åˆ—è¡¨"}),e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:214:13",className:"grid grid-cols-2 gap-2",children:Array.from({length:6},(j,k)=>k+1).map(j=>e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:216:17",onClick:()=>P(`shot-${j}`),className:"aspect-video bg-elevated rounded-lg flex items-center justify-center cursor-pointer hover:bg-white/5 transition-colors border border-border",children:e.jsxs("span",{"code-path":"src/components/panels/LeftSidebar.tsx:221:19",className:"text-xs text-text-secondary",children:["é•œå¤´ ",j]})},j))})]});case"characters":return e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:230:11",className:"p-4 space-y-6",children:[e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:231:13",children:[e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:232:15",className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{"code-path":"src/components/panels/LeftSidebar.tsx:233:17",className:"text-xs font-medium text-text-tertiary uppercase tracking-wider",children:"è§’è‰²"}),e.jsx("button",{"code-path":"src/components/panels/LeftSidebar.tsx:236:17",className:"p-1 hover:bg-white/10 rounded transition-colors text-primary",children:e.jsx(se,{"code-path":"src/components/panels/LeftSidebar.tsx:237:19",size:16})})]}),e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:240:15",className:"space-y-2",children:y?e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:242:19",className:"text-center py-4 text-text-tertiary text-sm",children:"åŠ è½½ä¸­..."}):N.length===0?e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:244:19",className:"text-center py-4 text-text-tertiary text-sm",children:"æš‚æ— è§’è‰²"}):N.map(j=>e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:247:21",className:"flex items-center gap-3 p-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors",children:[e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:251:23",className:"w-10 h-10 rounded-lg bg-elevated flex items-center justify-center",children:e.jsx("span",{"code-path":"src/components/panels/LeftSidebar.tsx:252:25",className:"text-lg",children:"ðŸ‘¤"})}),e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:254:23",children:[e.jsx("p",{"code-path":"src/components/panels/LeftSidebar.tsx:255:25",className:"text-sm font-medium text-text-primary",children:j.name}),e.jsx("p",{"code-path":"src/components/panels/LeftSidebar.tsx:256:25",className:"text-xs text-text-tertiary",children:j.gender})]})]},j.id))})]}),e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:264:13",children:[e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:265:15",className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{"code-path":"src/components/panels/LeftSidebar.tsx:266:17",className:"text-xs font-medium text-text-tertiary uppercase tracking-wider",children:"åœºæ™¯"}),e.jsx("button",{"code-path":"src/components/panels/LeftSidebar.tsx:269:17",className:"p-1 hover:bg-white/10 rounded transition-colors text-primary",children:e.jsx(se,{"code-path":"src/components/panels/LeftSidebar.tsx:270:19",size:16})})]}),e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:273:15",className:"space-y-2",children:y?e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:275:19",className:"text-center py-4 text-text-tertiary text-sm",children:"åŠ è½½ä¸­..."}):h.length===0?e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:277:19",className:"text-center py-4 text-text-tertiary text-sm",children:"æš‚æ— åœºæ™¯"}):h.map(j=>e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:280:21",className:"flex items-center gap-3 p-2 rounded-lg hover:bg-white/5 cursor-pointer transition-colors",children:[e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:284:23",className:"w-10 h-10 rounded-lg bg-elevated flex items-center justify-center",children:e.jsx("span",{"code-path":"src/components/panels/LeftSidebar.tsx:285:25",className:"text-lg",children:"ðŸ¥"})}),e.jsx("p",{"code-path":"src/components/panels/LeftSidebar.tsx:287:23",className:"text-sm font-medium text-text-primary",children:j.name})]},j.id))})]})]});case"assets":return e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:298:11",className:"p-4",children:[e.jsx("h4",{"code-path":"src/components/panels/LeftSidebar.tsx:299:13",className:"text-xs font-medium text-text-tertiary uppercase tracking-wider mb-3",children:"è§†è§‰èµ„äº§"}),e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:302:13",className:"grid grid-cols-2 gap-2",children:Array.from({length:4},(j,k)=>k+1).map(j=>e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:304:17",className:"aspect-square bg-elevated rounded-lg flex items-center justify-center border border-border",children:e.jsx("span",{"code-path":"src/components/panels/LeftSidebar.tsx:308:19",className:"text-2xl",children:"ðŸ–¼ï¸"})},j))})]});default:return e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:317:11",className:"p-4",children:e.jsx("p",{"code-path":"src/components/panels/LeftSidebar.tsx:318:13",className:"text-sm text-text-secondary",children:"é¡¹ç›®æ¦‚è§ˆ"})})}};return e.jsxs(e.Fragment,{children:[e.jsx(we,{"code-path":"src/components/panels/LeftSidebar.tsx:326:7",mode:"wait",children:!a&&e.jsx(le.div,{"code-path":"src/components/panels/LeftSidebar.tsx:328:11",initial:{x:-100,opacity:0},animate:{x:0,opacity:1},exit:{x:-100,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"fixed left-4 z-40 hidden sm:flex flex-col",style:{top:"72px",bottom:"80px",justifyContent:"center"},children:e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:341:13",className:"flex flex-col items-center py-3 px-2 gap-2 rounded-2xl bg-surface/95 backdrop-blur-md border border-border shadow-2xl",children:Ve.map(j=>{const k=j.icon,z=s===j.id;return e.jsxs("button",{"code-path":"src/components/panels/LeftSidebar.tsx:348:19",onClick:()=>S(j.id),className:`
                      relative w-10 h-10 flex items-center justify-center rounded-xl
                      transition-all duration-200
                      ${z?"bg-primary/20 text-primary shadow-inner":"text-text-secondary hover:text-text-primary hover:bg-white/5"}
                    `,title:j.label,children:[z&&e.jsx(le.div,{"code-path":"src/components/panels/LeftSidebar.tsx:361:23",layoutId:"leftActiveIndicator",className:"absolute inset-0 rounded-xl bg-primary/10",transition:{type:"spring",stiffness:300,damping:30}}),e.jsx(k,{"code-path":"src/components/panels/LeftSidebar.tsx:367:21",size:20})]},j.id)})})},"icon-bar")}),e.jsx(we,{"code-path":"src/components/panels/LeftSidebar.tsx:376:7",children:a&&e.jsx(le.div,{"code-path":"src/components/panels/LeftSidebar.tsx:378:11",ref:p,initial:{x:-300,opacity:0},animate:{x:0,opacity:1},exit:{x:-300,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"fixed left-4 z-40 hidden sm:block",style:{top:"72px",bottom:"80px",width:"min(280px, 85vw)"},children:e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:391:15",className:"h-full flex flex-col rounded-2xl bg-surface/95 backdrop-blur-md border border-border shadow-2xl overflow-hidden",children:[e.jsxs("div",{"code-path":"src/components/panels/LeftSidebar.tsx:392:15",className:"flex items-center justify-between px-2 py-2 border-b border-border/50",children:[e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:393:17",className:"flex items-center justify-around flex-1",children:Ve.map(j=>{const k=j.icon,z=s===j.id;return e.jsxs("button",{"code-path":"src/components/panels/LeftSidebar.tsx:399:23",onClick:()=>S(j.id),className:`
                          flex flex-col items-center gap-0.5 px-2 py-1.5 rounded-lg transition-all duration-200 min-w-[44px]
                          ${z?"bg-primary/10 text-primary":"hover:bg-white/5 text-text-secondary"}
                        `,children:[e.jsx(k,{"code-path":"src/components/panels/LeftSidebar.tsx:407:25",size:18}),e.jsx("span",{"code-path":"src/components/panels/LeftSidebar.tsx:408:25",className:"text-[10px]",children:j.label})]},j.id)})}),e.jsx("button",{"code-path":"src/components/panels/LeftSidebar.tsx:413:17",onClick:()=>o(!1),className:"p-2 rounded-lg hover:bg-white/10 transition-colors text-text-tertiary hover:text-text-primary flex-shrink-0",children:e.jsx(ut,{"code-path":"src/components/panels/LeftSidebar.tsx:417:19",size:20})})]}),e.jsx("div",{"code-path":"src/components/panels/LeftSidebar.tsx:421:15",className:"flex-1 overflow-y-auto",children:D()})]})})})]})}function Ft({activeTab:t="script"}){const{currentEpisode:a}=de(),o=a?.script||`æ–°å·´æ¯”ä¼¦çš„é›¨æ€»æ˜¯å¸¦ç€ä¸€è‚¡æœºæ²¹å‘³ã€‚ä¸‹åŸŽåŒºçš„åžƒåœ¾å¤„ç†åŽ‚è¢«é«˜è€¸çš„å›´å¢™åœˆç¦ï¼Œè¿™é‡Œæ˜¯åŸŽå¸‚ä¸ä»…ä¸¢å¼ƒåºŸæ–™ï¼Œä¹Ÿä¸¢å¼ƒçµé­‚çš„åœ°æ–¹ã€‚

å·´æ–¯ç‰¹æ˜¯ä¸€åªç”šè‡³è¿žåå­—éƒ½æ²¡æœ‰çš„æ‚ç§ç‹—ï¼Œå®ƒæ­£åŒåŒåœ¨ä¸€å †ç”Ÿé”ˆçš„æ±½è½¦é›¶ä»¶ä¸‹ã€‚å®ƒçš„å‘¼å¸å¾ˆè½»ï¼Œçœ¼ç›æ­»æ­»ç›¯ç€å‰æ–¹äº”ç±³å¤„çš„ä¸€å—å‘éœ‰çš„é¢åŒ…ã€‚è€Œåœ¨å®ƒå¯¹é¢ï¼Œä¸€åªä½“åž‹ç¡•å¤§çš„æ¯”ç‰¹çŠ¬æ­£é¾‡ç€ç‰™ï¼Œé‚£æ˜¯è¿™ä¸€å¸¦çš„å°éœ¸çŽ‹"ç¢Žéª¨"ã€‚

é›¨æ°´é¡ºç€å·´æ–¯ç‰¹å·¦è€³é‚£ä¸ªå‚å·®ä¸é½çš„ç¼ºå£æµä¸‹ï¼Œé‚£æ˜¯å®ƒå¹¼å¹´æ—¶ä»Žç»´å…‹å¤šçš„å®žéªŒå®¤é€ƒç”Ÿæ—¶ç•™ä¸‹çš„çƒ™å°ã€‚`,s=()=>{switch(t){case"script":return e.jsxs("div",{"code-path":"src/components/panels/DirectorPanel.tsx:22:11",className:"flex-1 flex flex-col p-4 pt-2",children:[e.jsxs("div",{"code-path":"src/components/panels/DirectorPanel.tsx:23:13",className:"flex items-center gap-2 mb-3",children:[e.jsx("span",{"code-path":"src/components/panels/DirectorPanel.tsx:24:15",className:"text-xs px-2 py-1 rounded bg-elevated text-text-secondary",children:"æœ¬é›†æ•…äº‹(Story)"}),e.jsx("span",{"code-path":"src/components/panels/DirectorPanel.tsx:27:15",className:"text-xs px-2 py-1 rounded cursor-pointer hover:bg-white/5 text-text-tertiary",children:"åœºæ¬¡å‰§æœ¬ Script"})]}),e.jsx("div",{"code-path":"src/components/panels/DirectorPanel.tsx:32:13",className:"flex-1 overflow-y-auto p-3 rounded-lg bg-elevated text-sm leading-relaxed text-text-primary",children:o}),e.jsxs(R,{"code-path":"src/components/panels/DirectorPanel.tsx:36:13",className:"w-full mt-3 btn-primary flex items-center justify-center gap-2 text-sm",children:[e.jsx(ft,{"code-path":"src/components/panels/DirectorPanel.tsx:37:15",size:16}),"AI æ‰©å†™ä¸ºåœºæ¬¡å‰§æœ¬"]})]});case"storyboard":return e.jsx("div",{"code-path":"src/components/panels/DirectorPanel.tsx:45:11",className:"flex-1 flex flex-col p-4 pt-2",children:e.jsx("p",{"code-path":"src/components/panels/DirectorPanel.tsx:46:13",className:"text-sm text-text-secondary",children:"åˆ†é•œåˆ—è¡¨å°†åœ¨è¿™é‡Œæ˜¾ç¤º"})});case"card":return e.jsx("div",{"code-path":"src/components/panels/DirectorPanel.tsx:52:11",className:"flex-1 flex flex-col p-4 pt-2",children:e.jsx("p",{"code-path":"src/components/panels/DirectorPanel.tsx:53:13",className:"text-sm text-text-secondary",children:"å¡ç‰‡å±žæ€§è®¾ç½®"})});default:return null}};return e.jsx("div",{"code-path":"src/components/panels/DirectorPanel.tsx:63:5",className:"flex flex-col h-full w-full",children:s()})}function Wt({shot:t}){const{closeRightPanel:a}=Y(),{updateShotNode:o}=ke(),[s,n]=c.useState("sketch"),l=r=>{o(t.shotId,{status:r})},d=[{key:"pending",color:"bg-status-red",label:"å¾…å¤„ç†"},{key:"processing",color:"bg-status-yellow",label:"å¤„ç†ä¸­"},{key:"completed",color:"bg-status-green",label:"å·²å®Œæˆ"},{key:"approved",color:"bg-status-blue",label:"å·²æ‰¹å‡†"}];return e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:28:5",className:"flex flex-col h-full bg-surface border-l border-border w-full overflow-y-auto",children:[e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:29:7",className:"px-4 py-3 border-b border-border flex items-center justify-between sticky top-0 bg-surface z-10",children:[e.jsx("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:30:9",className:"flex items-center gap-2",children:e.jsxs("span",{"code-path":"src/components/panels/ShotDetailPanel.tsx:31:11",className:"text-sm font-medium text-text-primary",children:["é•œå¤´ #",t.shotNumber]})}),e.jsx("button",{"code-path":"src/components/panels/ShotDetailPanel.tsx:35:9",onClick:a,className:"p-1.5 rounded-lg hover:bg-white/5 transition-colors text-text-tertiary hover:text-text-primary",children:e.jsx("span",{"code-path":"src/components/panels/ShotDetailPanel.tsx:39:11",className:"text-lg",children:"Ã—"})})]}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:43:7",className:"p-4 space-y-5",children:[e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:44:9",children:[e.jsx("h4",{"code-path":"src/components/panels/ShotDetailPanel.tsx:45:11",className:"text-xs font-medium mb-2 text-text-tertiary uppercase tracking-wider",children:"çŠ¶æ€ä¸Žå±žæ€§"}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:48:11",className:"flex items-center gap-2",children:[e.jsx(R,{"code-path":"src/components/panels/ShotDetailPanel.tsx:49:13",variant:"outline",size:"sm",className:"text-xs border-border text-text-secondary hover:text-text-primary",children:"æ–­å¼€"}),e.jsx(R,{"code-path":"src/components/panels/ShotDetailPanel.tsx:56:13",variant:"outline",size:"sm",className:"text-xs border-border text-text-secondary hover:text-text-primary",children:"åˆ†é•œ"}),e.jsx("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:63:13",className:"flex-1"}),d.map(r=>e.jsx("button",{"code-path":"src/components/panels/ShotDetailPanel.tsx:65:15",onClick:()=>l(r.key),className:`w-6 h-6 rounded-full transition-transform hover:scale-110 ${r.color} ${t.status===r.key?"ring-2 ring-white":""}`,title:r.label},r.key))]})]}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:77:9",children:[e.jsx("h4",{"code-path":"src/components/panels/ShotDetailPanel.tsx:78:11",className:"text-xs font-medium mb-2 text-text-tertiary uppercase tracking-wider",children:"å‚è€ƒå›¾"}),e.jsx("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:81:11",className:"flex gap-2 mb-3",children:[{key:"sketch",label:"æ‰‹ç»˜",icon:bt},{key:"material",label:"ç´ æ",icon:Q},{key:"threeD",label:"3D",icon:gt}].map(r=>{const v=r.icon;return e.jsxs("button",{"code-path":"src/components/panels/ShotDetailPanel.tsx:89:17",onClick:()=>n(r.key),className:`flex-1 py-1.5 px-2 rounded text-xs flex items-center justify-center gap-1 transition-colors ${s===r.key?"bg-primary text-primary-foreground":"bg-elevated text-text-secondary hover:bg-white/5"}`,children:[e.jsx(v,{"code-path":"src/components/panels/ShotDetailPanel.tsx:98:19",size:12}),r.label]},r.key)})}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:104:11",className:"flex gap-2",children:[e.jsx("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:105:13",className:"w-16 h-16 rounded-lg bg-elevated flex items-center justify-center border border-dashed border-border cursor-pointer hover:bg-white/5 transition-colors",children:e.jsx("span",{"code-path":"src/components/panels/ShotDetailPanel.tsx:106:15",className:"text-2xl",children:"ðŸ‘¤"})}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:108:13",className:"w-16 h-16 rounded-lg bg-elevated flex flex-col items-center justify-center border border-dashed border-border cursor-pointer hover:bg-white/5 transition-colors",children:[e.jsx(vt,{"code-path":"src/components/panels/ShotDetailPanel.tsx:109:15",size:16,className:"text-text-tertiary"}),e.jsx("span",{"code-path":"src/components/panels/ShotDetailPanel.tsx:110:15",className:"text-[10px] sm:text-xs text-text-tertiary mt-1",children:"ä¸Šä¼ "})]}),e.jsx("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:112:13",className:"w-16 h-16 rounded-lg bg-elevated flex flex-col items-center justify-center border border-dashed border-border cursor-pointer hover:bg-white/5 transition-colors",children:e.jsx("span",{"code-path":"src/components/panels/ShotDetailPanel.tsx:113:15",className:"text-xl",children:"âœï¸"})})]})]}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:118:9",children:[e.jsx("h4",{"code-path":"src/components/panels/ShotDetailPanel.tsx:119:11",className:"text-xs font-medium mb-2 text-text-tertiary uppercase tracking-wider",children:"åˆ†é•œè¯¦æƒ…"}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:122:11",className:"space-y-3",children:[e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:123:13",children:[e.jsx("label",{"code-path":"src/components/panels/ShotDetailPanel.tsx:124:15",className:"text-xs block mb-1 text-text-secondary",children:"æ™¯åˆ«"}),e.jsxs("select",{"code-path":"src/components/panels/ShotDetailPanel.tsx:127:15",className:"w-full px-3 py-2 rounded-lg bg-elevated border border-border text-sm text-text-primary",defaultValue:"extreme_long_shot",children:[e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:131:17",value:"extreme_long_shot",children:"å¤§è¿œæ™¯(Extreme Long Shot)"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:132:17",value:"long_shot",children:"è¿œæ™¯(Long Shot)"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:133:17",value:"medium_shot",children:"ä¸­æ™¯(Medium Shot)"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:134:17",value:"close_up",children:"ç‰¹å†™(Close-up)"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:135:17",value:"extreme_close_up",children:"æžç‰¹å†™(Extreme Close-up)"})]})]}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:138:13",children:[e.jsx("label",{"code-path":"src/components/panels/ShotDetailPanel.tsx:139:15",className:"text-xs block mb-1 text-text-secondary",children:"ç”»é¢å†…å®¹"}),e.jsx("textarea",{"code-path":"src/components/panels/ShotDetailPanel.tsx:142:15",className:"w-full px-3 py-2 rounded-lg bg-elevated border border-border text-sm text-text-primary resize-none",rows:2,placeholder:"æè¿°ç”»é¢å†…å®¹...",defaultValue:"å·¨åž‹æ¶²åŽ‹é—¨åžå™¬æž—æ©"})]}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:149:13",children:[e.jsx("label",{"code-path":"src/components/panels/ShotDetailPanel.tsx:150:15",className:"text-xs block mb-1 text-text-secondary",children:"è§’è‰²å¯¹ç™½"}),e.jsx("input",{"code-path":"src/components/panels/ShotDetailPanel.tsx:153:15",type:"text",className:"w-full px-3 py-2 rounded-lg bg-elevated border border-border text-sm text-text-primary",placeholder:"è¾“å…¥å¯¹ç™½..."})]}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:159:13",children:[e.jsx("label",{"code-path":"src/components/panels/ShotDetailPanel.tsx:160:15",className:"text-xs block mb-1 text-text-secondary",children:"çŽ¯å¢ƒéŸ³"}),e.jsx("input",{"code-path":"src/components/panels/ShotDetailPanel.tsx:163:15",type:"text",className:"w-full px-3 py-2 rounded-lg bg-elevated border border-border text-sm text-text-primary",placeholder:"æè¿°çŽ¯å¢ƒéŸ³...",defaultValue:"(çŽ¯å¢ƒéŸ³)ï¼šæ²‰é—·çš„æ¶²åŽ‹è½°é¸£ï¼Œé‡‘å±žå°–å•¸"})]})]})]}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:173:9",children:[e.jsx("h4",{"code-path":"src/components/panels/ShotDetailPanel.tsx:174:11",className:"text-xs font-medium mb-2 text-text-tertiary uppercase tracking-wider",children:"ç”Ÿå›¾å‚æ•°"}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:177:11",className:"space-y-3",children:[e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:178:13",className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:179:15",children:[e.jsx("label",{"code-path":"src/components/panels/ShotDetailPanel.tsx:180:17",className:"text-xs block mb-1 text-text-secondary",children:"åˆ†è¾¨çŽ‡"}),e.jsxs("select",{"code-path":"src/components/panels/ShotDetailPanel.tsx:183:17",className:"w-full px-3 py-2 rounded-lg bg-elevated border border-border text-sm text-text-primary",children:[e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:184:19",value:"2K",children:"2Ké«˜æ¸…"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:185:19",value:"4K",children:"4Kè¶…æ¸…"})]})]}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:188:15",children:[e.jsx("label",{"code-path":"src/components/panels/ShotDetailPanel.tsx:189:17",className:"text-xs block mb-1 text-text-secondary",children:"æ¯”ä¾‹"}),e.jsxs("select",{"code-path":"src/components/panels/ShotDetailPanel.tsx:192:17",className:"w-full px-3 py-2 rounded-lg bg-elevated border border-border text-sm text-text-primary",children:[e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:193:19",value:"16:9",children:"16:9"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:194:19",value:"9:16",children:"9:16"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:195:19",value:"1:1",children:"1:1"})]})]})]}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:199:13",children:[e.jsx("label",{"code-path":"src/components/panels/ShotDetailPanel.tsx:200:15",className:"text-xs block mb-1 text-text-secondary",children:"ç”»é£Žé£Žæ ¼"}),e.jsxs("select",{"code-path":"src/components/panels/ShotDetailPanel.tsx:203:15",className:"w-full px-3 py-2 rounded-lg bg-elevated border border-border text-sm text-text-primary",children:[e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:204:17",value:"chinese_3d",children:"å›½é£Ž3D"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:205:17",value:"cinematic_realistic",children:"å½±è§†å†™å®ž"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:206:17",value:"classic_film",children:"ç»å…¸èƒ¶ç‰‡"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:207:17",value:"modern_bright",children:"çŽ°ä»£é«˜äº®"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:208:17",value:"epic_blockbuster",children:"å²è¯—å¤§ç‰‡"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:209:17",value:"3d_toys",children:"3Dæ½®çŽ©"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:210:17",value:"ink_wash",children:"æ°´å¢¨å›½é£Ž"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:211:17",value:"hardcore_cg",children:"ç¡¬æ ¸CG"}),e.jsx("option",{"code-path":"src/components/panels/ShotDetailPanel.tsx:212:17",value:"refined_anime",children:"ç²¾è‡´æ—¥æ¼«"})]})]})]})]}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:218:9",children:[e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:219:11",className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{"code-path":"src/components/panels/ShotDetailPanel.tsx:220:13",className:"text-xs font-medium text-text-tertiary uppercase tracking-wider",children:"AIæç¤ºè¯ (VISUAL PROMPT)"}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:223:13",className:"flex items-center gap-1",children:[e.jsx("button",{"code-path":"src/components/panels/ShotDetailPanel.tsx:224:15",className:"p-1 hover:bg-white/5 rounded text-text-tertiary",children:e.jsx(yt,{"code-path":"src/components/panels/ShotDetailPanel.tsx:225:17",size:14})}),e.jsx("button",{"code-path":"src/components/panels/ShotDetailPanel.tsx:227:15",className:"p-1 hover:bg-white/5 rounded text-text-tertiary",children:e.jsx(He,{"code-path":"src/components/panels/ShotDetailPanel.tsx:228:17",size:14})})]})]}),e.jsx("textarea",{"code-path":"src/components/panels/ShotDetailPanel.tsx:232:11",className:"w-full px-3 py-2 rounded-lg bg-elevated border border-border text-sm text-text-primary resize-none",rows:6,placeholder:"è¾“å…¥AIç”Ÿæˆå›¾åƒçš„è¯¦ç»†æç¤ºè¯...",defaultValue:`æžä½Žè§’åº¦ä»°æ‹ (Worm's Eye View) | ç¼“æ…¢æŽ¨é•œå¤´ (Slow Push In)

ä¸€ä¸ªå·¨å¤§çš„ã€ä¸‰å±‚æ¥¼é«˜çš„æ¶²åŽ‹é‡‘å±žé—¨æ­£åœ¨å…³é—­ï¼Œåžå™¬äº†ç”»é¢ä¸­å¤®æ¸ºå°çš„æž—æ©èº«å½±ã€‚ç”»é¢é‡‡ç”¨æžä½Žè§’åº¦ä»°æ‹ï¼Œé‡‘å±žé—¨åœ¨é€è§†ä¸‹æ˜¾å¾—æ— æ¯”å·¨å¤§ï¼Œå……æ»¡åŽ‹è¿«æ„Ÿã€‚é—¨ä¸Šå¸ƒæ»¡äº†æ²¹æ±¡å’Œåˆ’ç—•ï¼Œå‘¨å›´çš„æ··å‡åœŸå¢™å£ä¸ŠåµŒç€å·¥ä¸šé£Žæ ¼çš„é“†é’‰ã€‚è’¸æ±½ä»Žé—¨çš„ç¼éš™ä¸­å–·å‡ºï¼Œè¥é€ å‡ºä¸€ç§é—·çƒ­ã€åŽ‹æŠ‘çš„æ°›å›´ã€‚æž—æ©ç©¿ç€é»‘è‰²é£Žè¡£çš„å‰ªå½±åœ¨é—¨æ¡†ä¸­æ˜¾å¾—æ ¼å¤–æ¸ºå°ã€‚ç”»é¢è‰²è°ƒåå‘å†·ç°å’Œé”ˆçº¢è‰²ï¼Œå¼ºè°ƒå·¥ä¸šæœ«ä¸–æ„Ÿã€‚èµ›åšæœ‹å…‹é£Žæ ¼ï¼Œç”µå½±çº§å…‰å½±ã€‚`})]}),e.jsxs("div",{"code-path":"src/components/panels/ShotDetailPanel.tsx:242:9",className:"flex gap-2",children:[e.jsx(R,{"code-path":"src/components/panels/ShotDetailPanel.tsx:243:11",className:"flex-1 btn-primary text-sm",children:"ç”Ÿå›¾"}),e.jsx(R,{"code-path":"src/components/panels/ShotDetailPanel.tsx:244:11",variant:"outline",className:"flex-1 border-border text-sm",children:"è°ƒè‰²"})]})]})]})}function Xt(){const{rightPanelVisible:t,rightPanelMode:a,selectedNodeId:o,closeRightPanel:s}=Y(),{shotNodes:n}=ke(),[l,d]=c.useState("script"),r=o?n.find(i=>i.shotId===o):null,v=[{id:"script",label:"å‰§æœ¬",icon:jt},{id:"storyboard",label:"åˆ†é•œ",icon:Ke},{id:"card",label:"å¡ç‰‡",icon:Ue}];return e.jsx(we,{"code-path":"src/components/panels/RightPanel.tsx:26:5",children:t&&e.jsx(le.div,{"code-path":"src/components/panels/RightPanel.tsx:28:9",initial:{x:100,opacity:0},animate:{x:0,opacity:1},exit:{x:100,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"fixed right-4 z-40 w-[340px] max-w-[calc(100vw-32px)] hidden sm:block",style:{top:"72px",bottom:"80px"},children:e.jsxs("div",{"code-path":"src/components/panels/RightPanel.tsx:39:11",className:"h-full flex flex-col rounded-2xl bg-surface/95 backdrop-blur-md border border-border shadow-2xl overflow-hidden",children:[e.jsxs("div",{"code-path":"src/components/panels/RightPanel.tsx:40:13",className:"flex items-center justify-between px-4 py-3 border-b border-border/50",children:[e.jsxs("div",{"code-path":"src/components/panels/RightPanel.tsx:41:15",className:"flex items-center gap-2",children:[e.jsx("span",{"code-path":"src/components/panels/RightPanel.tsx:42:17",className:"w-2 h-2 rounded-full bg-primary"}),e.jsx("h3",{"code-path":"src/components/panels/RightPanel.tsx:43:17",className:"font-medium text-text-primary text-sm",children:a==="director"?"Ep.1 å¯¼æ¼”å°":r?`é•œå¤´ #${r.shotNumber}`:"èŠ‚ç‚¹ç¼–è¾‘"})]}),e.jsx("button",{"code-path":"src/components/panels/RightPanel.tsx:51:15",onClick:s,className:"p-1.5 rounded-lg hover:bg-white/10 transition-colors text-text-tertiary hover:text-text-primary",children:e.jsx(F,{"code-path":"src/components/panels/RightPanel.tsx:55:17",size:16})})]}),a==="director"&&e.jsx("div",{"code-path":"src/components/panels/RightPanel.tsx:60:15",className:"flex border-b border-border/50",children:v.map(i=>{const x=i.icon,m=l===i.id;return e.jsxs("button",{"code-path":"src/components/panels/RightPanel.tsx:65:21",onClick:()=>d(i.id),className:`
                        flex-1 flex items-center justify-center gap-1.5 py-2.5 text-xs font-medium
                        transition-all duration-200
                        ${m?"bg-primary text-primary-foreground":"text-text-secondary hover:text-text-primary hover:bg-white/5"}
                      `,children:[e.jsx(x,{"code-path":"src/components/panels/RightPanel.tsx:76:23",size:14}),i.label]},i.id)})}),e.jsxs("div",{"code-path":"src/components/panels/RightPanel.tsx:84:13",className:"flex-1 overflow-hidden",children:[a==="director"&&e.jsx(Ft,{"code-path":"src/components/panels/RightPanel.tsx:85:49",activeTab:l}),a==="node-edit"&&r&&e.jsx(Wt,{"code-path":"src/components/panels/RightPanel.tsx:86:66",shot:r})]})]})})})}const Yt=({node:t,isSelected:a,onSelect:o,onDragEnd:s,onContextMenu:n,onDoubleClick:l})=>{const d=ze[t.status]||ze.pending,r=i=>{i.stopPropagation();const x=i.ctrlKey||i.metaKey||i.shiftKey;o(t.shotId,x)},v=i=>{i.stopPropagation(),l?.(t.shotId)};return e.jsxs("div",{"code-path":"src/components/canvas/ShotNode.tsx:45:5",className:`
        absolute flex flex-col
        w-[100px] sm:w-[120px] h-[70px] sm:h-[80px] p-1 sm:p-1.5
        bg-surface backdrop-blur-sm
        rounded-lg shadow-lg
        transition-transform duration-200
        hover:scale-[1.02] hover:shadow-xl
        cursor-pointer
        group
        ${a?"border-2 border-primary z-50":"border border-border hover:border-primary/50 z-10"}
      `,style:{left:t.position.x,top:t.position.y},onMouseDown:r,onContextMenu:i=>n(i,t.shotId),onDoubleClick:v,onMouseUp:()=>{s(t.shotId,{x:t.position.x,y:t.position.y})},role:"button","aria-label":`Shot ${t.shotNumber}: ${t.title}`,tabIndex:0,children:[e.jsx("div",{"code-path":"src/components/canvas/ShotNode.tsx:76:7",className:"flex items-center justify-between px-0.5 sm:px-1 mb-0.5",children:e.jsx("span",{"code-path":"src/components/canvas/ShotNode.tsx:77:9",className:"text-xs sm:text-sm font-bold text-text-primary leading-none",children:t.shotNumber})}),e.jsxs("div",{"code-path":"src/components/canvas/ShotNode.tsx:83:7",className:"flex-1 flex flex-col items-center min-h-0 relative",children:[e.jsx("div",{"code-path":"src/components/canvas/ShotNode.tsx:85:9",className:"w-full text-[10px] sm:text-xs leading-tight text-text-secondary line-clamp-2 text-center select-none mb-0.5 sm:mb-1",children:t.title}),(t.thumbnailUrl||t.imageUrl)&&e.jsx("div",{"code-path":"src/components/canvas/ShotNode.tsx:90:11",className:"w-[50px] sm:w-[60px] h-[32px] sm:h-[40px] flex-shrink-0 rounded-sm overflow-hidden bg-elevated",children:e.jsx("img",{"code-path":"src/components/canvas/ShotNode.tsx:91:14",src:t.thumbnailUrl||t.imageUrl,alt:t.title,className:"w-full h-full object-cover opacity-90 group-hover:opacity-100 transition-opacity",draggable:!1})})]}),e.jsx("div",{"code-path":"src/components/canvas/ShotNode.tsx:101:7",className:"absolute bottom-0 left-0 right-0 h-1 rounded-b-lg overflow-hidden z-0",children:e.jsx("div",{"code-path":"src/components/canvas/ShotNode.tsx:104:11",className:"w-full h-full opacity-80",style:{backgroundColor:d}})})]})},qt=c.memo(Yt),Zt={pending:"bg-status-gray",processing:"bg-status-blue",completed:"bg-status-green",approved:"bg-status-cyan",revision:"bg-status-yellow"};function Jt({masterNode:t,childNodes:a,isExpanded:o,isSelected:s,onExpandToggle:n,onSelect:l,onChildSelect:d,onDragStart:r,onChildReorder:v,onContextMenu:i}){const x={position:"absolute",left:t.position.x,top:t.position.y,width:o?"min(650px, 90vw)":"100px",height:o?"min(520px, 70vh)":"auto",minHeight:o?"auto":"70px",zIndex:o?50:10,transition:"width 0.3s ease, height 0.3s ease, background-color 0.3s"},m=g=>{g.stopPropagation(),l(t.shotId,g.shiftKey||g.metaKey)},u=g=>{g.stopPropagation()},N=({shot:g,index:h})=>e.jsxs("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:71:7",className:`relative flex flex-col items-center justify-center w-full h-full
                   bg-surface rounded border border-border hover:border-primary/50
                   cursor-pointer group overflow-hidden transition-colors`,onClick:y=>{y.stopPropagation(),d(g.shotId)},draggable:!0,onDragStart:y=>{y.stopPropagation(),y.dataTransfer.setData("application/json",JSON.stringify({type:"shot-reorder",shotId:g.shotId,sceneId:t.sceneId}))},children:[g.thumbnailUrl?e.jsx("img",{"code-path":"src/components/canvas/SceneMasterNode.tsx:92:11",src:g.thumbnailUrl,alt:g.title,className:"absolute inset-0 w-full h-full object-cover opacity-50 group-hover:opacity-70 transition-opacity",draggable:!1}):e.jsx("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:99:11",className:"absolute inset-0 flex items-center justify-center text-text-tertiary",children:e.jsx(Q,{"code-path":"src/components/canvas/SceneMasterNode.tsx:100:13",size:24})}),e.jsxs("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:105:9",className:"relative z-10 flex flex-col items-center gap-1",children:[e.jsxs("span",{"code-path":"src/components/canvas/SceneMasterNode.tsx:106:11",className:"text-xs font-bold text-text-primary drop-shadow-md",children:["#",g.shotNumber]}),e.jsx("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:109:11",className:`w-2 h-2 rounded-full ${Zt[g.status]} shadow-sm`})]})]});return e.jsxs("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:116:5",style:x,className:`
        rounded-xl backdrop-blur select-none flex flex-col overflow-hidden
        ${o?"bg-surface border-2 border-primary shadow-2xl":"bg-elevated border-2 border-dashed border-primary/50 hover:border-primary"}
        ${s&&!o?"ring-2 ring-primary ring-offset-2 ring-offset-background":""}
      `,onMouseDown:m,onContextMenu:g=>i(g,t.shotId),onDoubleClick:g=>{g.stopPropagation(),n()},draggable:!o,onDragStart:g=>!o&&r(t.shotId,g),children:[e.jsxs("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:136:7",className:`flex items-center justify-between px-2 sm:px-3 py-2 w-full min-h-[60px] sm:min-h-[70px] ${o?"h-auto border-b border-border":""}`,children:[e.jsxs("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:139:9",className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:140:11",className:"flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 rounded-lg bg-primary/10 text-primary",children:e.jsx(Ke,{"code-path":"src/components/canvas/SceneMasterNode.tsx:141:13",size:16,className:"sm:w-5 sm:h-5"})}),e.jsxs("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:144:11",className:"flex flex-col min-w-0",children:[e.jsxs("span",{"code-path":"src/components/canvas/SceneMasterNode.tsx:145:13",className:"text-xs sm:text-sm font-bold text-text-primary truncate max-w-[60px] sm:max-w-[80px]",children:["Scene ",t.shotNumber]}),e.jsxs("span",{"code-path":"src/components/canvas/SceneMasterNode.tsx:148:14",className:"text-[10px] sm:text-xs text-text-secondary font-medium",children:[a.length," shots"]})]})]}),o&&e.jsx("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:156:11",className:"flex items-center gap-1",onMouseDown:u,children:e.jsx("button",{"code-path":"src/components/canvas/SceneMasterNode.tsx:157:14",onClick:g=>{g.stopPropagation(),n()},className:"p-1.5 hover:bg-elevated rounded-md text-text-secondary hover:text-text-primary transition-colors",children:e.jsx(F,{"code-path":"src/components/canvas/SceneMasterNode.tsx:164:15",size:18})})})]}),o&&e.jsx("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:172:9",className:"flex-1 p-4 overflow-y-auto overflow-x-hidden",onMouseDown:u,children:e.jsx("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:176:11",className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-2",style:{minHeight:"min(400px, 50vh)"},children:Array.from({length:25}).map((g,h)=>{const y=a[h];return e.jsx("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:184:17",className:"w-full aspect-[3/2]",children:y?e.jsx(N,{"code-path":"src/components/canvas/SceneMasterNode.tsx:189:21",shot:y,index:h}):e.jsx("div",{"code-path":"src/components/canvas/SceneMasterNode.tsx:192:22",className:"w-full h-full rounded border border-border/50 bg-elevated/50"})},y?y.shotId:`empty-${h}`)})})})]})}function Qt({x:t,y:a,onClose:o,onCreateCard:s,onInsertImage:n,onAutoArrange:l,onResetView:d}){const r=[{id:"newNode",label:"æ–°å»ºèŠ‚ç‚¹",icon:se,action:s,shortcut:"N"},{id:"insertImage",label:"æ’å…¥æœ¬åœ°å›¾ç‰‡",icon:Q,action:n},{id:"divider1",label:"",icon:se,action:()=>{}},{id:"autoArrange",label:"è‡ªåŠ¨æ•´ç†",icon:Ue,action:l},{id:"resetView",label:"è§†è§’å¤ä½",icon:Nt,action:d,shortcut:"0"}],v={position:"fixed",left:Math.min(t,window.innerWidth-200),top:Math.min(a,window.innerHeight-200),zIndex:1e3};return e.jsxs(e.Fragment,{children:[e.jsx("div",{"code-path":"src/components/canvas/CanvasContextMenu.tsx:54:7",className:"fixed inset-0 z-[999]",onClick:o}),e.jsx("div",{"code-path":"src/components/canvas/CanvasContextMenu.tsx:58:7",className:"rounded-lg py-1 shadow-xl overflow-hidden bg-white border border-gray-300",style:{...v,minWidth:"180px"},children:r.map(i=>{if(i.id.startsWith("divider"))return e.jsx("div",{"code-path":"src/components/canvas/CanvasContextMenu.tsx:68:15",className:"my-1 border-t border-gray-300"},i.id);const x=i.icon;return e.jsxs("button",{"code-path":"src/components/canvas/CanvasContextMenu.tsx:77:13",onClick:m=>{m.stopPropagation(),i.action()},className:"w-full px-3 py-2 text-left text-sm flex items-center justify-between hover:bg-white/5 transition-colors text-gray-900",children:[e.jsxs("div",{"code-path":"src/components/canvas/CanvasContextMenu.tsx:85:15",className:"flex items-center gap-2",children:[e.jsx(x,{"code-path":"src/components/canvas/CanvasContextMenu.tsx:86:17",size:14}),i.label]}),i.shortcut&&e.jsx("span",{"code-path":"src/components/canvas/CanvasContextMenu.tsx:90:17",className:"text-xs px-1.5 py-0.5 rounded bg-gray-950 text-gray-500",children:i.shortcut})]},i.id)})})]})}function es({connections:t,nodes:a,getNodePosition:o,onConnectionClick:s,isConnecting:n,connectionSource:l,mousePosition:d}){const r=c.useRef(null),i=(()=>{if(!l)return null;const u=a.find(g=>g.shotId===l);if(!u)return null;const N=o(u);return{x:N.x+60,y:N.y+40}})(),x=(u,N)=>{const g=N.x-u.x,h=Math.min(Math.abs(g)*.5,100);return`M ${u.x} ${u.y} 
            C ${u.x+h} ${u.y},
              ${N.x-h} ${N.y},
              ${N.x} ${N.y}`},m=u=>{const N=a.find(S=>S.shotId===u.source),g=a.find(S=>S.shotId===u.target);if(!N||!g)return null;const h=o(N),y=o(g),b={x:h.x+120,y:h.y+40},p={x:y.x,y:y.y+40};return{from:b,to:p}};return e.jsxs("svg",{"code-path":"src/components/canvas/ConnectionLines.tsx:74:5",ref:r,className:"absolute inset-0 pointer-events-none",style:{width:"100%",height:"100%",overflow:"visible"},children:[e.jsxs("defs",{"code-path":"src/components/canvas/ConnectionLines.tsx:83:7",children:[e.jsx("marker",{"code-path":"src/components/canvas/ConnectionLines.tsx:84:9",id:"arrowhead",markerWidth:"12",markerHeight:"8",refX:"10",refY:"4",orient:"auto",children:e.jsx("polygon",{"code-path":"src/components/canvas/ConnectionLines.tsx:92:11",points:"0 0, 12 4, 0 8",fill:"hsl(var(--primary))"})}),e.jsxs("linearGradient",{"code-path":"src/components/canvas/ConnectionLines.tsx:95:9",id:"flowGradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[e.jsx("stop",{"code-path":"src/components/canvas/ConnectionLines.tsx:96:11",offset:"0%",stopColor:"hsl(var(--primary))",stopOpacity:"0.3"}),e.jsx("stop",{"code-path":"src/components/canvas/ConnectionLines.tsx:97:11",offset:"50%",stopColor:"hsl(var(--primary))",stopOpacity:"1"}),e.jsx("stop",{"code-path":"src/components/canvas/ConnectionLines.tsx:98:11",offset:"100%",stopColor:"hsl(var(--primary))",stopOpacity:"0.3"})]}),e.jsx("style",{"code-path":"src/components/canvas/ConnectionLines.tsx:101:9",children:`
          @keyframes flow {
            0% { stroke-dashoffset: 20; }
            100% { stroke-dashoffset: 0; }
          }
          .flow-line {
            stroke-dasharray: 5 5;
            animation: flow 0.5s linear infinite;
          }
        `})]}),t.map(u=>{const N=m(u);if(!N)return null;const g=x(N.from,N.to);return e.jsxs("g",{"code-path":"src/components/canvas/ConnectionLines.tsx:120:11",className:"pointer-events-auto",children:[e.jsx("path",{"code-path":"src/components/canvas/ConnectionLines.tsx:121:13",d:g,stroke:"transparent",strokeWidth:"20",fill:"none",className:"cursor-pointer",onClick:h=>s?.(u.id,h)}),e.jsx("path",{"code-path":"src/components/canvas/ConnectionLines.tsx:129:13",d:g,stroke:"hsl(var(--primary))",strokeWidth:"2",fill:"none",markerEnd:"url(#arrowhead)",className:"flow-line"}),e.jsx("path",{"code-path":"src/components/canvas/ConnectionLines.tsx:137:13",d:g,stroke:"hsl(var(--primary))",strokeWidth:"6",fill:"none",opacity:"0.2",pointerEvents:"none"})]},u.id)}),n&&i&&d&&e.jsxs("g",{"code-path":"src/components/canvas/ConnectionLines.tsx:150:9",pointerEvents:"none",children:[e.jsx("path",{"code-path":"src/components/canvas/ConnectionLines.tsx:151:11",d:x(i,d),stroke:"hsl(var(--primary))",strokeWidth:"2",fill:"none",strokeDasharray:"5 5",opacity:"0.8"}),e.jsxs("circle",{"code-path":"src/components/canvas/ConnectionLines.tsx:159:11",cx:i.x,cy:i.y,r:"8",fill:"hsl(var(--primary))",opacity:"0.5",children:[e.jsx("animate",{"code-path":"src/components/canvas/ConnectionLines.tsx:166:13",attributeName:"r",values:"8;14;8",dur:"1s",repeatCount:"indefinite"}),e.jsx("animate",{"code-path":"src/components/canvas/ConnectionLines.tsx:172:13",attributeName:"opacity",values:"0.5;0.2;0.5",dur:"1s",repeatCount:"indefinite"})]}),e.jsx("circle",{"code-path":"src/components/canvas/ConnectionLines.tsx:179:11",cx:i.x,cy:i.y,r:"5",fill:"hsl(var(--primary))"}),e.jsx("circle",{"code-path":"src/components/canvas/ConnectionLines.tsx:185:11",cx:d.x,cy:d.y,r:"4",fill:"hsl(var(--primary))",opacity:"0.8"})]})]})}function ts({episodeId:t,onNodeSelect:a}){const o=c.useRef(null),[s,n]=c.useState(null),[l,d]=c.useState(new Set),[r,v]=c.useState(!1),{zoom:i,offset:x,gridVisible:m,setZoom:u,setOffset:N,selectedNodeIds:g,selectNode:h,deselectAll:y,isConnecting:b,connectionSource:p,endConnection:S,setMousePosition:w,isPanning:P,setIsPanning:D}=Le(),{shotNodes:j,connections:k,addConnection:z,deleteConnection:_,moveShotNode:L,loadEpisodeCanvas:C,clearEpisodeCanvas:K}=ke(),{addToast:E,openNodeEditPanel:H,closeRightPanel:T}=Y(),$=Le(f=>f.mousePosition);c.useEffect(()=>{if(!t||t==="ep1"){K();return}(async()=>{v(!0);try{const B=((await Tt.listShots(t)).data||[]).map(A=>({shotId:A.shotId,episodeId:A.episodeId,sceneId:A.sceneId||void 0,nodeType:A.nodeType,shotNumber:A.shotNumber,title:A.title,subtitle:A.subtitle||void 0,status:A.status,position:{x:A.positionX||0,y:A.positionY||0},thumbnailUrl:A.thumbnailUrl||void 0,imageUrl:A.imageUrl||void 0,details:A.details||void 0}));C({episodeId:t,viewport:{x:0,y:0,zoom:1},nodes:B,connections:[]}),E({type:"success",message:`å·²åŠ è½½ ${B.length} ä¸ªåˆ†é•œ`})}catch(M){console.error("Failed to load shots:",M),E({type:"error",message:"åŠ è½½åˆ†é•œå¤±è´¥"})}finally{v(!1)}})()},[t,C,K,E]);const[V,W]=c.useState({x:0,y:0});c.useEffect(()=>{const f=o.current;if(!f)return;const M=I=>{if(I.ctrlKey||I.metaKey){I.preventDefault();const B=I.deltaY>0?.9:1.1;u(i*B)}};return f.addEventListener("wheel",M,{passive:!1}),()=>{f.removeEventListener("wheel",M)}},[u]);const oe=c.useCallback(f=>{f.button===1||f.button===0&&f.shiftKey?(D(!0),W({x:f.clientX-x.x,y:f.clientY-x.y}),f.preventDefault()):f.button===0&&f.target===o.current&&(y(),T(),n(null))},[x,y,D,T]),fe=c.useCallback(f=>{const M=o.current?.getBoundingClientRect();M&&w({x:(f.clientX-M.left-x.x)/i,y:(f.clientY-M.top-x.y)/i}),P&&N({x:f.clientX-V.x,y:f.clientY-V.y})},[P,V,x,i,N,w]),ne=c.useCallback(()=>{D(!1)},[D]),te=(f,M)=>{if(b&&p&&p!==f){const I={id:`conn_${Date.now()}`,source:p,target:f,type:"sequence"};z(I),E({type:"success",message:"Connection created"}),S()}else{h(f,M);const I=j.find(B=>B.shotId===f);I&&(a?.(I),H(f))}},re=(f,M)=>{f.preventDefault(),f.stopPropagation(),h(M),E({type:"info",message:`Context menu for node ${M}`})},be=f=>{f.preventDefault(),n({x:f.clientX,y:f.clientY})},ge=f=>{},ve=(f,M)=>{L(f,M)},ye=(f,M)=>{M.stopPropagation(),confirm("Delete this connection?")&&(_(f),E({type:"success",message:"Connection deleted"}))},O=f=>{d(M=>{const I=new Set(M);return I.has(f)?I.delete(f):I.add(f),I})};return c.useEffect(()=>{const f=M=>{M.key==="Delete"||M.key,M.key==="Escape"&&(b&&(S(),E({type:"info",message:"Connection cancelled"})),y(),T(),n(null)),M.key==="0"&&(M.ctrlKey||M.metaKey)&&(M.preventDefault(),u(1),N({x:0,y:0}),E({type:"info",message:"View reset"}))};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[b,y,S,u,N,E]),r?e.jsx("div",{"code-path":"src/components/canvas/StoryboardCanvas.tsx:255:7",className:"flex-1 relative overflow-hidden bg-background flex items-center justify-center",children:e.jsx("div",{"code-path":"src/components/canvas/StoryboardCanvas.tsx:256:9",className:"text-text-secondary",children:"åŠ è½½åˆ†é•œä¸­..."})}):e.jsxs("div",{"code-path":"src/components/canvas/StoryboardCanvas.tsx:262:5",ref:o,className:`flex-1 relative overflow-hidden bg-background ${m?"canvas-grid":""}`,style:{cursor:P?"grabbing":b?"crosshair":"default"},onMouseDown:oe,onMouseMove:fe,onMouseUp:ne,onMouseLeave:ne,onContextMenu:be,onClick:()=>n(null),children:[e.jsxs("div",{"code-path":"src/components/canvas/StoryboardCanvas.tsx:275:7",className:"absolute inset-0",style:{transform:`translate(${x.x}px, ${x.y}px) scale(${i})`,transformOrigin:"0 0",transition:P?"none":"transform 0.1s ease-out"},children:[e.jsx(es,{"code-path":"src/components/canvas/StoryboardCanvas.tsx:283:9",connections:k,nodes:j,getNodePosition:f=>f.position,onConnectionClick:ye,isConnecting:b,connectionSource:p,mousePosition:$}),j.map(f=>{if(f.nodeType==="scene_master"){const M=j.filter(I=>I.sceneId===f.sceneId&&I.nodeType==="shot");return e.jsx(Jt,{"code-path":"src/components/canvas/StoryboardCanvas.tsx:298:15",masterNode:f,childNodes:M,isExpanded:l.has(f.sceneId||f.shotId),isSelected:g.includes(f.shotId),onExpandToggle:()=>O(f.sceneId||f.shotId),onSelect:te,onChildSelect:I=>te(I),onDragStart:I=>ge(),onChildReorder:()=>{},onContextMenu:re},f.shotId)}else return e.jsx(qt,{"code-path":"src/components/canvas/StoryboardCanvas.tsx:314:15",node:f,isSelected:g.includes(f.shotId),onSelect:te,onDragEnd:ve,onContextMenu:re,onDoubleClick:M=>{E({type:"info",message:`Double clicked ${M}`})}},f.shotId)})]}),e.jsxs("div",{"code-path":"src/components/canvas/StoryboardCanvas.tsx:330:7",className:"absolute bottom-20 left-4 flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1.5 sm:py-2 rounded-lg bg-surface/90 border border-border backdrop-blur-sm z-30",children:[e.jsx("button",{"code-path":"src/components/canvas/StoryboardCanvas.tsx:331:9",onClick:()=>u(i*.9),className:"w-6 h-6 sm:w-8 sm:h-8 flex items-center justify-center rounded hover:bg-primary/10 text-text-secondary",children:"-"}),e.jsxs("span",{"code-path":"src/components/canvas/StoryboardCanvas.tsx:337:9",className:"text-xs sm:text-sm w-12 sm:w-16 text-center text-text-primary font-medium font-mono",children:[Math.round(i*100),"%"]}),e.jsx("button",{"code-path":"src/components/canvas/StoryboardCanvas.tsx:340:9",onClick:()=>u(i*1.1),className:"w-6 h-6 sm:w-8 sm:h-8 flex items-center justify-center rounded hover:bg-primary/10 text-text-secondary",children:"+"}),e.jsx("div",{"code-path":"src/components/canvas/StoryboardCanvas.tsx:346:9",className:"w-px h-4 bg-border mx-1"}),e.jsx("button",{"code-path":"src/components/canvas/StoryboardCanvas.tsx:347:9",onClick:()=>{u(1),N({x:0,y:0})},className:"w-6 h-6 sm:w-8 sm:h-8 flex items-center justify-center rounded hover:bg-primary/10 ml-0.5 text-text-secondary",title:"Reset View",children:"âŒ‚"})]}),b&&e.jsxs("div",{"code-path":"src/components/canvas/StoryboardCanvas.tsx:357:9",className:"absolute top-4 left-1/2 -translate-x-1/2 px-4 py-2 rounded-lg flex items-center gap-2 bg-indigo-500 text-black",children:[e.jsx("span",{"code-path":"src/components/canvas/StoryboardCanvas.tsx:358:11",className:"animate-pulse",children:"â—"}),"Connection Mode: Click target node to connect, ESC to cancel"]}),s&&e.jsx(Qt,{"code-path":"src/components/canvas/StoryboardCanvas.tsx:364:9",x:s.x,y:s.y,onClose:()=>n(null),onCreateCard:()=>E({type:"info",message:"Create Node not implemented yet"}),onInsertImage:()=>E({type:"info",message:"Insert Image not implemented yet"}),onAutoArrange:()=>E({type:"info",message:"Auto Arrange not implemented yet"}),onResetView:()=>{u(1),N({x:0,y:0}),n(null)}})]})}function ss({isOpen:t,onClose:a}){const o=Y(p=>p.addToast),[s,n]=c.useState(!1),[l,d]=c.useState("cinematic_realistic"),[r,v]=c.useState("2K"),[i,x]=c.useState("16:9"),[m,u]=c.useState([{id:"1",cardNumber:11,prompt:"ä¿¯è§†é•œå¤´ï¼ŒåºŸåœŸä¸–ç•Œï¼Œä¸»è§’æž—æ©",status:"completed",progress:100},{id:"2",cardNumber:12,prompt:"æžç»†ç‰¹å†™ï¼Œé£Žæš´ä¸­å¿ƒï¼Œå¥‡å¼‚æžå…‰",status:"completed",progress:100},{id:"3",cardNumber:15,prompt:"å¾®è·é•œå¤´ï¼Œéª¨éª¼ç¢Žç‰‡ï¼Œæ²‰é‡æ°›å›´",status:"processing",progress:65},{id:"4",cardNumber:16,prompt:"è¿‡è‚©é•œå¤´ï¼Œä¼Šç”¸å›­è¿œæ™¯ï¼Œæ²™å°˜æš´",status:"pending",progress:0},{id:"5",cardNumber:17,prompt:"å…¨æ™¯é•œå¤´ï¼ŒåºŸå¢ŸåŸŽå¸‚ï¼Œé»„æ˜å…‰çº¿",status:"pending",progress:0}]),N=[{id:"cinematic_realistic",name:"å½±è§†å†™å®ž",desc:"Cinematic Realistic"},{id:"chinese_3d",name:"å›½é£Ž3D",desc:"Chinese 3D"},{id:"classic_film",name:"ç»å…¸èƒ¶ç‰‡",desc:"Classic Film"},{id:"modern_bright",name:"çŽ°ä»£é«˜äº®",desc:"Modern Bright"},{id:"epic_blockbuster",name:"å²è¯—å¤§ç‰‡",desc:"Epic Blockbuster"},{id:"ink_wash",name:"æ°´å¢¨å›½é£Ž",desc:"Ink Wash"}],g=()=>{n(!0),o({type:"info",message:"å¼€å§‹æ‰¹é‡ç”Ÿæˆå›¾ç‰‡..."});let p=0;const S=setInterval(()=>{u(P=>P.map((D,j)=>{if(j===p&&D.status==="pending")return{...D,status:"processing",progress:0};if(j===p&&D.status==="processing"){const k=D.progress+10;return k>=100?(p++,{...D,status:"completed",progress:100}):{...D,progress:k}}return D})),(m.every(P=>P.status==="completed")||p>=m.length)&&(clearInterval(S),n(!1),o({type:"success",message:"æ‰¹é‡ç”Ÿæˆå®Œæˆï¼"}))},500)},h=()=>{n(!1),o({type:"info",message:"å·²æš‚åœç”Ÿæˆ"})},[y,b]=c.useState("settings");return t?e.jsx("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:85:5",className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.8)"},onClick:a,children:e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:90:7",className:"w-full max-w-4xl h-[85vh] rounded-xl overflow-hidden flex flex-col bg-surface border border-border",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:95:9",className:"flex items-center justify-between px-4 py-3 border-b flex-shrink-0 border-border",children:[e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:96:11",className:"flex items-center gap-3",children:[e.jsx(Q,{"code-path":"src/components/modals/BatchGenerateModal.tsx:97:13",size:20,className:"text-primary"}),e.jsx("span",{"code-path":"src/components/modals/BatchGenerateModal.tsx:98:13",className:"font-semibold text-text-primary",children:"æ‰¹é‡ç”Ÿå›¾"}),e.jsxs("span",{"code-path":"src/components/modals/BatchGenerateModal.tsx:101:13",className:"text-xs px-2 py-0.5 rounded bg-elevated text-text-tertiary hidden sm:inline-block",children:[m.filter(p=>p.status==="completed").length,"/",m.length," å®Œæˆ"]})]}),e.jsx("button",{"code-path":"src/components/modals/BatchGenerateModal.tsx:105:11",onClick:a,className:"p-2 rounded-lg hover:bg-white/10 transition-colors text-text-secondary",children:e.jsx(F,{"code-path":"src/components/modals/BatchGenerateModal.tsx:109:13",size:20})})]}),e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:113:9",className:"flex sm:hidden border-b border-border",children:[e.jsx("button",{"code-path":"src/components/modals/BatchGenerateModal.tsx:114:11",className:`flex-1 py-2 text-sm font-medium ${y==="settings"?"text-primary border-b-2 border-primary":"text-text-secondary"}`,onClick:()=>b("settings"),children:"ç”Ÿæˆå‚æ•°"}),e.jsxs("button",{"code-path":"src/components/modals/BatchGenerateModal.tsx:120:11",className:`flex-1 py-2 text-sm font-medium ${y==="queue"?"text-primary border-b-2 border-primary":"text-text-secondary"}`,onClick:()=>b("queue"),children:["ç”Ÿæˆé˜Ÿåˆ— (",m.filter(p=>p.status==="completed").length,"/",m.length,")"]})]}),e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:129:9",className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:131:11",className:`
            w-full sm:w-72 flex-shrink-0 border-r border-border overflow-y-auto p-4
            ${y==="settings"?"block":"hidden sm:block"}
          `,children:[e.jsx("h3",{"code-path":"src/components/modals/BatchGenerateModal.tsx:135:13",className:"text-xs font-medium uppercase tracking-wider mb-4 text-text-tertiary hidden sm:block",children:"ç”Ÿæˆå‚æ•°"}),e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:140:13",className:"mb-4",children:[e.jsx("label",{"code-path":"src/components/modals/BatchGenerateModal.tsx:141:15",className:"text-xs block mb-2 text-gray-400",children:"ç”»é£Žé£Žæ ¼"}),e.jsx("select",{"code-path":"src/components/modals/BatchGenerateModal.tsx:144:15",value:l,onChange:p=>d(p.target.value),className:"w-full input text-sm",children:N.map(p=>e.jsxs("option",{"code-path":"src/components/modals/BatchGenerateModal.tsx:150:19",value:p.id,children:[p.name," (",p.desc,")"]},p.id))})]}),e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:158:13",className:"mb-4",children:[e.jsx("label",{"code-path":"src/components/modals/BatchGenerateModal.tsx:159:15",className:"text-xs block mb-2 text-gray-400",children:"åˆ†è¾¨çŽ‡"}),e.jsx("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:162:15",className:"flex gap-2",children:["2K","4K"].map(p=>e.jsxs("button",{"code-path":"src/components/modals/BatchGenerateModal.tsx:164:19",onClick:()=>v(p),className:`flex-1 py-2 px-3 rounded-lg text-sm transition-colors ${r===p?"bg-primary text-black":"border hover:bg-white/5 border-border"}`,children:[p,"é«˜æ¸…"]},p))})]}),e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:180:13",className:"mb-4",children:[e.jsx("label",{"code-path":"src/components/modals/BatchGenerateModal.tsx:181:15",className:"text-xs block mb-2 text-gray-400",children:"ç”»é¢æ¯”ä¾‹"}),e.jsx("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:184:15",className:"grid grid-cols-2 gap-2",children:["16:9","9:16","1:1","4:3"].map(p=>e.jsx("button",{"code-path":"src/components/modals/BatchGenerateModal.tsx:186:19",onClick:()=>x(p),className:`py-2 px-3 rounded-lg text-sm transition-colors ${i===p?"bg-primary text-black":"border hover:bg-white/5 border-border"}`,children:p},p))})]}),e.jsx("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:202:13",className:"mb-4",children:e.jsxs("button",{"code-path":"src/components/modals/BatchGenerateModal.tsx:203:15",className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx($e,{"code-path":"src/components/modals/BatchGenerateModal.tsx:204:17",size:14}),"é«˜çº§è®¾ç½®"]})}),e.jsx("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:210:13",className:"space-y-2",children:s?e.jsxs(R,{"code-path":"src/components/modals/BatchGenerateModal.tsx:223:17",className:"w-full flex items-center justify-center gap-2 bg-status-yellow text-black",onClick:h,children:[e.jsx(wt,{"code-path":"src/components/modals/BatchGenerateModal.tsx:227:19",size:16}),"æš‚åœç”Ÿæˆ"]}):e.jsxs(R,{"code-path":"src/components/modals/BatchGenerateModal.tsx:212:17",className:"w-full btn-primary flex items-center justify-center gap-2",onClick:()=>{g(),b("queue")},children:[e.jsx(St,{"code-path":"src/components/modals/BatchGenerateModal.tsx:219:19",size:16}),"å¼€å§‹ç”Ÿæˆ"]})})]}),e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:235:11",className:`
            flex-1 overflow-y-auto p-4
            ${y==="queue"?"block":"hidden sm:block"}
          `,children:[e.jsx("h3",{"code-path":"src/components/modals/BatchGenerateModal.tsx:239:13",className:"text-xs font-medium uppercase tracking-wider mb-4 text-gray-500 hidden sm:block",children:"ç”Ÿæˆé˜Ÿåˆ—"}),e.jsx("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:243:13",className:"space-y-3",children:m.map(p=>e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:245:17",className:"p-3 rounded-lg border bg-gray-900 border-border",children:[e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:249:19",className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:250:21",className:"flex items-center gap-2",children:[e.jsxs("span",{"code-path":"src/components/modals/BatchGenerateModal.tsx:251:23",className:"text-xs font-medium px-2 py-0.5 rounded bg-surface text-gray-100",children:["#",p.cardNumber]}),e.jsx("span",{"code-path":"src/components/modals/BatchGenerateModal.tsx:256:23",className:"text-sm text-gray-100 line-clamp-1",children:p.prompt})]}),e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:260:21",children:[p.status==="completed"&&e.jsx(Ct,{"code-path":"src/components/modals/BatchGenerateModal.tsx:262:25",size:18,className:"text-green-500"}),p.status==="processing"&&e.jsx(Fe,{"code-path":"src/components/modals/BatchGenerateModal.tsx:265:25",size:18,className:"animate-spin text-yellow-500"}),p.status==="pending"&&e.jsx("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:268:25",className:"w-4 h-4 rounded-full border-2 border-border"})]})]}),e.jsxs("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:274:19",className:"flex items-center gap-3",children:[e.jsx("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:275:21",className:"flex-1 h-2 rounded-full overflow-hidden bg-surface",children:e.jsx("div",{"code-path":"src/components/modals/BatchGenerateModal.tsx:276:23",className:"h-full rounded-full transition-all duration-300",style:{width:`${p.progress}%`,backgroundColor:p.status==="completed"?"#22c55e":p.status==="processing"?"#eab308":"#374151"}})}),e.jsxs("span",{"code-path":"src/components/modals/BatchGenerateModal.tsx:288:21",className:"text-xs w-10 text-right text-gray-500",children:[p.progress,"%"]})]})]},p.id))})]})]})]})}):null}function as({isOpen:t,onClose:a,imageUrl:o}){const s=c.useRef(null),[n,l]=c.useState("red"),[d,r]=c.useState(20),[v,i]=c.useState(!1),[x,m]=c.useState("");c.useEffect(()=>{if(t&&s.current&&o){const b=s.current,p=b.getContext("2d");if(p){const S=new Image;S.onload=()=>{b.width=S.width,b.height=S.height,p.drawImage(S,0,0)},S.src=o}}},[t,o]);const u=b=>{i(!0),h(b)},N=b=>{v&&h(b)},g=()=>{i(!1)},h=b=>{const p=s.current;if(!p)return;const S=p.getContext("2d");if(!S)return;const w=p.getBoundingClientRect(),P=(b.clientX-w.left)*(p.width/w.width),D=(b.clientY-w.top)*(p.height/w.height);S.beginPath(),S.arc(P,D,d,0,Math.PI*2),S.fillStyle=n==="red"?"rgba(255, 0, 0, 0.5)":n==="blue"?"rgba(0, 0, 255, 0.5)":"rgba(255, 255, 0, 0.5)",S.fill()},y=()=>{if(s.current&&o){const b=s.current,p=b.getContext("2d");if(p){const S=new Image;S.onload=()=>{p.clearRect(0,0,b.width,b.height),p.drawImage(S,0,0)},S.src=o}}};return e.jsx(pe,{"code-path":"src/components/modals/InpaintModal.tsx:85:5",open:t,onOpenChange:a,children:e.jsxs(me,{"code-path":"src/components/modals/InpaintModal.tsx:86:7",className:"max-w-4xl max-h-[90vh] overflow-y-auto bg-surface border border-border flex flex-col",children:[e.jsx(xe,{"code-path":"src/components/modals/InpaintModal.tsx:87:9",className:"flex-shrink-0",children:e.jsxs(he,{"code-path":"src/components/modals/InpaintModal.tsx:88:11",className:"flex items-center justify-between text-gray-100",children:["å±€éƒ¨é‡ç»˜ (Inpaint)",e.jsx("button",{"code-path":"src/components/modals/InpaintModal.tsx:90:13",onClick:a,className:"p-1 rounded hover:bg-white/10 transition-colors",children:e.jsx(F,{"code-path":"src/components/modals/InpaintModal.tsx:94:15",size:20,className:"text-gray-400"})})]})}),e.jsxs("div",{"code-path":"src/components/modals/InpaintModal.tsx:100:9",className:"flex flex-wrap items-center gap-2 p-2 rounded-lg mb-4 bg-gray-900 overflow-x-auto",children:[e.jsx("button",{"code-path":"src/components/modals/InpaintModal.tsx:101:11",onClick:()=>l("red"),className:`w-8 h-8 rounded flex items-center justify-center transition-colors shrink-0 ${n==="red"?"ring-2 ring-white":""}`,style:{backgroundColor:"#ff4444"},title:"çº¢è‰²ç”»ç¬” - æ ‡è®°é‡ç»˜åŒºåŸŸ"}),e.jsx("button",{"code-path":"src/components/modals/InpaintModal.tsx:109:11",onClick:()=>l("blue"),className:`w-8 h-8 rounded flex items-center justify-center transition-colors ${n==="blue"?"ring-2 ring-white":""}`,style:{backgroundColor:"#4444ff"},title:"è“è‰²ç”»ç¬” - æ ‡è®°ä¿æŠ¤åŒºåŸŸ"}),e.jsx("button",{"code-path":"src/components/modals/InpaintModal.tsx:117:11",onClick:()=>l("yellow"),className:`w-8 h-8 rounded flex items-center justify-center transition-colors ${n==="yellow"?"ring-2 ring-white":""}`,style:{backgroundColor:"#ffff44"},title:"é»„è‰²ç”»ç¬” - æ ‡è®°å‚è€ƒåŒºåŸŸ"}),e.jsx("div",{"code-path":"src/components/modals/InpaintModal.tsx:125:11",className:"w-px h-6 mx-2 bg-border"}),e.jsx("button",{"code-path":"src/components/modals/InpaintModal.tsx:126:11",onClick:y,className:"p-2 rounded hover:bg-white/10 transition-colors text-text-secondary",title:"æ¸…ç©º",children:e.jsx(He,{"code-path":"src/components/modals/InpaintModal.tsx:131:13",size:18})}),e.jsx("button",{"code-path":"src/components/modals/InpaintModal.tsx:133:11",className:"p-2 rounded hover:bg-white/10 transition-colors text-text-secondary",title:"æ’¤é”€",children:e.jsx(Mt,{"code-path":"src/components/modals/InpaintModal.tsx:137:13",size:18})}),e.jsx("button",{"code-path":"src/components/modals/InpaintModal.tsx:139:11",className:"p-2 rounded hover:bg-white/10 transition-colors text-text-secondary",title:"é‡åš",children:e.jsx(Pt,{"code-path":"src/components/modals/InpaintModal.tsx:143:13",size:18})}),e.jsxs("div",{"code-path":"src/components/modals/InpaintModal.tsx:145:11",className:"flex items-center gap-2 ml-auto w-full sm:w-auto mt-2 sm:mt-0 justify-end",children:[e.jsx("span",{"code-path":"src/components/modals/InpaintModal.tsx:146:13",className:"text-xs text-text-tertiary whitespace-nowrap",children:"ç”»ç¬”å¤§å°:"}),e.jsx("input",{"code-path":"src/components/modals/InpaintModal.tsx:149:13",type:"range",min:"5",max:"50",value:d,onChange:b=>r(Number(b.target.value)),className:"w-24 sm:w-32"}),e.jsx("span",{"code-path":"src/components/modals/InpaintModal.tsx:157:13",className:"text-xs w-6 text-text-secondary",children:d})]})]}),e.jsx("div",{"code-path":"src/components/modals/InpaintModal.tsx:164:9",className:"flex-1 overflow-auto flex items-center justify-center rounded-lg bg-elevated min-h-0",children:o?e.jsx("canvas",{"code-path":"src/components/modals/InpaintModal.tsx:168:13",ref:s,onMouseDown:u,onMouseMove:N,onMouseUp:g,onMouseLeave:g,className:"max-w-full max-h-full cursor-crosshair",style:{objectFit:"contain"}}):e.jsx("div",{"code-path":"src/components/modals/InpaintModal.tsx:178:13",className:"text-center text-text-tertiary",children:"è¯·å…ˆé€‰æ‹©ä¸€å¼ å›¾ç‰‡"})}),e.jsxs("div",{"code-path":"src/components/modals/InpaintModal.tsx:185:9",className:"mt-4 flex flex-col sm:flex-row items-end gap-3 sm:gap-4 flex-shrink-0",children:[e.jsxs("div",{"code-path":"src/components/modals/InpaintModal.tsx:186:11",className:"flex-1 w-full",children:[e.jsx("label",{"code-path":"src/components/modals/InpaintModal.tsx:187:13",className:"text-xs block mb-1 text-text-tertiary",children:"æç¤ºè¯å‚è€ƒ: å°†çº¢è‰²åŒºåŸŸä¿®æ”¹XXX"}),e.jsx("input",{"code-path":"src/components/modals/InpaintModal.tsx:190:13",type:"text",value:x,onChange:b=>m(b.target.value),placeholder:"è¾“å…¥æç¤ºè¯...",className:"w-full input"})]}),e.jsx(R,{"code-path":"src/components/modals/InpaintModal.tsx:198:11",className:"btn-primary w-full sm:w-auto px-6",children:"å¼€å§‹ç”Ÿæˆ"})]})]})})}function Be(t){const a=os(t),o=c.forwardRef((s,n)=>{const{children:l,...d}=s,r=c.Children.toArray(l),v=r.find(rs);if(v){const i=v.props.children,x=r.map(m=>m===v?c.Children.count(i)>1?c.Children.only(null):c.isValidElement(i)?i.props.children:null:m);return e.jsx(a,{...d,ref:n,children:c.isValidElement(i)?c.cloneElement(i,void 0,x):null})}return e.jsx(a,{...d,ref:n,children:l})});return o.displayName=`${t}.Slot`,o}function os(t){const a=c.forwardRef((o,s)=>{const{children:n,...l}=o;if(c.isValidElement(n)){const d=ls(n),r=cs(l,n.props);return n.type!==c.Fragment&&(r.ref=s?Dt(s,d):d),c.cloneElement(n,r)}return c.Children.count(n)>1?c.Children.only(null):null});return a.displayName=`${t}.SlotClone`,a}var ns=Symbol("radix.slottable");function rs(t){return c.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===ns}function cs(t,a){const o={...a};for(const s in a){const n=t[s],l=a[s];/^on[A-Z]/.test(s)?n&&l?o[s]=(...r)=>{const v=l(...r);return n(...r),v}:n&&(o[s]=n):s==="style"?o[s]={...n,...l}:s==="className"&&(o[s]=[n,l].filter(Boolean).join(" "))}return{...t,...o}}function ls(t){let a=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,o=a&&"isReactWarning"in a&&a.isReactWarning;return o?t.ref:(a=Object.getOwnPropertyDescriptor(t,"ref")?.get,o=a&&"isReactWarning"in a&&a.isReactWarning,o?t.props.ref:t.props.ref||t.ref)}function is(t){const a=t+"CollectionProvider",[o,s]=We(a),[n,l]=o(a,{collectionRef:{current:null},itemMap:new Map}),d=h=>{const{scope:y,children:b}=h,p=X.useRef(null),S=X.useRef(new Map).current;return e.jsx(n,{scope:y,itemMap:S,collectionRef:p,children:b})};d.displayName=a;const r=t+"CollectionSlot",v=Be(r),i=X.forwardRef((h,y)=>{const{scope:b,children:p}=h,S=l(r,b),w=U(y,S.collectionRef);return e.jsx(v,{ref:w,children:p})});i.displayName=r;const x=t+"CollectionItemSlot",m="data-radix-collection-item",u=Be(x),N=X.forwardRef((h,y)=>{const{scope:b,children:p,...S}=h,w=X.useRef(null),P=U(y,w),D=l(x,b);return X.useEffect(()=>(D.itemMap.set(w,{ref:w,...S}),()=>{D.itemMap.delete(w)})),e.jsx(u,{[m]:"",ref:P,children:p})});N.displayName=x;function g(h){const y=l(t+"CollectionConsumer",h);return X.useCallback(()=>{const p=y.collectionRef.current;if(!p)return[];const S=Array.from(p.querySelectorAll(`[${m}]`));return Array.from(y.itemMap.values()).sort((D,j)=>S.indexOf(D.ref.current)-S.indexOf(j.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:d,Slot:i,ItemSlot:N},g,s]}var Ye=["PageUp","PageDown"],qe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Ze={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ee="Slider",[Me,ds,ps]=is(ee),[Je]=We(ee,[ps]),[ms,ue]=Je(ee),Qe=c.forwardRef((t,a)=>{const{name:o,min:s=0,max:n=100,step:l=1,orientation:d="horizontal",disabled:r=!1,minStepsBetweenThumbs:v=0,defaultValue:i=[s],value:x,onValueChange:m=()=>{},onValueCommit:u=()=>{},inverted:N=!1,form:g,...h}=t,y=c.useRef(new Set),b=c.useRef(0),S=d==="horizontal"?xs:hs,[w=[],P]=zt({prop:x,defaultProp:i,onChange:L=>{[...y.current][b.current]?.focus(),m(L)}}),D=c.useRef(w);function j(L){const C=vs(w,L);_(L,C)}function k(L){_(L,b.current)}function z(){const L=D.current[b.current];w[b.current]!==L&&u(w)}function _(L,C,{commit:K}={commit:!1}){const E=Ss(l),H=ws(Math.round((L-s)/l)*l+s,E),T=Xe(H,[s,n]);P(($=[])=>{const V=bs($,T,C);if(Ns(V,v*l)){b.current=V.indexOf(T);const W=String(V)!==String($);return W&&K&&u(V),W?V:$}else return $})}return e.jsx(ms,{scope:t.__scopeSlider,name:o,disabled:r,min:s,max:n,valueIndexToChangeRef:b,thumbs:y.current,values:w,orientation:d,form:g,children:e.jsx(Me.Provider,{scope:t.__scopeSlider,children:e.jsx(Me.Slot,{scope:t.__scopeSlider,children:e.jsx(S,{"aria-disabled":r,"data-disabled":r?"":void 0,...h,ref:a,onPointerDown:Z(h.onPointerDown,()=>{r||(D.current=w)}),min:s,max:n,inverted:N,onSlideStart:r?void 0:j,onSlideMove:r?void 0:k,onSlideEnd:r?void 0:z,onHomeKeyDown:()=>!r&&_(s,0,{commit:!0}),onEndKeyDown:()=>!r&&_(n,w.length-1,{commit:!0}),onStepKeyDown:({event:L,direction:C})=>{if(!r){const H=Ye.includes(L.key)||L.shiftKey&&qe.includes(L.key)?10:1,T=b.current,$=w[T],V=l*H*C;_($+V,T,{commit:!0})}}})})})})});Qe.displayName=ee;var[et,tt]=Je(ee,{startEdge:"left",endEdge:"right",size:"width",direction:1}),xs=c.forwardRef((t,a)=>{const{min:o,max:s,dir:n,inverted:l,onSlideStart:d,onSlideMove:r,onSlideEnd:v,onStepKeyDown:i,...x}=t,[m,u]=c.useState(null),N=U(a,S=>u(S)),g=c.useRef(void 0),h=kt(n),y=h==="ltr",b=y&&!l||!y&&l;function p(S){const w=g.current||m.getBoundingClientRect(),P=[0,w.width],j=Ie(P,b?[o,s]:[s,o]);return g.current=w,j(S-w.left)}return e.jsx(et,{scope:t.__scopeSlider,startEdge:b?"left":"right",endEdge:b?"right":"left",direction:b?1:-1,size:"width",children:e.jsx(st,{dir:h,"data-orientation":"horizontal",...x,ref:N,style:{...x.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const w=p(S.clientX);d?.(w)},onSlideMove:S=>{const w=p(S.clientX);r?.(w)},onSlideEnd:()=>{g.current=void 0,v?.()},onStepKeyDown:S=>{const P=Ze[b?"from-left":"from-right"].includes(S.key);i?.({event:S,direction:P?-1:1})}})})}),hs=c.forwardRef((t,a)=>{const{min:o,max:s,inverted:n,onSlideStart:l,onSlideMove:d,onSlideEnd:r,onStepKeyDown:v,...i}=t,x=c.useRef(null),m=U(a,x),u=c.useRef(void 0),N=!n;function g(h){const y=u.current||x.current.getBoundingClientRect(),b=[0,y.height],S=Ie(b,N?[s,o]:[o,s]);return u.current=y,S(h-y.top)}return e.jsx(et,{scope:t.__scopeSlider,startEdge:N?"bottom":"top",endEdge:N?"top":"bottom",size:"height",direction:N?1:-1,children:e.jsx(st,{"data-orientation":"vertical",...i,ref:m,style:{...i.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:h=>{const y=g(h.clientY);l?.(y)},onSlideMove:h=>{const y=g(h.clientY);d?.(y)},onSlideEnd:()=>{u.current=void 0,r?.()},onStepKeyDown:h=>{const b=Ze[N?"from-bottom":"from-top"].includes(h.key);v?.({event:h,direction:b?-1:1})}})})}),st=c.forwardRef((t,a)=>{const{__scopeSlider:o,onSlideStart:s,onSlideMove:n,onSlideEnd:l,onHomeKeyDown:d,onEndKeyDown:r,onStepKeyDown:v,...i}=t,x=ue(ee,o);return e.jsx(ae.span,{...i,ref:a,onKeyDown:Z(t.onKeyDown,m=>{m.key==="Home"?(d(m),m.preventDefault()):m.key==="End"?(r(m),m.preventDefault()):Ye.concat(qe).includes(m.key)&&(v(m),m.preventDefault())}),onPointerDown:Z(t.onPointerDown,m=>{const u=m.target;u.setPointerCapture(m.pointerId),m.preventDefault(),x.thumbs.has(u)?u.focus():s(m)}),onPointerMove:Z(t.onPointerMove,m=>{m.target.hasPointerCapture(m.pointerId)&&n(m)}),onPointerUp:Z(t.onPointerUp,m=>{const u=m.target;u.hasPointerCapture(m.pointerId)&&(u.releasePointerCapture(m.pointerId),l(m))})})}),at="SliderTrack",ot=c.forwardRef((t,a)=>{const{__scopeSlider:o,...s}=t,n=ue(at,o);return e.jsx(ae.span,{"data-disabled":n.disabled?"":void 0,"data-orientation":n.orientation,...s,ref:a})});ot.displayName=at;var Pe="SliderRange",nt=c.forwardRef((t,a)=>{const{__scopeSlider:o,...s}=t,n=ue(Pe,o),l=tt(Pe,o),d=c.useRef(null),r=U(a,d),v=n.values.length,i=n.values.map(u=>lt(u,n.min,n.max)),x=v>1?Math.min(...i):0,m=100-Math.max(...i);return e.jsx(ae.span,{"data-orientation":n.orientation,"data-disabled":n.disabled?"":void 0,...s,ref:r,style:{...t.style,[l.startEdge]:x+"%",[l.endEdge]:m+"%"}})});nt.displayName=Pe;var De="SliderThumb",rt=c.forwardRef((t,a)=>{const o=ds(t.__scopeSlider),[s,n]=c.useState(null),l=U(a,r=>n(r)),d=c.useMemo(()=>s?o().findIndex(r=>r.ref.current===s):-1,[o,s]);return e.jsx(us,{...t,ref:l,index:d})}),us=c.forwardRef((t,a)=>{const{__scopeSlider:o,index:s,name:n,...l}=t,d=ue(De,o),r=tt(De,o),[v,i]=c.useState(null),x=U(a,p=>i(p)),m=v?d.form||!!v.closest("form"):!0,u=Vt(v),N=d.values[s],g=N===void 0?0:lt(N,d.min,d.max),h=gs(s,d.values.length),y=u?.[r.size],b=y?ys(y,g,r.direction):0;return c.useEffect(()=>{if(v)return d.thumbs.add(v),()=>{d.thumbs.delete(v)}},[v,d.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[r.startEdge]:`calc(${g}% + ${b}px)`},children:[e.jsx(Me.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(ae.span,{role:"slider","aria-label":t["aria-label"]||h,"aria-valuemin":d.min,"aria-valuenow":N,"aria-valuemax":d.max,"aria-orientation":d.orientation,"data-orientation":d.orientation,"data-disabled":d.disabled?"":void 0,tabIndex:d.disabled?void 0:0,...l,ref:x,style:N===void 0?{display:"none"}:t.style,onFocus:Z(t.onFocus,()=>{d.valueIndexToChangeRef.current=s})})}),m&&e.jsx(ct,{name:n??(d.name?d.name+(d.values.length>1?"[]":""):void 0),form:d.form,value:N},s)]})});rt.displayName=De;var fs="RadioBubbleInput",ct=c.forwardRef(({__scopeSlider:t,value:a,...o},s)=>{const n=c.useRef(null),l=U(n,s),d=Gt(a);return c.useEffect(()=>{const r=n.current;if(!r)return;const v=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(v,"value").set;if(d!==a&&x){const m=new Event("input",{bubbles:!0});x.call(r,a),r.dispatchEvent(m)}},[d,a]),e.jsx(ae.input,{style:{display:"none"},...o,ref:l,defaultValue:a})});ct.displayName=fs;function bs(t=[],a,o){const s=[...t];return s[o]=a,s.sort((n,l)=>n-l)}function lt(t,a,o){const l=100/(o-a)*(t-a);return Xe(l,[0,100])}function gs(t,a){return a>2?`Value ${t+1} of ${a}`:a===2?["Minimum","Maximum"][t]:void 0}function vs(t,a){if(t.length===1)return 0;const o=t.map(n=>Math.abs(n-a)),s=Math.min(...o);return o.indexOf(s)}function ys(t,a,o){const s=t/2,l=Ie([0,50],[0,s]);return(s-l(a)*o)*o}function js(t){return t.slice(0,-1).map((a,o)=>t[o+1]-a)}function Ns(t,a){if(a>0){const o=js(t);return Math.min(...o)>=a}return!0}function Ie(t,a){return o=>{if(t[0]===t[1]||a[0]===a[1])return a[0];const s=(a[1]-a[0])/(t[1]-t[0]);return a[0]+s*(o-t[0])}}function Ss(t){return(String(t).split(".")[1]||"").length}function ws(t,a){const o=Math.pow(10,a);return Math.round(t*o)/o}var Cs=Qe,Ms=ot,Ps=nt,Ds=rt;function J({className:t,defaultValue:a,value:o,min:s=0,max:n=100,...l}){const d=c.useMemo(()=>Array.isArray(o)?o:Array.isArray(a)?a:[s,n],[o,a,s,n]);return e.jsxs(Cs,{"code-path":"src/components/ui/slider.tsx:27:5","data-slot":"slider",defaultValue:a,value:o,min:s,max:n,className:Ne("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",t),...l,children:[e.jsx(Ms,{"code-path":"src/components/ui/slider.tsx:39:7","data-slot":"slider-track",className:Ne("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:e.jsx(Ps,{"code-path":"src/components/ui/slider.tsx:45:9","data-slot":"slider-range",className:Ne("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:d.length},(r,v)=>e.jsx(Ds,{"code-path":"src/components/ui/slider.tsx:53:9","data-slot":"slider-thumb",className:"border-primary ring-ring/50 block size-4 shrink-0 rounded-full border bg-white shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},v))]})}function ks({isOpen:t,onClose:a,imageUrl:o}){const[s,n]=c.useState(1.5),[l,d]=c.useState("");return e.jsx(pe,{"code-path":"src/components/modals/OutpaintModal.tsx:18:5",open:t,onOpenChange:a,children:e.jsxs(me,{"code-path":"src/components/modals/OutpaintModal.tsx:19:7",className:"max-w-4xl max-h-[90vh] overflow-y-auto bg-surface border border-border flex flex-col",children:[e.jsx(xe,{"code-path":"src/components/modals/OutpaintModal.tsx:20:9",className:"flex-shrink-0",children:e.jsxs(he,{"code-path":"src/components/modals/OutpaintModal.tsx:21:11",className:"flex items-center justify-between text-text-primary",children:["æ™ºèƒ½æ‰©å›¾ (Outpaint)",e.jsx("button",{"code-path":"src/components/modals/OutpaintModal.tsx:23:13",onClick:a,className:"p-1 rounded hover:bg-white/10 transition-colors",children:e.jsx(F,{"code-path":"src/components/modals/OutpaintModal.tsx:27:15",size:20,className:"text-text-secondary"})})]})}),e.jsxs("div",{"code-path":"src/components/modals/OutpaintModal.tsx:33:9",className:"flex items-center gap-4 mb-4",children:[e.jsx("span",{"code-path":"src/components/modals/OutpaintModal.tsx:34:11",className:"text-sm text-text-secondary",children:"ç”»é¢ç¼©æ”¾:"}),e.jsx(J,{"code-path":"src/components/modals/OutpaintModal.tsx:37:11",value:[s],onValueChange:r=>n(r[0]),min:1,max:2,step:.1,className:"flex-1"}),e.jsxs("span",{"code-path":"src/components/modals/OutpaintModal.tsx:45:11",className:"text-sm w-12 text-text-primary",children:[s.toFixed(1),"x"]})]}),e.jsx("div",{"code-path":"src/components/modals/OutpaintModal.tsx:51:9",className:"flex-1 overflow-auto flex items-center justify-center rounded-lg p-8 bg-elevated min-h-0",children:o?e.jsxs("div",{"code-path":"src/components/modals/OutpaintModal.tsx:55:13",className:"relative",style:{width:`${s*100}%`,maxWidth:"800px",aspectRatio:"16/9",backgroundColor:"rgba(255, 0, 0, 0.3)",display:"flex",alignItems:"center",justifyContent:"center"},children:[e.jsx("img",{"code-path":"src/components/modals/OutpaintModal.tsx:67:15",src:o,alt:"Original",className:"max-w-full max-h-full object-contain",style:{width:`${100/s}%`,height:`${100/s}%`}}),e.jsx("div",{"code-path":"src/components/modals/OutpaintModal.tsx:77:15",className:"absolute inset-0 pointer-events-none",style:{background:`
                    linear-gradient(to right, rgba(255,0,0,0.3) 0%, rgba(255,0,0,0.3) ${(s-1)/s*50}%, transparent ${(s-1)/s*50}%, transparent ${100-(s-1)/s*50}%, rgba(255,0,0,0.3) ${100-(s-1)/s*50}%, rgba(255,0,0,0.3) 100%),
                    linear-gradient(to bottom, rgba(255,0,0,0.3) 0%, rgba(255,0,0,0.3) ${(s-1)/s*50}%, transparent ${(s-1)/s*50}%, transparent ${100-(s-1)/s*50}%, rgba(255,0,0,0.3) ${100-(s-1)/s*50}%, rgba(255,0,0,0.3) 100%)
                  `}}),e.jsx("div",{"code-path":"src/components/modals/OutpaintModal.tsx:86:15",className:"absolute bottom-4 left-1/2 -translate-x-1/2 text-xs px-2 py-1 rounded",style:{backgroundColor:"rgba(0,0,0,0.7)",color:"#fff"},children:"çº¢è‰²åŒºåŸŸè¡¨ç¤ºå¾…å¡«å……åŒºåŸŸ"})]}):e.jsx("div",{"code-path":"src/components/modals/OutpaintModal.tsx:97:13",className:"text-center text-text-tertiary",children:"è¯·å…ˆé€‰æ‹©ä¸€å¼ å›¾ç‰‡"})}),e.jsxs("div",{"code-path":"src/components/modals/OutpaintModal.tsx:104:9",className:"mt-4 flex flex-col sm:flex-row items-end gap-3 sm:gap-4 flex-shrink-0",children:[e.jsxs("div",{"code-path":"src/components/modals/OutpaintModal.tsx:105:11",className:"flex-1 w-full",children:[e.jsx("label",{"code-path":"src/components/modals/OutpaintModal.tsx:106:13",className:"text-xs block mb-1 text-text-tertiary",children:"è¯·æ ¹æ®å›¾ç‰‡ï¼Œå¡«å……çº¢è‰²åŒºåŸŸ"}),e.jsx("input",{"code-path":"src/components/modals/OutpaintModal.tsx:109:13",type:"text",value:l,onChange:r=>d(r.target.value),placeholder:"è¾“å…¥æç¤ºè¯...",className:"w-full input"})]}),e.jsx(R,{"code-path":"src/components/modals/OutpaintModal.tsx:117:11",className:"btn-primary w-full sm:w-auto px-6",children:"å¼€å§‹ç”Ÿæˆ"})]})]})})}function Is({isOpen:t,onClose:a,imageUrl:o}){const[s,n]=c.useState(57),[l,d]=c.useState(-64),[r,v]=c.useState(4),[i,x]=c.useState("50mm"),[m,u]=c.useState("f/2.8"),N=["24mm","35mm","50mm","85mm","135mm","200mm"],g=["f/1.4","f/1.8","f/2.8","f/4","f/5.6","f/8","f/11","f/16","f/22"];return e.jsx(pe,{"code-path":"src/components/modals/VirtualCameraModal.tsx:24:5",open:t,onOpenChange:a,children:e.jsxs(me,{"code-path":"src/components/modals/VirtualCameraModal.tsx:25:7",className:"max-w-4xl max-h-[90vh] overflow-y-auto bg-surface border border-border flex flex-col",children:[e.jsx(xe,{"code-path":"src/components/modals/VirtualCameraModal.tsx:26:9",className:"flex-shrink-0",children:e.jsxs(he,{"code-path":"src/components/modals/VirtualCameraModal.tsx:27:11",className:"flex items-center justify-between text-text-primary",children:[e.jsxs("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:28:13",children:["è™šæ‹Ÿæ‘„åƒæœº(Virtual Camera)",e.jsx("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:30:15",className:"text-xs ml-2 font-normal text-text-tertiary",children:"---æœ‰å¤±è´¥æ¦‚çŽ‡"})]}),e.jsx("button",{"code-path":"src/components/modals/VirtualCameraModal.tsx:34:13",onClick:a,className:"p-1 rounded hover:bg-white/10 transition-colors",children:e.jsx(F,{"code-path":"src/components/modals/VirtualCameraModal.tsx:38:15",size:20,className:"text-text-secondary"})})]})}),e.jsx("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:44:9",className:"flex-1 overflow-hidden flex items-center justify-center rounded-lg bg-elevated my-4 min-h-0",children:o?e.jsxs("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:48:13",className:"relative w-full h-full flex items-center justify-center",children:[e.jsx("img",{"code-path":"src/components/modals/VirtualCameraModal.tsx:49:15",src:o,alt:"Preview",className:"max-w-full max-h-full object-contain transition-transform duration-300",style:{transform:`
                    perspective(1000px)
                    rotateY(${s}deg)
                    rotateX(${-l}deg)
                    scale(${r/4})
                  `}}),e.jsx("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:62:15",className:"absolute bottom-4 left-4 text-xs px-2 py-1 rounded",style:{backgroundColor:"rgba(0,0,0,0.7)",color:"#fff"},children:"å¯æ‹–æ‹½æ—‹è½¬è§†è§’"})]}):e.jsx("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:73:13",className:"text-center text-text-tertiary",children:"3Dé¢„è§ˆåŒºåŸŸ"})}),e.jsxs("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:80:9",className:"space-y-4 mt-0 overflow-y-auto max-h-[40vh] sm:max-h-none pr-1 flex-shrink-0",children:[e.jsxs("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:82:11",className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:83:13",className:"text-xs sm:text-sm w-16 sm:w-20 text-text-secondary shrink-0",children:"æ°´å¹³è§’åº¦:"}),e.jsx("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:86:13",className:"text-xs w-12 text-text-tertiary",children:"-180Â°"}),e.jsx(J,{"code-path":"src/components/modals/VirtualCameraModal.tsx:89:13",value:[s],onValueChange:h=>n(h[0]),min:-180,max:180,step:1,className:"flex-1"}),e.jsx("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:97:13",className:"text-xs w-12 text-text-tertiary",children:"+180Â°"}),e.jsxs("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:100:13",className:"text-sm w-12 text-right text-text-primary",children:["(",s,"Â°)"]})]}),e.jsxs("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:106:11",className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:107:13",className:"text-xs sm:text-sm w-16 sm:w-20 text-text-secondary shrink-0",children:"åž‚ç›´è§’åº¦:"}),e.jsx("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:110:13",className:"text-xs w-12 text-text-tertiary",children:"-90Â°"}),e.jsx(J,{"code-path":"src/components/modals/VirtualCameraModal.tsx:113:13",value:[l],onValueChange:h=>d(h[0]),min:-90,max:90,step:1,className:"flex-1"}),e.jsx("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:121:13",className:"text-xs w-12 text-text-tertiary",children:"+90Â°"}),e.jsxs("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:124:13",className:"text-sm w-12 text-right text-text-primary",children:["(",l,"Â°)"]})]}),e.jsxs("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:130:11",className:"flex items-center gap-2 sm:gap-4",children:[e.jsx("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:131:13",className:"text-xs sm:text-sm w-16 sm:w-20 text-text-secondary shrink-0",children:"æŽ¨æ‹‰é•œå¤´:"}),e.jsx("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:134:13",className:"text-xs w-12 text-text-tertiary",children:"0.5x"}),e.jsx(J,{"code-path":"src/components/modals/VirtualCameraModal.tsx:137:13",value:[r],onValueChange:h=>v(h[0]),min:.5,max:5,step:.1,className:"flex-1"}),e.jsx("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:145:13",className:"text-xs w-12 text-text-tertiary",children:"5.0x"}),e.jsxs("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:148:13",className:"text-sm w-12 text-right text-text-primary",children:["(",r.toFixed(2),"x)"]})]}),e.jsxs("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:154:11",className:"flex flex-col sm:flex-row items-center gap-2 sm:gap-4",children:[e.jsxs("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:155:13",className:"flex items-center gap-2 flex-1 w-full",children:[e.jsx("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:156:15",className:"text-xs sm:text-sm text-text-secondary shrink-0 w-16 sm:w-auto",children:"ç„¦è·:"}),e.jsx("select",{"code-path":"src/components/modals/VirtualCameraModal.tsx:159:15",value:i,onChange:h=>x(h.target.value),className:"input text-xs sm:text-sm flex-1",children:N.map(h=>e.jsx("option",{"code-path":"src/components/modals/VirtualCameraModal.tsx:165:19",value:h,children:h},h))})]}),e.jsxs("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:169:13",className:"flex items-center gap-2 flex-1 w-full",children:[e.jsx("span",{"code-path":"src/components/modals/VirtualCameraModal.tsx:170:15",className:"text-xs sm:text-sm text-text-secondary shrink-0 w-16 sm:w-auto",children:"å…‰åœˆ:"}),e.jsx("select",{"code-path":"src/components/modals/VirtualCameraModal.tsx:173:15",value:m,onChange:h=>u(h.target.value),className:"input text-xs sm:text-sm flex-1",children:g.map(h=>e.jsx("option",{"code-path":"src/components/modals/VirtualCameraModal.tsx:179:19",value:h,children:h},h))})]})]}),e.jsxs("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:186:11",children:[e.jsx("label",{"code-path":"src/components/modals/VirtualCameraModal.tsx:187:13",className:"text-xs block mb-1 text-text-tertiary",children:"ç”Ÿæˆçš„æç¤ºè¯(Prompt):"}),e.jsxs("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:190:13",className:"p-3 rounded-lg text-sm bg-elevated text-text-secondary",children:["Cinematography: Camera orbits vertically. Re-shoot from new angle. Horizontal: ",s,"Â°, Vertical: ",l,"Â°, Zoom: ",r.toFixed(2),"x, Focal: ",i,", Aperture: ",m]})]})]}),e.jsxs("div",{"code-path":"src/components/modals/VirtualCameraModal.tsx:199:9",className:"flex justify-end gap-3 mt-4 flex-shrink-0",children:[e.jsx(R,{"code-path":"src/components/modals/VirtualCameraModal.tsx:200:11",variant:"outline",onClick:a,className:"border-border",children:"å–æ¶ˆ"}),e.jsx(R,{"code-path":"src/components/modals/VirtualCameraModal.tsx:207:11",className:"btn-primary",children:"ç”Ÿæˆæ–°æœºä½(New Shot)"})]})]})})}function Ls({isOpen:t,onClose:a,imageUrl:o}){const[s,n]=c.useState("push"),[l,d]=c.useState(50),[r,v]=c.useState(50),i=[{id:"push",name:"æŽ¨(Push In)",icon:Re,desc:"é•œå¤´å‘å‰æŽ¨è¿›"},{id:"pull",name:"æ‹‰(Pull Out)",icon:Re,desc:"é•œå¤´å‘åŽæ‹‰å‡º"},{id:"pan_left",name:"å·¦æ‘‡(Pan Left)",icon:Se,desc:"é•œå¤´å‘å·¦å¹³ç§»"},{id:"pan_right",name:"å³æ‘‡(Pan Right)",icon:ie,desc:"é•œå¤´å‘å³å¹³ç§»"},{id:"tilt_up",name:"ä¸Šæ‘‡(Tilt Up)",icon:Oe,desc:"é•œå¤´å‘ä¸Šå€¾æ–œ"},{id:"tilt_down",name:"ä¸‹æ‘‡(Tilt Down)",icon:_e,desc:"é•œå¤´å‘ä¸‹å€¾æ–œ"},{id:"dolly_in",name:"å‰ç§»(Dolly In)",icon:Ee,desc:"æ‘„å½±æœºå‰ç§»"},{id:"dolly_out",name:"åŽç§»(Dolly Out)",icon:Ee,desc:"æ‘„å½±æœºåŽç§»"},{id:"truck_left",name:"å·¦ç§»(Truck Left)",icon:Se,desc:"æ‘„å½±æœºå·¦ç§»"},{id:"truck_right",name:"å³ç§»(Truck Right)",icon:ie,desc:"æ‘„å½±æœºå³ç§»"},{id:"pedestal_up",name:"ä¸Šå‡(Pedestal Up)",icon:Oe,desc:"æ‘„å½±æœºä¸Šå‡"},{id:"pedestal_down",name:"ä¸‹é™(Pedestal Down)",icon:_e,desc:"æ‘„å½±æœºä¸‹é™"},{id:"orbit",name:"çŽ¯ç»•(Orbit)",icon:It,desc:"é•œå¤´çŽ¯ç»•ä¸»ä½“"},{id:"rack_focus",name:"å˜ç„¦(Rack Focus)",icon:ce,desc:"ç„¦ç‚¹è½¬æ¢"}];return t?e.jsx("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:37:5",className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.8)"},onClick:a,children:e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:42:7",className:"w-full max-w-4xl max-h-[90vh] rounded-xl overflow-y-auto flex flex-col bg-surface border border-border",onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:47:9",className:"flex items-center justify-between px-4 py-3 border-b flex-shrink-0 border-border",children:[e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:48:11",className:"flex items-center gap-3",children:[e.jsx(ce,{"code-path":"src/components/modals/CameraMoveModal.tsx:49:13",size:20,className:"text-primary"}),e.jsx("span",{"code-path":"src/components/modals/CameraMoveModal.tsx:50:13",className:"font-semibold text-text-primary",children:"é•œå¤´è¿é•œ (Camera Move)"})]}),e.jsx("button",{"code-path":"src/components/modals/CameraMoveModal.tsx:54:11",onClick:a,className:"p-2 rounded-lg hover:bg-white/10 transition-colors text-text-secondary",children:e.jsx(F,{"code-path":"src/components/modals/CameraMoveModal.tsx:58:13",size:20})})]}),e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:63:9",className:"flex-1 flex overflow-hidden flex-col sm:flex-row",children:[e.jsx("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:65:11",className:"w-full sm:w-64 flex-shrink-0 border-b sm:border-b-0 sm:border-r overflow-y-auto border-border h-40 sm:h-full",children:e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:66:13",className:"p-3",children:[e.jsx("h3",{"code-path":"src/components/modals/CameraMoveModal.tsx:67:15",className:"text-xs font-medium uppercase tracking-wider mb-3 text-text-tertiary sticky top-0 bg-surface py-1 z-10",children:"è¿é•œç±»åž‹"}),e.jsx("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:70:15",className:"space-y-1",children:i.map(x=>{const m=x.icon,u=s===x.id;return e.jsxs("button",{"code-path":"src/components/modals/CameraMoveModal.tsx:75:21",onClick:()=>n(x.id),className:`
                        w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-left text-sm transition-colors
                        ${u?"bg-yellow-500/10":"hover:bg-white/5"}
                      `,children:[e.jsx(m,{"code-path":"src/components/modals/CameraMoveModal.tsx:83:23",size:16,className:u?"text-primary":"text-text-secondary"}),e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:87:23",className:"flex-1 min-w-0",children:[e.jsx("p",{"code-path":"src/components/modals/CameraMoveModal.tsx:88:25",className:u?"text-primary":"text-text-primary",children:x.name}),e.jsx("p",{"code-path":"src/components/modals/CameraMoveModal.tsx:91:25",className:"text-xs truncate text-text-tertiary",children:x.desc})]})]},x.id)})})]})}),e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:103:11",className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:104:13",className:"flex-1 flex items-center justify-center p-4 bg-elevated",children:o?e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:106:17",className:"relative",children:[e.jsx("img",{"code-path":"src/components/modals/CameraMoveModal.tsx:107:19",src:o,alt:"Preview",className:"max-w-full max-h-[400px] object-contain rounded-lg"}),e.jsx("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:113:19",className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:114:21",className:"w-16 h-16 rounded-full border-2 flex items-center justify-center",style:{borderColor:"hsl(var(--primary))"},children:e.jsx(ce,{"code-path":"src/components/modals/CameraMoveModal.tsx:115:23",size:24,className:"text-primary"})})})]}):e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:120:17",className:"text-center text-text-tertiary",children:[e.jsx(ce,{"code-path":"src/components/modals/CameraMoveModal.tsx:121:19",size:48,style:{margin:"0 auto 16px",opacity:.5}}),e.jsx("p",{"code-path":"src/components/modals/CameraMoveModal.tsx:122:19",children:"è¯·é€‰æ‹©ä¸€å¼ å›¾ç‰‡é¢„è§ˆè¿é•œæ•ˆæžœ"})]})}),e.jsx("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:128:13",className:"p-4 border-t border-border",children:e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:129:15",className:"space-y-4",children:[e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:130:17",children:[e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:131:19",className:"flex items-center justify-between mb-2",children:[e.jsx("span",{"code-path":"src/components/modals/CameraMoveModal.tsx:132:21",className:"text-sm text-text-secondary",children:"è¿é•œå¼ºåº¦"}),e.jsxs("span",{"code-path":"src/components/modals/CameraMoveModal.tsx:135:21",className:"text-sm text-text-primary",children:[l,"%"]})]}),e.jsx(J,{"code-path":"src/components/modals/CameraMoveModal.tsx:139:19",value:[l],onValueChange:x=>d(x[0]),min:0,max:100,step:1})]}),e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:147:17",children:[e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:148:19",className:"flex items-center justify-between mb-2",children:[e.jsx("span",{"code-path":"src/components/modals/CameraMoveModal.tsx:149:21",className:"text-sm text-text-secondary",children:"è¿é•œé€Ÿåº¦"}),e.jsxs("span",{"code-path":"src/components/modals/CameraMoveModal.tsx:152:21",className:"text-sm text-text-primary",children:[r,"%"]})]}),e.jsx(J,{"code-path":"src/components/modals/CameraMoveModal.tsx:156:19",value:[r],onValueChange:x=>v(x[0]),min:0,max:100,step:1})]})]})})]}),e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:169:11",className:"w-full sm:w-72 flex-shrink-0 border-t sm:border-t-0 sm:border-l overflow-y-auto p-4 border-border h-auto sm:h-full",children:[e.jsx("h3",{"code-path":"src/components/modals/CameraMoveModal.tsx:170:13",className:"text-xs font-medium uppercase tracking-wider mb-3 text-text-tertiary",children:"ç”Ÿæˆçš„æç¤ºè¯"}),e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:173:13",className:"p-3 rounded-lg text-sm mb-4 bg-elevated text-text-secondary",children:["Camera Move: ",i.find(x=>x.id===s)?.name,e.jsx("br",{"code-path":"src/components/modals/CameraMoveModal.tsx:175:15"}),"Intensity: ",l,"%",e.jsx("br",{"code-path":"src/components/modals/CameraMoveModal.tsx:177:15"}),"Speed: ",r,"%"]}),e.jsxs("div",{"code-path":"src/components/modals/CameraMoveModal.tsx:181:13",className:"space-y-2",children:[e.jsx(R,{"code-path":"src/components/modals/CameraMoveModal.tsx:182:15",className:"w-full btn-primary",children:"ç”Ÿæˆè¿é•œè§†é¢‘"}),e.jsx(R,{"code-path":"src/components/modals/CameraMoveModal.tsx:185:15",variant:"outline",className:"w-full border-border",children:"é¢„è§ˆæ•ˆæžœ"})]})]})]})]})}):null}function Rs({isOpen:t,onClose:a,onAICreation:o,onManualCreation:s}){return e.jsx(pe,{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:25:5",open:t,onOpenChange:a,children:e.jsxs(me,{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:26:7",className:"sm:max-w-lg bg-surface border-border",children:[e.jsxs(xe,{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:27:9",children:[e.jsx(he,{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:28:11",className:"text-xl font-semibold text-text-primary",children:"æ‚¨æƒ³å¦‚ä½•åˆ›å»ºå‰§æœ¬ï¼Ÿ"}),e.jsx(Bt,{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:31:11",className:"text-text-secondary",children:"é€‰æ‹©é€‚åˆæ‚¨çš„åˆ›ä½œæ–¹å¼"})]}),e.jsxs("div",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:36:9",className:"grid gap-4 py-4",children:[e.jsxs("button",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:37:11",onClick:o,className:"flex items-start gap-4 p-4 rounded-lg border border-border bg-background/50 hover:bg-primary/5 hover:border-primary/30 transition-all text-left group",children:[e.jsx("div",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:41:13",className:"p-3 rounded-full bg-primary/10 group-hover:bg-primary/20 transition-colors",children:e.jsx(Lt,{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:42:15",className:"w-6 h-6 text-primary"})}),e.jsxs("div",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:44:13",className:"flex-1",children:[e.jsx("h3",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:45:15",className:"font-semibold text-text-primary mb-1",children:"AIååŠ©åˆ›ä½œ"}),e.jsx("p",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:48:15",className:"text-sm text-text-secondary mb-2",children:"ä¸ŽAIå¯¹è¯ï¼Œå…±åŒåˆ›ä½œå°è¯´å’Œå‰§æœ¬ã€‚AIä¼šæ ¹æ®æ‚¨çš„åˆ›æ„ç”Ÿæˆå®Œæ•´çš„æ•…äº‹å†…å®¹ã€‚"}),e.jsxs("div",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:51:15",className:"flex items-center gap-2 text-xs text-primary",children:[e.jsx("span",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:52:17",children:"å¼€å§‹åˆ›ä½œ"}),e.jsx(ie,{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:53:17",className:"w-3 h-3"})]})]})]}),e.jsxs("button",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:58:11",onClick:s,className:"flex items-start gap-4 p-4 rounded-lg border border-border bg-background/50 hover:bg-surface transition-all text-left group",children:[e.jsx("div",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:62:13",className:"p-3 rounded-full bg-surface group-hover:bg-elevated transition-colors",children:e.jsx(Rt,{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:63:15",className:"w-6 h-6 text-text-secondary"})}),e.jsxs("div",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:65:13",className:"flex-1",children:[e.jsx("h3",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:66:15",className:"font-semibold text-text-primary mb-1",children:"æ‰‹åŠ¨ç¼–å†™"}),e.jsx("p",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:69:15",className:"text-sm text-text-secondary mb-2",children:"åœ¨ç©ºç™½ç¼–è¾‘å™¨ä¸­ç›´æŽ¥è¾“å…¥æ‚¨çš„å‰§æœ¬å†…å®¹ï¼Œé€‚åˆå·²æœ‰å®Œæ•´å‰§æœ¬çš„åœºæ™¯ã€‚"}),e.jsxs("div",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:72:15",className:"flex items-center gap-2 text-xs text-text-tertiary",children:[e.jsx("span",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:73:17",children:"è¿›å…¥ç¼–è¾‘å™¨"}),e.jsx(ie,{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:74:17",className:"w-3 h-3"})]})]})]})]}),e.jsx("div",{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:80:9",className:"flex justify-end",children:e.jsx(R,{"code-path":"src/components/modals/CreateScriptOptionsDialog.tsx:81:11",variant:"outline",onClick:a,className:"border-border text-text-secondary hover:bg-surface",children:"å–æ¶ˆ"})})]})})}function zs(){const t=Te(),{projectId:a}=Ot(),{theme:o,currentEpisode:s,setCurrentProject:n,setCurrentEpisode:l}=de(),{modal:d,closeModal:r,addToast:v}=Y(),[i,x]=c.useState(null),[m,u]=c.useState(!1),[N,g]=c.useState(!1),[h,y]=c.useState(!1),[b,p]=c.useState(!0),[S,w]=c.useState(null),[P,D]=c.useState(null),[j,k]=c.useState([]),[z,_]=c.useState(!1),[L,C]=c.useState(!1),[K,E]=c.useState(""),[H,T]=c.useState(null),[$,V]=c.useState(null),[W,oe]=c.useState(!1);c.useEffect(()=>{let O=!0;return(async()=>{if(!a){t("/",{replace:!0});return}p(!0),w(null);try{const[M,I]=await Promise.all([Et.getProject(a),Ce.listEpisodes(a)]);if(!O)return;const B=M.data,je={id:B.id,name:B.name,coverImage:B.coverImage||void 0,description:"",type:"film",status:"draft",createdAt:new Date(B.createdAt),updatedAt:new Date(B.updatedAt),episodes:[],characters:[],scenes:[]},A=(I.data||[]).map(G=>({id:G.episodeId,projectId:G.projectId,episodeNumber:G.episodeNumber,title:G.title,summary:G.summary,script:G.scriptText,novelContent:G.novelContent,wordCount:G.wordCount,status:G.status,createdAt:new Date(G.createdAt),updatedAt:new Date(G.updatedAt)}));D(je),k(A),n(je),A.length>0&&!s&&l(A[0])}catch(M){if(!O)return;console.error("Failed to load project:",M),w("åŠ è½½é¡¹ç›®å¤±è´¥")}finally{O&&p(!1)}})(),()=>{O=!1}},[a,t,n,l,s]),c.useEffect(()=>{document.body.className=o},[o]);const fe=O=>{x(O)},ne=async()=>{if(!(!P?.id||W)){if(s?.id){t(`/project/${P.id}/episode/${s.id}/script-workshop`);return}_(!0)}},te=async()=>{_(!1),oe(!0);try{const{project:O,episode:f}=await Ae.createTemporaryProject();T(O.id),V(f.episodeId),E(O.name||""),C(!0)}catch(O){console.error("åˆ›å»ºä¸´æ—¶é¡¹ç›®å¤±è´¥:",O),v({type:"error",message:"åˆ›å»ºåˆ›ä½œç©ºé—´å¤±è´¥ï¼Œè¯·é‡è¯•"})}finally{oe(!1)}},re=async()=>{if(_(!1),!!P?.id)try{if(s?.id)t(`/project/${P.id}/episode/${s.id}/script-workshop`);else{const O=await Ce.createEpisode(P.id,{title:"ç¬¬ä¸€é›†",summary:""});l(O.data),t(`/project/${P.id}/episode/${O.data.episodeId}/script-workshop`)}}catch(O){console.error("åˆ›å»ºå‰§é›†å¤±è´¥:",O),v({type:"error",message:"åˆ›å»ºå‰§é›†å¤±è´¥"})}},be=async O=>{if(!(!H||!$))try{await Ae.convertToFormalProject(H,O),v({type:"success",message:`é¡¹ç›®å·²å‘½åä¸ºã€Š${O}ã€‹`}),t(`/project/${H}/episode/${$}/script-workshop`)}catch(f){console.error("æ›´æ–°é¡¹ç›®åç§°å¤±è´¥:",f),v({type:"error",message:"ä¿å­˜é¡¹ç›®åç§°å¤±è´¥"})}finally{C(!1)}},ge=()=>{u(!0)},ve=()=>{g(!0)},ye=()=>{console.log("Export")};return b?e.jsx("div",{"code-path":"src/pages/ProjectPage.tsx:206:7",className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs("div",{"code-path":"src/pages/ProjectPage.tsx:207:9",className:"flex items-center gap-2 text-text-secondary",children:[e.jsx(Fe,{"code-path":"src/pages/ProjectPage.tsx:208:11",className:"animate-spin",size:20}),e.jsx("span",{"code-path":"src/pages/ProjectPage.tsx:209:11",children:"åŠ è½½é¡¹ç›®ä¸­..."})]})}):S?e.jsx("div",{"code-path":"src/pages/ProjectPage.tsx:217:7",className:"min-h-screen flex items-center justify-center bg-background",children:e.jsxs("div",{"code-path":"src/pages/ProjectPage.tsx:218:9",className:"text-center",children:[e.jsx("p",{"code-path":"src/pages/ProjectPage.tsx:219:11",className:"text-error mb-4",children:S}),e.jsx("button",{"code-path":"src/pages/ProjectPage.tsx:220:11",onClick:()=>t("/"),className:"px-4 py-2 bg-primary text-white rounded hover:bg-primary/90",children:"è¿”å›žé¦–é¡µ"})]})}):e.jsxs("div",{"code-path":"src/pages/ProjectPage.tsx:232:5",className:"h-screen supports-[height:100dvh]:h-[100dvh] flex flex-col overflow-hidden bg-background",children:[e.jsx(Ht,{"code-path":"src/pages/ProjectPage.tsx:233:7",onScriptWorkshop:ne,onBatchGenerate:ge,onExport:ye,onBackstage:ve}),e.jsxs("div",{"code-path":"src/pages/ProjectPage.tsx:240:7",className:"flex-1 flex overflow-hidden relative",children:[e.jsx(Ut,{"code-path":"src/pages/ProjectPage.tsx:241:9",episodes:j}),e.jsx(ts,{"code-path":"src/pages/ProjectPage.tsx:243:9",episodeId:s?.id||"",onNodeSelect:fe}),e.jsx(Xt,{"code-path":"src/pages/ProjectPage.tsx:248:9"})]}),e.jsx(ss,{"code-path":"src/pages/ProjectPage.tsx:251:7",isOpen:m,onClose:()=>u(!1)}),e.jsx(_t,{"code-path":"src/pages/ProjectPage.tsx:256:7",isOpen:N,onClose:()=>g(!1)}),e.jsx(Ls,{"code-path":"src/pages/ProjectPage.tsx:261:7",isOpen:h||d.type==="cameraMove",onClose:()=>{y(!1),r()},imageUrl:i?.imageUrl}),e.jsx(as,{"code-path":"src/pages/ProjectPage.tsx:270:7",isOpen:d.type==="inpaint",onClose:r,imageUrl:i?.imageUrl}),e.jsx(ks,{"code-path":"src/pages/ProjectPage.tsx:276:7",isOpen:d.type==="outpaint",onClose:r,imageUrl:i?.imageUrl}),e.jsx(Is,{"code-path":"src/pages/ProjectPage.tsx:282:7",isOpen:d.type==="virtualCamera",onClose:r,imageUrl:i?.imageUrl}),e.jsx(Rs,{"code-path":"src/pages/ProjectPage.tsx:288:7",isOpen:z,onClose:()=>_(!1),onAICreation:te,onManualCreation:re}),e.jsx($t,{"code-path":"src/pages/ProjectPage.tsx:295:7",isOpen:L,onClose:()=>C(!1),suggestedName:K,onConfirm:be,isLoading:W})]})}export{zs as ProjectPage};
