# 分镜台 - 前端设计与交互文档

## 文档信息
| 项目 | 内容 |
|------|------|
| 产品名称 | 分镜台 (Storyboard Master) |
| 版本号 | V8.0 |
| 文档类型 | 前端设计与交互 |

---

## 1. 设计系统

### 1.1 色彩系统

#### 1.1.1 主色调
```css
:root {
  /* 主色 */
  --primary: #FFD700;
  --primary-hover: #FFC107;
  --primary-active: #FFB300;
  
  /* 背景色 */
  --bg-day: #F5F5F5;
  --bg-night: #1A1A1A;
  --bg-card-day: #FFFFFF;
  --bg-card-night: #2D2D2D;
  
  /* 文字色 */
  --text-primary-day: #333333;
  --text-primary-night: #FFFFFF;
  --text-secondary-day: #666666;
  --text-secondary-night: #AAAAAA;
  --text-tertiary-day: #999999;
  --text-tertiary-night: #666666;
  
  /* 状态色 */
  --status-red: #F44336;      /* 未开始 */
  --status-yellow: #FF9800;   /* 进行中 */
  --status-green: #4CAF50;    /* 已完成 */
  --status-blue: #2196F3;     /* 已审核 */
  --status-orange: #FF5722;   /* 待修改 */
  
  /* 功能色 */
  --success: #4CAF50;
  --warning: #FF9800;
  --error: #F44336;
  --info: #2196F3;
  
  /* 边框 */
  --border-day: #E0E0E0;
  --border-night: #404040;
}
```

#### 1.1.2 色彩使用规范
| 场景 | 色值 | 用途 |
|------|------|------|
| 主按钮 | #FFD700 | 主要操作按钮 |
| 次按钮 | transparent + border | 次要操作 |
| 危险操作 | #F44336 | 删除等危险操作 |
| 链接文字 | #2196F3 | 可点击链接 |
| 选中状态 | #FFD700 | 选中项高亮 |
| 悬停背景 | rgba(0,0,0,0.05) | 列表项悬停 |

### 1.2 字体系统

#### 1.2.1 字体栈
```css
:root {
  --font-family: 'Source Han Sans CN', 'PingFang SC', 'Microsoft YaHei', sans-serif;
  --font-family-mono: 'JetBrains Mono', 'Fira Code', monospace;
}
```

#### 1.2.2 字体规格
| 级别 | 大小 | 字重 | 行高 | 用途 |
|------|------|------|------|------|
| H1 | 32px | 700 | 1.3 | 页面大标题 |
| H2 | 24px | 600 | 1.4 | 区块标题 |
| H3 | 18px | 600 | 1.5 | 卡片标题 |
| H4 | 16px | 500 | 1.5 | 小标题 |
| Body | 14px | 400 | 1.6 | 正文 |
| Caption | 12px | 400 | 1.5 | 辅助文字 |
| Small | 10px | 400 | 1.4 | 标签 |

### 1.3 间距系统

#### 1.3.1 间距规格
```css
:root {
  --space-xs: 4px;
  --space-sm: 8px;
  --space-md: 12px;
  --space-lg: 16px;
  --space-xl: 24px;
  --space-2xl: 32px;
  --space-3xl: 48px;
  --space-4xl: 64px;
}
```

#### 1.3.2 圆角规格
```css
:root {
  --radius-sm: 4px;   /* 按钮、标签 */
  --radius-md: 8px;   /* 卡片、输入框 */
  --radius-lg: 12px;  /* 弹窗、大卡片 */
  --radius-xl: 16px;  /* 特殊元素 */
  --radius-full: 9999px; /* 圆形 */
}
```

### 1.4 阴影系统

```css
:root {
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
  --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
  --shadow-lg: 0 10px 15px rgba(0,0,0,0.1);
  --shadow-xl: 0 20px 25px rgba(0,0,0,0.15);
  --shadow-card: 0 2px 8px rgba(0,0,0,0.08);
  --shadow-card-hover: 0 8px 24px rgba(0,0,0,0.12);
}
```

---

## 2. 组件库

### 2.1 按钮组件

#### 2.1.1 按钮类型
```
主按钮(Primary):
┌─────────────────┐
│   开始生成      │  背景: #FFD700, 文字: #000
└─────────────────┘  圆角: 4px, 高度: 40px

次按钮(Secondary):
┌─────────────────┐
│   取消          │  背景: transparent, 边框: 1px solid #ccc
└─────────────────┘  文字: inherit

文字按钮(Text):
[查看全部 >]         无背景, 文字带下划线或颜色

图标按钮(Icon):
┌────┐
│ 🗑️ │              正方形, 无边框或细边框
└────┘

危险按钮(Danger):
┌─────────────────┐
│   删除          │  背景: #F44336, 文字: #FFF
└─────────────────┘
```

#### 2.1.2 按钮状态
| 状态 | 样式 |
|------|------|
| 默认 | 基础样式 |
| 悬停 | 亮度+10%，阴影增强 |
| 按下 | 亮度-10%，内阴影 |
| 禁用 | 透明度50%，无交互 |
| 加载 | 显示loading动画 |

### 2.2 输入框组件

#### 2.2.1 文本输入框
```
默认状态:
┌─────────────────────────────────────┐
│ 灵感：悬疑恐怖风格...               │  边框: 1px solid #E0E0E0
└─────────────────────────────────────┘  圆角: 8px

聚焦状态:
┌─────────────────────────────────────┐
│ 灵感：悬疑恐怖风格...               │  边框: 2px solid #FFD700
└─────────────────────────────────────┘  阴影: 0 0 0 3px rgba(255,215,0,0.2)

禁用状态:
┌─────────────────────────────────────┐
│ 灵感：悬疑恐怖风格...               │  背景: #F5F5F5
└─────────────────────────────────────┘  文字: #999
```

#### 2.2.2 文本域
```
多行输入:
┌─────────────────────────────────────┐
│                                     │
│  输入要朗读的台词...                │
│                                     │
│                                     │
└─────────────────────────────────────┘
带字符计数器: 0/500
```

### 2.3 卡片组件

#### 2.3.1 项目卡片
```
┌──────────────────────────┐
│  ┌────────────────────┐  │
│  │                    │  │  ← 封面图(16:9)
│  │    [项目封面]      │  │
│  │                    │  │
│  └────────────────────┘  │
│  野犬加冕                 │  ← 项目名称
│  10-56              [标签]│  ← 日期 + 类型标签
└──────────────────────────┘
尺寸: 240px × 200px
圆角: 8px
阴影: var(--shadow-card)
悬停: var(--shadow-card-hover) + translateY(-2px)
```

#### 2.3.2 镜头卡片
```
┌──────────────────────────┐
│ #13 大远景        [X]    │  ← 编号 + 类型 + 关闭按钮
│ 极度俯拍                 │  ← 机位描述
├──────────────────────────┤
│  ┌────────────────────┐  │
│  │                    │  │
│  │    [镜头画面]      │  │  ← 缩略图(16:9)
│  │                    │  │
│  └────────────────────┘  │
├──────────────────────────┤
│ 哑奴(画外音): "来..."    │  ← 对白(可选)
│ (环境音): 风啸声...      │  ← 环境音(可选)
└──────────────────────────┘
尺寸: 280px × 自适应
最小高度: 200px
```

#### 2.3.3 Scene_Master卡片
```
┌──────────────────────────┐
│ #1 Scene_Master   [X]    │
├──────────────────────────┤
│ ┌──┬──┬──┬──┬──┐        │
│ │1 │2 │3 │4 │5 │        │
│ ├──┼──┼──┼──┼──┤        │
│ │6 │7 │8 │9 │10│        │  ← 5×5网格
│ ├──┼──┼──┼──┼──┤        │
│ │...            │        │
│ └──┴──┴──┴──┴──┘        │
├──────────────────────────┤
│ Scene: SCENE 1 [原创] 大 │
│ [生成 25格 分镜]         │  ← 黄色按钮
│ 25 shots                 │
└──────────────────────────┘
尺寸: 320px × 400px
```

### 2.4 弹窗组件

#### 2.4.1 确认弹窗
```
┌─────────────────────────────────────┐
│ wuli.cool 提示               [X]    │  ← 标题栏
├─────────────────────────────────────┤
│                                     │
│     确定要创建分镜卡片吗?           │  ← 提示文字
│     (生成卡片免费，后续生图需48积分)│  ← 补充说明
│                                     │
│           [取消]      [确定]        │  ← 操作按钮
└─────────────────────────────────────┘
宽度: 400px
圆角: 12px
遮罩: rgba(0,0,0,0.5)
```

#### 2.4.2 编辑弹窗
```
┌─────────────────────────────────────────────────────────────┐
│ 局部重绘 (Inpaint)                                    [X]   │
├─────────────────────────────────────────────────────────────┤
│ 工具栏...                                                   │
├─────────────────────────────────────────────────────────────┤
│                      [编辑区域]                             │
├─────────────────────────────────────────────────────────────┤
│ 输入区域...                                    [开始生成]   │
└─────────────────────────────────────────────────────────────┘
宽度: 800px
最大高度: 90vh
```

### 2.5 下拉菜单

#### 2.5.1 选择器
```
默认:
┌─────────────────┐
│ 16:9(横屏)   [▼]│
└─────────────────┘

展开:
┌─────────────────┐
│ 16:9(横屏)   [▲]│
├─────────────────┤
│ ● 16:9(横屏)    │
│ ○ 9:16(竖屏)    │
│ ○ 1:1(方形)     │
│ ○ 4:3(标准)     │
└─────────────────┘
```

### 2.6 标签组件

#### 2.6.1 状态标签
```
┌────────┐ ┌────────┐ ┌────────┐
│ 未开始 │ │ 进行中 │ │ 已完成 │
└────────┘ └────────┘ └────────┘
红色背景    黄色背景    绿色背景
```

#### 2.6.2 类型标签
```
┌──────────┐
│ 影视短片 │  背景: rgba(0,0,0,0.6)
└──────────┘  文字: #FFF, 圆角: 4px
```

### 2.7 开关组件

```
关闭状态:              开启状态:
┌────────┐            ┌────────┐
│    ○   │            │   ●    │
└────────┘            └────────┘
灰色背景               黄色背景
                       圆点右移
```

### 2.8 滑块组件

```
┌─────────────────────────────┐
│ ────────●──────── 1.7x      │
└─────────────────────────────┘
轨道: 灰色
滑块: 黄色圆点
数值: 右侧显示
```

### 2.9 进度指示器

#### 2.9.1 加载动画
```
旋转圆圈:
    ╭──────╮
   ╱   ◠◠   ╲
  │  (loading) │
   ╲   ◡◡   ╱
    ╰──────╯

进度条:
┌─────────────────────────────┐
│ ████████████░░░░░░░░ 60%    │
└─────────────────────────────┘
```

#### 2.9.2 Toast提示
```
顶部居中:
┌─────────────────────────────────────┐
│ ⚡ 正在创建卡片: SCENE 6 (6/12)     │
└─────────────────────────────────────┘
背景: rgba(0,0,0,0.8)
文字: #FFF
圆角: 8px
自动消失: 3秒
```

---

## 3. 页面布局

### 3.1 首页工作台布局

```
┌─────────────────────────────────────────────────────────────┐
│ [Logo] 分镜台                                    [🌙] [👤]  │ ← Header
├─────────────────────────────────────────────────────────────┤
│                                                             │
│                    下午好, admin.                            │ ← Greeting
│                  灵感稍纵即逝，抓住它。                       │
│                                                             │
│    ┌─────────────────────────────────────────────────────┐  │
│    │ 灵感：悬疑恐怖风格，发生在废弃医院，3集...            │  │ ← Input
│    │                                                     │  │
│    │  [⚡ 极速模式 OFF]                          [开始生成]│  │
│    └─────────────────────────────────────────────────────┘  │
│                                                             │
│         [📖 快速入门教程]        [🎬 进入剧本工坊]           │ ← Quick Actions
│                                                             │
│    我的项目 (4)                                  [查看全部 >] │
│    ┌─────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐         │
│    │  +  │  │ [封面]  │  │ [封面]  │  │ [封面]  │         │ ← Projects
│    │新建 │  │ 项目1   │  │ 项目2   │  │ 项目3   │         │
│    │项目 │  │         │  │         │  │         │         │
│    └─────┘  └─────────┘  └─────────┘  └─────────┘         │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

#### 3.1.1 布局规格
- 最大宽度: 1200px
- 水平居中
- 内边距: 24px
- 项目网格: 4列，间距16px

### 3.2 项目详情页布局

```
┌─────────────────────────────────────────────────────────────┐
│ [Logo] wuli.cool 呜哩的分镜台 V8.0                [通知] [用户]│
│                              [后台] [剧本工坊] [批量图] [导出]│ ← Top Bar
├──────────┬──────────────────────────────┬──────────────────┤
│          │                              │                  │
│  剧本    │                              │   Ep.1 导演台    │
│  镜头    │                              │   ┌──────────┐   │
│  设定    │                              │   │1.剧本    │   │
│  资产    │                              │   │2.分镜    │   │
│          │         画布区域              │   │3.卡片    │   │
│ [导入TXT]│      (无限滚动画布)           │   └──────────┘   │
│          │                              │                  │
│ 智能分镜 │                              │   [剧本内容]     │
│ [新增一集]│                             │                  │
│          │                              │   [AI扩写按钮]   │
│ 分集列表 │                              │                  │
│ • 第一集 │                              │   [生图参数]     │
│ • 第二集 │                              │                  │
│          │                              │   [操作按钮]     │
└──────────┴──────────────────────────────┴──────────────────┘
  240px              自适应                    320px
  (固定)             (填充)                   (固定)
```

#### 3.2.1 响应式断点
| 断点 | 宽度 | 布局调整 |
|------|------|----------|
| Desktop XL | ≥1600px | 三栏布局，右侧面板320px |
| Desktop | ≥1280px | 三栏布局，右侧面板280px |
| Tablet | ≥768px | 两栏布局，隐藏右侧面板 |
| Mobile | <768px | 单栏布局，抽屉式侧边栏 |

### 3.3 左侧边栏

#### 3.3.1 导航菜单
```
┌─────────────────┐
│  📄 剧本        │  ← 当前选中，黄色高亮
│  🎬 镜头        │
│  ⚙️ 设定        │
│  🖼️ 资产        │
├─────────────────┤
│ [导入TXT]       │  ← 操作按钮
├─────────────────┤
│ 智能分镜        │
│ [新增一集]      │
├─────────────────┤
│ 分集列表        │
│ • 第一集    [X] │  ← 可删除
│ • 第二集    [X] │
│ • 第三集    [X] │
└─────────────────┘
宽度: 240px
背景: var(--bg-card)
边框: 1px solid var(--border)
```

### 3.4 右侧面板

#### 3.4.1 标签页切换
```
┌─────────────────────────┐
│ ┌─────┬─────┬─────┐    │
│ │1.剧本│2.分镜│3.卡片│    │
│ └─────┴─────┴─────┘    │
│  黄色底表示当前选中      │
└─────────────────────────┘
```

#### 3.4.2 剧本面板内容
```
┌─────────────────────────┐
│ 本集故事(Story)          │
│ [场次剧本 Script]       │ ← 切换按钮
├─────────────────────────┤
│ 本集完整故事内容:        │
│                         │
│ [剧本正文...]           │
│                         │
│ [AI扩写为场次剧本]      │ ← 黄色按钮
└─────────────────────────┘
```

#### 3.4.3 分镜面板内容
```
┌─────────────────────────┐
│ 状态与属性               │
│ ● ○ ○ ○ ○        [重开] │ ← 状态点 + 操作
├─────────────────────────┤
│ 参考图                   │
│ ┌───┬───┬───┐          │
│ │📷 │✏️ │🖼️ │          │
│ └───┴───┴───┘          │
├─────────────────────────┤
│ 分镜详情                 │
│ 景别: [大远景 ▼]        │
│ 画面内容: [____]        │
│ 角色对白: [____]        │
│ 环境音: [____]          │
├─────────────────────────┤
│ 生图参数                 │
│ 分辨率: [2K高清 ▼]      │
│ 比例: [16:9 ▼]          │
│ AI提示词: [____]        │
│ 画风风格: [国风3D ▼]    │
├─────────────────────────┤
│ [生图] [调色]           │
│ [生成动态视频]          │
└─────────────────────────┘
```

---

## 4. 交互设计

### 4.1 画布交互

#### 4.1.1 基本操作
| 操作 | 触发 | 反馈 |
|------|------|------|
| 平移 | 空格+拖拽 | 光标变为抓手，画布跟随移动 |
| 缩放 | 滚轮 | 以鼠标位置为中心缩放 |
| 框选 | 空白处拖拽 | 显示选择框，松开选中框内卡片 |
| 多选 | Ctrl+点击 | 选中多个卡片，显示批量操作 |

#### 4.1.2 卡片交互
| 操作 | 触发 | 反馈 |
|------|------|------|
| 选中 | 单击 | 卡片边框高亮(黄色) |
| 拖拽 | 拖拽卡片 | 卡片跟随鼠标，显示放置位置预览 |
| 编辑 | 双击 | 打开详情面板或编辑弹窗 |
| 删除 | Delete键 | 卡片消失，显示撤销提示 |
| 右键 | 右键点击 | 显示上下文菜单 |

#### 4.1.3 连线交互
```
步骤1: 右键源卡片 → 选择"连线"
        光标变为十字
        
步骤2: 移动鼠标
        显示贝塞尔曲线跟随
        
步骤3: 点击目标卡片
        连线固定，显示连接关系
        
步骤4: 点击空白处
        取消连线操作
```

### 4.2 弹窗交互

#### 4.2.1 打开动画
```
1. 背景遮罩淡入 (opacity 0 → 0.5, 200ms)
2. 弹窗从上方滑入 + 淡入 (translateY -20px → 0, opacity 0 → 1, 300ms)
3. 内容区域显示
```

#### 4.2.2 关闭动画
```
1. 弹窗向下滑出 + 淡出 (translateY 0 → 20px, opacity 1 → 0, 200ms)
2. 背景遮罩淡出 (opacity 0.5 → 0, 200ms)
3. 移除DOM
```

#### 4.2.3 关闭方式
- 点击遮罩层
- 点击关闭按钮(X)
- 按Esc键
- 点击取消按钮
- 操作完成后自动关闭

### 4.3 加载状态

#### 4.3.1 按钮加载
```
默认:              加载中:
┌─────────┐       ┌─────────┐
│ 开始生成 │  →   │ ○ 生成中 │
└─────────┘       └─────────┘
                   旋转动画
```

#### 4.3.2 卡片加载
```
卡片占位:
┌─────────────────┐
│                 │
│   [骨架屏动画]   │  ← 脉冲动画
│                 │
├─────────────────┤
│ [====>    ] 60% │  ← 进度条(可选)
└─────────────────┘
```

#### 4.3.3 全局加载
```
全屏遮罩:
┌─────────────────────────────────────┐
│ ███████████████████████████████████ │
│ ███████████████████████████████████ │
│ ██████                    █████████ │
│ ██████   [旋转图标]       █████████ │
│ ██████   正在加载...      █████████ │
│ ██████                    █████████ │
│ ███████████████████████████████████ │
│ ███████████████████████████████████ │
└─────────────────────────────────────┘
背景: rgba(0,0,0,0.7)
```

### 4.4 反馈机制

#### 4.4.1 Toast通知
```
位置: 顶部居中
时长: 3秒自动消失
类型:
┌─────────────────────────────────────┐
│ ✅ 操作成功                         │  成功 - 绿色
├─────────────────────────────────────┤
│ ⚠️  请注意检查                     │  警告 - 黄色
├─────────────────────────────────────┤
│ ❌ 操作失败                         │  错误 - 红色
├─────────────────────────────────────┤
│ ℹ️  提示信息                        │  信息 - 蓝色
└─────────────────────────────────────┘
```

#### 4.4.2 确认对话框
```
危险操作前显示:
┌─────────────────────────────────────┐
│ ⚠️ 确定要删除吗?                   │
│    此操作不可撤销                   │
│         [取消]    [确定删除]        │
└─────────────────────────────────────┘
```

---

## 5. 动画设计

### 5.1 过渡动画

#### 5.1.1 页面切换
```css
/* 淡入淡出 */
.page-enter {
  opacity: 0;
  transform: translateY(10px);
}
.page-enter-active {
  opacity: 1;
  transform: translateY(0);
  transition: opacity 300ms, transform 300ms;
}
.page-exit {
  opacity: 1;
}
.page-exit-active {
  opacity: 0;
  transition: opacity 200ms;
}
```

#### 5.1.2 卡片动画
```css
/* 卡片出现 */
.card-enter {
  opacity: 0;
  transform: scale(0.9);
}
.card-enter-active {
  opacity: 1;
  transform: scale(1);
  transition: opacity 200ms, transform 200ms cubic-bezier(0.34, 1.56, 0.64, 1);
}

/* 卡片悬停 */
.card:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-card-hover);
  transition: all 200ms ease;
}
```

### 5.2 微交互

#### 5.2.1 按钮点击
```css
.button:active {
  transform: scale(0.98);
  transition: transform 100ms;
}
```

#### 5.2.2 输入框聚焦
```css
.input:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.2);
  transition: all 200ms;
}
```

#### 5.2.3 开关切换
```css
.switch {
  transition: background-color 200ms;
}
.switch-knob {
  transition: transform 200ms cubic-bezier(0.34, 1.56, 0.64, 1);
}
```

### 5.3 加载动画

#### 5.3.1 旋转加载器
```css
@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}
.loader {
  animation: spin 1s linear infinite;
}
```

#### 5.3.2 骨架屏脉冲
```css
@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}
.skeleton {
  animation: pulse 1.5s ease-in-out infinite;
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 200% 100%;
}
```

---

## 6. 状态管理

### 6.1 全局状态

```typescript
// 应用状态
interface AppState {
  theme: 'light' | 'dark';
  user: User | null;
  currentProject: Project | null;
  currentEpisode: Episode | null;
  notifications: Notification[];
}

// 画布状态
interface CanvasState {
  zoom: number;
  offset: { x: number; y: number };
  selectedCards: string[];
  clipboard: Card[];
  history: HistoryState[];
  gridVisible: boolean;
}

// UI状态
interface UIState {
  sidebarCollapsed: boolean;
  rightPanelVisible: boolean;
  activeTab: 'script' | 'storyboard' | 'card';
  modals: Modal[];
  toasts: Toast[];
}
```

### 6.2 状态流转

#### 6.2.1 项目创建流程
```
[输入创意] → [点击生成] → [显示加载] → [创建项目] → [跳转项目页]
    ↓
[显示Toast: 正在构思宏大叙事(约需30秒)...]
    ↓
[项目创建成功] → [项目出现在列表]
```

#### 6.2.2 分镜生成流程
```
[点击一键生成] → [确认弹窗] → [显示进度] → [批量生成] → [完成提示]
    ↓
[显示Toast: 6/12 正在创建卡片: SCENE 6]
    ↓
[卡片逐个出现在画布]
```

#### 6.2.3 图片生成流程
```
[点击生图] → [显示加载] → [调用API] → [轮询状态] → [显示结果]
    ↓
[卡片显示加载动画]
    ↓
[图片生成完成，替换缩略图]
```

---

## 7. 快捷键系统

### 7.1 快捷键映射

| 快捷键 | 功能 | 场景 |
|--------|------|------|
| `Space + Drag` | 平移画布 | 画布区域 |
| `Middle Click + Drag` | 平移画布 | 画布区域 |
| `Scroll` | 垂直滚动 | 页面/面板 |
| `Ctrl + Scroll` | 缩放画布 | 画布区域 |
| `Ctrl + 0` | 重置缩放 | 画布区域 |
| `Ctrl + A` | 全选卡片 | 画布区域 |
| `Ctrl + C` | 复制选中 | 全局 |
| `Ctrl + V` | 粘贴 | 画布区域 |
| `Ctrl + Z` | 撤销 | 全局 |
| `Ctrl + Y` | 重做 | 全局 |
| `Delete` / `Backspace` | 删除选中 | 画布区域 |
| `Ctrl + G` | 组合 | 多选时 |
| `Ctrl + Shift + G` | 取消组合 | 选中组合时 |
| `F` | 适应屏幕 | 画布区域 |
| `Esc` | 取消/关闭 | 全局 |
| `?` | 显示快捷键帮助 | 全局 |

### 7.2 快捷键提示

```
按 ? 键显示:
┌─────────────────────────────────────┐
│ 快捷键帮助                   [X]    │
├─────────────────────────────────────┤
│ 画布操作                            │
│   Space + 拖拽    平移画布          │
│   Ctrl + 滚轮     缩放画布          │
│   Ctrl + 0        重置缩放          │
│   F               适应屏幕          │
│                                     │
│ 编辑操作                            │
│   Ctrl + C/V      复制/粘贴         │
│   Ctrl + Z/Y      撤销/重做         │
│   Delete          删除选中          │
│                                     │
│   [查看更多...]                     │
└─────────────────────────────────────┘
```

---

## 8. 主题系统

### 8.1 主题切换

```typescript
// 主题配置
const themes = {
  light: {
    '--bg-primary': '#F5F5F5',
    '--bg-card': '#FFFFFF',
    '--text-primary': '#333333',
    '--text-secondary': '#666666',
    '--border': '#E0E0E0',
  },
  dark: {
    '--bg-primary': '#1A1A1A',
    '--bg-card': '#2D2D2D',
    '--text-primary': '#FFFFFF',
    '--text-secondary': '#AAAAAA',
    '--border': '#404040',
  }
};

// 切换逻辑
function toggleTheme() {
  const newTheme = currentTheme === 'light' ? 'dark' : 'light';
  Object.entries(themes[newTheme]).forEach(([key, value]) => {
    document.documentElement.style.setProperty(key, value);
  });
  localStorage.setItem('theme', newTheme);
}
```

### 8.2 系统主题适配

```javascript
// 监听系统主题变化
const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
mediaQuery.addEventListener('change', (e) => {
  const theme = e.matches ? 'dark' : 'light';
  applyTheme(theme);
});
```

---

## 9. 响应式设计

### 9.1 断点定义

```scss
// 断点
$breakpoints: (
  'xs': 0,
  'sm': 576px,
  'md': 768px,
  'lg': 992px,
  'xl': 1280px,
  'xxl': 1600px
);

// 响应式混合
@mixin respond-to($breakpoint) {
  @media (min-width: map-get($breakpoints, $breakpoint)) {
    @content;
  }
}
```

### 9.2 布局适配

#### 9.2.1 大屏(≥1280px)
- 三栏布局
- 左侧边栏240px
- 右侧面板280px
- 画布自适应

#### 9.2.2 中屏(768px-1279px)
- 两栏布局
- 左侧边栏200px
- 右侧面板隐藏（可抽屉展开）
- 画布填充剩余空间

#### 9.2.3 小屏(<768px)
- 单栏布局
- 侧边栏变为抽屉
- 右侧面板变为抽屉
- 画布全屏

---

## 10. 性能优化

### 10.1 渲染优化

#### 10.1.1 虚拟滚动
```typescript
// 大量卡片时使用虚拟滚动
<VirtualList
  items={cards}
  itemHeight={200}
  renderItem={(card) => <Card data={card} />}
  overscan={5}
/>
```

#### 10.1.2 图片懒加载
```typescript
// 图片进入视口才加载
<img
  src={thumbnail}
  loading="lazy"
  placeholder={<Skeleton />}
/>
```

#### 10.1.3 画布优化
```typescript
// 使用requestAnimationFrame
function animate() {
  requestAnimationFrame(animate);
  renderCanvas();
}

// 离屏渲染
const offscreenCanvas = document.createElement('canvas');
const ctx = offscreenCanvas.getContext('2d');
```

### 10.2 状态优化

#### 10.2.1 状态分片
```typescript
// 按模块拆分状态
const useCanvasStore = create<CanvasState>(...);
const useProjectStore = create<ProjectState>(...);
const useUIStore = create<UIState>(...);
```

#### 10.2.2 选择器优化
```typescript
// 使用记忆化选择器
const selectedCards = useSelector(
  state => state.canvas.selectedCards,
  shallowEqual
);
```

### 10.3 网络优化

#### 10.3.1 请求合并
```typescript
// 批量API请求
const batchRequests = debounce((requests) => {
  fetch('/api/batch', {
    method: 'POST',
    body: JSON.stringify({ requests })
  });
}, 100);
```

#### 10.3.2 数据缓存
```typescript
// React Query缓存
const { data } = useQuery({
  queryKey: ['project', id],
  queryFn: fetchProject,
  staleTime: 5 * 60 * 1000, // 5分钟
});
```

---

## 11. 无障碍设计

### 11.1 键盘导航

- 所有交互元素可通过Tab键访问
- 按钮支持Enter/Space激活
- 弹窗支持Esc关闭
- 提供跳过导航链接

### 11.2 屏幕阅读器

```html
<!-- 按钮 -->
<button aria-label="开始生成分镜">开始生成</button>

<!-- 状态 -->
<div role="status" aria-live="polite">
  正在创建卡片: SCENE 6
</div>

<!-- 弹窗 -->
<div role="dialog" aria-modal="true" aria-labelledby="dialog-title">
  <h2 id="dialog-title">确认删除</h2>
</div>
```

### 11.3 对比度

- 文字与背景对比度 ≥ 4.5:1
- 大文字对比度 ≥ 3:1
- 焦点指示器清晰可见

---

## 12. 更新记录

| 版本 | 日期 | 更新内容 |
|------|------|----------|
| V1.0 | 2026-02-02 | 初始版本 |
